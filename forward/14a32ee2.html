<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0"><title>MySQLç»ˆç« -ç³»åˆ—ä¼˜åŒ– | Maxbit</title><meta name="author" content="é¥¼é“›"><meta name="copyright" content="é¥¼é“›"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="0.ç¯å¢ƒå‡†å¤‡ï¼š1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859å‡†å¤‡100wè¡Œæ•°æ®åŒ…ï¼Œç•™ä½œå‹åŠ›æµ‹è¯•ã€‚db03 [(none)]&gt;create database oldboy;Query OK, 1 row affected (">
<meta property="og:type" content="article">
<meta property="og:title" content="MySQLç»ˆç« -ç³»åˆ—ä¼˜åŒ–">
<meta property="og:url" content="https://cakepanit.com/forward/14a32ee2.html">
<meta property="og:site_name" content="Maxbit">
<meta property="og:description" content="0.ç¯å¢ƒå‡†å¤‡ï¼š1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859å‡†å¤‡100wè¡Œæ•°æ®åŒ…ï¼Œç•™ä½œå‹åŠ›æµ‹è¯•ã€‚db03 [(none)]&gt;create database oldboy;Query OK, 1 row affected (">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://cakepanit.com/images/img-71.png">
<meta property="article:published_time" content="2020-05-05T11:27:00.000Z">
<meta property="article:modified_time" content="2022-08-17T14:53:44.498Z">
<meta property="article:author" content="é¥¼é“›">
<meta property="article:tag" content="MySQL">
<meta property="article:tag" content="æ•°æ®åº“ä¼˜åŒ–">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://cakepanit.com/images/img-71.png"><link rel="shortcut icon" href="/img/favicon.png"><link rel="canonical" href="https://cakepanit.com/forward/14a32ee2.html"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="/css/fei/all.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="/css/fei/fancybox.min.css" media="print" onload="this.media='all'"><script>const GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: undefined,
  translate: {"defaultEncoding":2,"translateDelay":0,"msgToTraditionalChinese":"ç¹","msgToSimplifiedChinese":"ç°¡"},
  noticeOutdate: undefined,
  highlight: {"plugin":"highlighjs","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":300},
  copy: {
    success: 'å¤åˆ¶æˆåŠŸ',
    error: 'å¤åˆ¶é”™è¯¯',
    noSupport: 'æµè§ˆå™¨ä¸æ”¯æŒ'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: 'å¤©',
  date_suffix: {
    just: 'åˆšåˆš',
    min: 'åˆ†é’Ÿå‰',
    hour: 'å°æ—¶å‰',
    day: 'å¤©å‰',
    month: 'ä¸ªæœˆå‰'
  },
  copyright: {"limitCount":100,"languages":{"author":"ä½œè€…: é¥¼é“›","link":"é“¾æ¥: ","source":"æ¥æº: Maxbit","info":"è‘—ä½œæƒå½’ä½œè€…æ‰€æœ‰ã€‚å•†ä¸šè½¬è½½è¯·è”ç³»ä½œè€…è·å¾—æˆæƒï¼Œéå•†ä¸šè½¬è½½è¯·æ³¨æ˜å‡ºå¤„ã€‚"}},
  lightbox: 'fancybox',
  Snackbar: undefined,
  source: {
    justifiedGallery: {
      js: 'https://cdn.jsdelivr.net/npm/flickr-justified-gallery/dist/fjGallery.min.js',
      css: 'https://cdn.jsdelivr.net/npm/flickr-justified-gallery/dist/fjGallery.min.css'
    }
  },
  isPhotoFigcaption: false,
  islazyload: false,
  isAnchor: false,
  percent: {
    toc: true,
    rightside: true,
  }
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: 'MySQLç»ˆç« -ç³»åˆ—ä¼˜åŒ–',
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2022-08-17 22:53:44'
}</script><noscript><style type="text/css">
  #nav {
    opacity: 1
  }
  .justified-gallery img {
    opacity: 1
  }

  #recent-posts time,
  #post-meta time {
    display: inline !important
  }
</style></noscript><script>(win=>{
    win.saveToLocal = {
      set: function setWithExpiry(key, value, ttl) {
        if (ttl === 0) return
        const now = new Date()
        const expiryDay = ttl * 86400000
        const item = {
          value: value,
          expiry: now.getTime() + expiryDay,
        }
        localStorage.setItem(key, JSON.stringify(item))
      },

      get: function getWithExpiry(key) {
        const itemStr = localStorage.getItem(key)

        if (!itemStr) {
          return undefined
        }
        const item = JSON.parse(itemStr)
        const now = new Date()

        if (now.getTime() > item.expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return item.value
      }
    }
  
    win.getScript = url => new Promise((resolve, reject) => {
      const script = document.createElement('script')
      script.src = url
      script.async = true
      script.onerror = reject
      script.onload = script.onreadystatechange = function() {
        const loadState = this.readyState
        if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
        script.onload = script.onreadystatechange = null
        resolve()
      }
      document.head.appendChild(script)
    })
  
    win.getCSS = url => new Promise((resolve, reject) => {
      const link = document.createElement('link')
      link.rel = 'stylesheet'
      link.href = url
      link.onload = () => resolve()
      link.onerror = () => reject()
      document.head.appendChild(link)
    })
  
      win.activateDarkMode = function () {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      win.activateLightMode = function () {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }
      const t = saveToLocal.get('theme')
    
          if (t === 'dark') activateDarkMode()
          else if (t === 'light') activateLightMode()
        
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
    const detectApple = () => {
      if(/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
    })(window)</script><link rel="stylesheet" href="/css/fei/swiper-bundle.min.css"><script src="/css/fei/swiper-bundle.min.js"></script><script src="/css/fei/pace.min.js"></script><meta name="generator" content="Hexo 5.4.2"></head><body><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><img src="/img/avatar.jpg" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="sidebar-site-data site-data is-center"><a href="/archives/"><div class="headline">æ–‡ç« </div><div class="length-num">93</div></a><a href="/tags/"><div class="headline">æ ‡ç­¾</div><div class="length-num">72</div></a><a href="/categories/"><div class="headline">åˆ†ç±»</div><div class="length-num">3</div></a></div><hr/><div class="menus_items"><div class="menus_item"><a class="site-page group" href="javascript:void(0);"><i class="fa-fw fa-fw fas fa-book-open"></i><span> æ–‡ç« </span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/archives/"><i class="fa-fw fa-fw fas fa-archive"></i><span> æ–‡ç« åˆ—è¡¨</span></a></li><li><a class="site-page child" href="/categories/"><i class="fa-fw fa-fw fas fa-shapes"></i><span> å…¨éƒ¨åˆ†ç±»</span></a></li><li><a class="site-page child" href="/tags/"><i class="fa-fw fa-fw fas fa-tags"></i><span> æ‰€æœ‰æ ‡ç­¾</span></a></li><li><a class="site-page child" href="/charts/"><i class="fa-fw fa-fw fas fa-chart-line"></i><span> æ–‡ç« ç»Ÿè®¡</span></a></li><li><a class="site-page child" href="javascript:toRandomPost();"><i class="fa-fw fa-fw fas fa-random"></i><span> éšä¾¿çœ‹çœ‹</span></a></li></ul></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);"><i class="fa-fw fa-fw fas fa-link"></i><span> å¯¼èˆª</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/link/"><i class="fa-fw fa-fw fas fa-child"></i><span> å‹æƒ…é“¾æ¥</span></a></li><li><a class="site-page child" href="/about/"><i class="fa-fw fa-fw fas fa-address-card"></i><span> å…³äºæœ¬ç«™</span></a></li></ul></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);"><i class="fa-fw fas fa-list"></i><span> å…¶ä»–</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/gallery/"><i class="fa-fw fas fa-file-image"></i><span> æ”¶è—å›¾åº“</span></a></li><li><a class="site-page child" href="/bookshelf/"><i class="fa-fw fas fa-bookmark"></i><span> æ”¶è—ä¹¦å•</span></a></li><li><a class="site-page child" href="/status"><i class="fa-fw fab fa-accessible-icon"></i><span> ç«™ç‚¹ç›‘æ§</span></a></li></ul></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url('/images/img-71.png')"><nav id="nav"><div id="nav-group"><span id="blog-info"> <a class="site-page" href="/" title="Maxbit"><span class="site-name">Maxbit</span><i class="fas fa-home"></i></a></span><span id="page_name"><a class="site-page" id="page-title" title="å›åˆ°é¡¶éƒ¨" onclick="btf.scrollToDest(0, 500)"><span>Maxbit</span></a></span><div id="menus"><div class="menus_items"><div class="menus_item"><a class="site-page group" href="javascript:void(0);"><i class="fa-fw fa-fw fas fa-book-open"></i><span> æ–‡ç« </span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/archives/"><i class="fa-fw fa-fw fas fa-archive"></i><span> æ–‡ç« åˆ—è¡¨</span></a></li><li><a class="site-page child" href="/categories/"><i class="fa-fw fa-fw fas fa-shapes"></i><span> å…¨éƒ¨åˆ†ç±»</span></a></li><li><a class="site-page child" href="/tags/"><i class="fa-fw fa-fw fas fa-tags"></i><span> æ‰€æœ‰æ ‡ç­¾</span></a></li><li><a class="site-page child" href="/charts/"><i class="fa-fw fa-fw fas fa-chart-line"></i><span> æ–‡ç« ç»Ÿè®¡</span></a></li><li><a class="site-page child" href="javascript:toRandomPost();"><i class="fa-fw fa-fw fas fa-random"></i><span> éšä¾¿çœ‹çœ‹</span></a></li></ul></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);"><i class="fa-fw fa-fw fas fa-link"></i><span> å¯¼èˆª</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/link/"><i class="fa-fw fa-fw fas fa-child"></i><span> å‹æƒ…é“¾æ¥</span></a></li><li><a class="site-page child" href="/about/"><i class="fa-fw fa-fw fas fa-address-card"></i><span> å…³äºæœ¬ç«™</span></a></li></ul></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);"><i class="fa-fw fas fa-list"></i><span> å…¶ä»–</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/gallery/"><i class="fa-fw fas fa-file-image"></i><span> æ”¶è—å›¾åº“</span></a></li><li><a class="site-page child" href="/bookshelf/"><i class="fa-fw fas fa-bookmark"></i><span> æ”¶è—ä¹¦å•</span></a></li><li><a class="site-page child" href="/status"><i class="fa-fw fab fa-accessible-icon"></i><span> ç«™ç‚¹ç›‘æ§</span></a></li></ul></div></div></div><div id="hotkey"><div id="setting-button" onclick="eurkon.switchRightSide();"><a class="site-page" href="javascript:void(0);" title="è®¾ç½®"><i class="fas fa-screwdriver-wrench fa-fw"></i></a></div><div id="top-button"><a class="site-page" href="javascript:void(0);" title="å›åˆ°é¡¶éƒ¨" onclick="btf.scrollToDest(0, 500)"><span class="scroll-percent"></span><i class="fas fa-arrow-up fa-fw"></i></a></div><div id="toggle-menu"><a class="site-page" href="javascript:void(0);"><i class="fas fa-bars fa-fw"></i></a></div></div></div></nav><div id="post-cover"><img class="cover" id="post-cover-img" src="/images/img-71.png" alt="cover"></div><div id="post-info"><div id="post-meta"><div class="meta-firstline"><span class="post-meta-categories"><i class="fas fa-shapes fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/DBA/">DBA</a></span><span class="post-meta-tags"><span class="post-meta-separator">|</span><i class="fas fa-tags fa-fw post-meta-icon"></i><a class="post-meta-tags" href="/tags/MySQL/">ğŸŒ²MySQL</a><span class="post-meta-separator">â€¢</span><a class="post-meta-tags" href="/tags/%E6%95%B0%E6%8D%AE%E5%BA%93%E4%BC%98%E5%8C%96/">æ•°æ®åº“ä¼˜åŒ–</a></span></div><h1 class="post-title">MySQLç»ˆç« -ç³»åˆ—ä¼˜åŒ–</h1><div class="meta-secondline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">å‘è¡¨äº</span><time class="post-meta-date-created" datetime="2020-05-05T11:27:00.000Z" title="å‘è¡¨äº 2020-05-05 19:27:00">2020-05-05</time></span><span class="post-meta-separator">|</span><span class="post-meta-date"><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">æ›´æ–°äº</span><time class="post-meta-date-updated" datetime="2022-08-17T14:53:44.498Z" title="æ›´æ–°äº 2022-08-17 22:53:44">2022-08-17</time></span><span class="post-meta-separator">|</span><span class="post-meta-wordcount"><i class="far fa-file-word fa-fw post-meta-icon"></i><span class="post-meta-label">å­—æ•°æ€»è®¡:</span><span class="word-count">9.4k</span><span class="post-meta-separator">|</span></span><span class="post-meta-min2read"><i class="far fa-clock fa-fw post-meta-icon"></i><span class="post-meta-label">é˜…è¯»æ—¶é•¿:</span><span>36åˆ†é’Ÿ</span></span><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title="MySQLç»ˆç« -ç³»åˆ—ä¼˜åŒ–"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">é˜…è¯»é‡:</span><span id="busuanzi_value_page_pv"><i class="fa-solid fa-spinner fa-spin"></i></span></span></div></div></div><section class="main-hero-waves-area waves-area"><svg class="waves-svg" xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink" viewBox="0 24 150 28" preserveAspectRatio="none" shape-rendering="auto"><defs><path id="gentle-wave" d="M -160 44 c 30 0 58 -18 88 -18 s 58 18 88 18 s 58 -18 88 -18 s 58 18 88 18 v 44 h -352 Z"></path></defs><g class="parallax"><use href="#gentle-wave" x="48" y="0"></use><use href="#gentle-wave" x="48" y="3"></use><use href="#gentle-wave" x="48" y="5"></use><use href="#gentle-wave" x="48" y="7"></use></g></svg></section></header><main class="layout" id="content-inner"><div><div id="post"><article class="post-content" id="article-container"><h2 id="0-ç¯å¢ƒå‡†å¤‡ï¼š"><a href="#0-ç¯å¢ƒå‡†å¤‡ï¼š" class="headerlink" title="0.ç¯å¢ƒå‡†å¤‡ï¼š"></a>0.ç¯å¢ƒå‡†å¤‡ï¼š</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br></pre></td><td class="code"><pre><span class="line">å‡†å¤‡100wè¡Œæ•°æ®åŒ…ï¼Œç•™ä½œå‹åŠ›æµ‹è¯•ã€‚</span><br><span class="line">db03 [(none)]&gt;create database oldboy;</span><br><span class="line">Query OK, 1 row affected (0.00 sec)</span><br><span class="line"></span><br><span class="line">db03 [(none)]&gt;use oldboy;</span><br><span class="line">Database changed</span><br><span class="line">db03 [oldboy]&gt;create table t100w (</span><br><span class="line">    -&gt; <span class="built_in">id</span> int,num int,</span><br><span class="line">    -&gt; k1 char(2),</span><br><span class="line">    -&gt; k2 char(4),</span><br><span class="line">    -&gt; dt timestamp) charset utf8mb4 collate utf8mb4_bin;</span><br><span class="line">Query OK, 0 rows affected (0.01 sec)</span><br><span class="line"></span><br><span class="line">db03 [oldboy]&gt;delimiter //</span><br><span class="line">db03 [oldboy]&gt;create  procedure rand_data(<span class="keyword">in</span> num int)</span><br><span class="line">    -&gt; begin</span><br><span class="line">    -&gt; <span class="built_in">declare</span> str char(62) default <span class="string">&#x27;abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789&#x27;</span>;</span><br><span class="line">    -&gt; <span class="built_in">declare</span> str2 char(2);</span><br><span class="line">    -&gt; <span class="built_in">declare</span> str4 char(4);</span><br><span class="line">    -&gt; <span class="built_in">declare</span> i int default 0;</span><br><span class="line">    -&gt; <span class="keyword">while</span> i&lt;num <span class="keyword">do</span></span><br><span class="line">    -&gt; <span class="built_in">set</span> str2=concat(substring(str,1+floor(rand()*61),1),substring(str,1+floor(rand()*61),1));</span><br><span class="line">    -&gt; <span class="built_in">set</span> str4=concat(substring(str,1+floor(rand()*61),2),substring(str,1+floor(rand()*61),2));</span><br><span class="line">    -&gt; <span class="built_in">set</span> i=i+1;</span><br><span class="line">    -&gt; insert into t100w values (i,floor(rand()*num),str2,str4,now());</span><br><span class="line">    -&gt; end <span class="keyword">while</span>;</span><br><span class="line">    -&gt; end;</span><br><span class="line">    -&gt; //</span><br><span class="line">Query OK, 0 rows affected (0.00 sec)</span><br><span class="line"></span><br><span class="line">db03 [oldboy]&gt;delimiter ;</span><br><span class="line">db03 [oldboy]&gt;call rand_data(1000000);</span><br><span class="line">Query OK, 1 row affected (26.40 sec)</span><br><span class="line"></span><br><span class="line">æµ‹è¯•ï¼š</span><br><span class="line">[root@db03 ~]<span class="comment"># mysqlslap --defaults-file=/etc/my.cnf --socket /tmp/mysql.sock \</span></span><br><span class="line">&gt; --concurrency=100 --iterations=1 --create-schema=<span class="string">&#x27;oldboy&#x27;</span> \</span><br><span class="line">&gt; --query=<span class="string">&quot;select * from oldboy.t100w where k2=&#x27;GHvw&#x27;&quot;</span> engine=innodb \</span><br><span class="line">&gt; --number-of-queries=2000 -verbose</span><br><span class="line">Benchmark</span><br><span class="line">        Running <span class="keyword">for</span> engine rbose</span><br><span class="line">        Average number of seconds to run all queries: 191.950 seconds</span><br><span class="line">        Minimum number of seconds to run all queries: 191.950 seconds</span><br><span class="line">        Maximum number of seconds to run all queries: 191.950 seconds</span><br><span class="line">        Number of clients running queries: 100</span><br><span class="line">        Average number of queries per client: 20</span><br><span class="line">//191ç§’</span><br><span class="line"></span><br><span class="line">[root@db03 ~]<span class="comment"># mysqlslap --defaults-file=/etc/my.cnf --socket /tmp/mysql.sock --concurrency=1000 --iterations=1 --create-schema=&#x27;oldboy&#x27; --query=&quot;select * from oldboy.t100w where k2=&#x27;GHvw&#x27;&quot; engine=innodb --number-of-queries=20000 -verbose</span></span><br><span class="line">mysqlslap: Error when connecting to server: 2000 Unknown MySQL error</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">//å¹¶å‘è¿æ¥æ•°æ”¹ä¸º1000ï¼ŒæŠ¥é”™</span><br><span class="line">top:</span><br><span class="line">Tasks: 117 total,   1 running, 116 sleeping,   0 stopped,   0 zombie</span><br><span class="line">%Cpu0  : 99.7 us,  0.0 sy,  0.0 ni,  0.0 <span class="built_in">id</span>,  0.0 wa,  0.0 hi,  0.3 si,  0.0 st</span><br><span class="line">%Cpu1  :100.0 us,  0.0 sy,  0.0 ni,  0.0 <span class="built_in">id</span>,  0.0 wa,  0.0 hi,  0.0 si,  0.0 st</span><br><span class="line">%Cpu2  :100.0 us,  0.0 sy,  0.0 ni,  0.0 <span class="built_in">id</span>,  0.0 wa,  0.0 hi,  0.0 si,  0.0 st</span><br><span class="line">%Cpu3  : 99.7 us,  0.3 sy,  0.0 ni,  0.0 <span class="built_in">id</span>,  0.0 wa,  0.0 hi,  0.0 si,  0.0 st</span><br></pre></td></tr></table></figure>

<h2 id="1-ä¼˜åŒ–èŒƒå›´ï¼š"><a href="#1-ä¼˜åŒ–èŒƒå›´ï¼š" class="headerlink" title="1.ä¼˜åŒ–èŒƒå›´ï¼š"></a>1.ä¼˜åŒ–èŒƒå›´ï¼š</h2><ul>
<li>å­˜å‚¨ã€ä¸»æœºå’Œæ“ä½œç³»ç»Ÿ:<ul>
<li>ä¸»æœºæ¶æ„ç¨³å®šæ€§</li>
<li>I/Oè§„åˆ’åŠé…ç½®</li>
<li>Swap</li>
<li>OSå†…æ ¸å‚æ•°</li>
<li>ç½‘ç»œé—®é¢˜</li>
</ul>
</li>
<li>åº”ç”¨ç¨‹åº:ï¼ˆIndexï¼Œlockï¼Œsessionï¼‰<ul>
<li>åº”ç”¨ç¨‹åºç¨³å®šæ€§å’Œæ€§èƒ½</li>
<li>SQLè¯­å¥æ€§èƒ½</li>
<li>ä¸²è¡Œè®¿é—®èµ„æº</li>
<li>æ€§èƒ½æ¬ ä½³ä¼šè¯ç®¡ç†</li>
</ul>
</li>
<li>æ•°æ®åº“ä¼˜åŒ–:ï¼ˆå†…å­˜ã€æ•°æ®åº“è®¾è®¡ã€å‚æ•°ï¼‰<ul>
<li>å†…å­˜</li>
<li>æ•°æ®åº“ç»“æ„(ç‰©ç†&amp;é€»è¾‘)</li>
<li>å®ä¾‹é…ç½®</li>
</ul>
</li>
<li>æ¶æ„è®¾è®¡ :  <ul>
<li>æ€§èƒ½  : è¯»å†™åˆ†ç¦»,åˆ†å¸ƒå¼</li>
<li>å®‰å…¨  : ä¸»å¤‡,å¤šæ´»</li>
<li>å®‰å…¨&amp;æ€§èƒ½ : åˆ†å¸ƒå¼,NewSQL</li>
</ul>
</li>
</ul>
<p><img src="/images/img-98.png" alt="ä¼˜åŒ–"></p>
<h2 id="2-æ“ä½œç³»ç»Ÿå±‚é¢ä¼˜åŒ–å·¥å…·ä»‹ç»"><a href="#2-æ“ä½œç³»ç»Ÿå±‚é¢ä¼˜åŒ–å·¥å…·ä»‹ç»" class="headerlink" title="2.æ“ä½œç³»ç»Ÿå±‚é¢ä¼˜åŒ–å·¥å…·ä»‹ç»"></a>2.æ“ä½œç³»ç»Ÿå±‚é¢ä¼˜åŒ–å·¥å…·ä»‹ç»</h2><h3 id="2-1top"><a href="#2-1top" class="headerlink" title="2.1top"></a>2.1top</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line">CPUï¼š</span><br><span class="line">%Cpu(s):  0.0 us,  0.0 sy,  0.0 ni,100.0 <span class="built_in">id</span>,  0.0 wa,  0.0 hi,  0.0 si,  0.0 st</span><br><span class="line">KiB Mem :  3880016 total,  3699388 free,   102612 used,    78016 buff/cache</span><br><span class="line">KiB Swap:  2097148 total,  2097148 free,        0 used.  3615864 avail Mem</span><br><span class="line"></span><br><span class="line">æŒ‰1é”®å±•å¼€</span><br><span class="line">%Cpu0  :  0.0 us,  0.0 sy,  0.0 ni,100.0 <span class="built_in">id</span>,  0.0 wa,  0.0 hi,  0.0 si,  0.0 st</span><br><span class="line">%Cpu1  :  0.0 us,  0.0 sy,  0.0 ni,100.0 <span class="built_in">id</span>,  0.0 wa,  0.0 hi,  0.0 si,  0.0 st</span><br><span class="line">%Cpu2  :  0.0 us,  0.0 sy,  0.0 ni,100.0 <span class="built_in">id</span>,  0.0 wa,  0.0 hi,  0.0 si,  0.0 st</span><br><span class="line">%Cpu3  :  0.0 us,  0.0 sy,  0.0 ni,100.0 <span class="built_in">id</span>,  0.0 wa,  0.0 hi,  0.0 si,  0.0 </span><br><span class="line"></span><br><span class="line"></span><br><span class="line">%Cpu(s):  0.0 us,  0.0 sy,  0.0 ni,100.0 <span class="built_in">id</span>,  0.0 wa,  0.0 hi,  0.0 si,  0.0 st</span><br><span class="line"><span class="built_in">id</span> ç©ºé—²çš„CPUæ—¶é—´ç‰‡å æ¯”</span><br><span class="line"></span><br><span class="line">wa CPUç”¨æ¥ç­‰å¾…çš„æ—¶é—´ç‰‡å æ¯”</span><br><span class="line">    ç­‰å¾…IOï¼šå…¨è¡¨æ‰«æ </span><br><span class="line">    ç­‰å¾…å¤§çš„å¤„ç†äº‹ä»¶</span><br><span class="line">    é”</span><br><span class="line"></span><br><span class="line">us ç”¨æˆ·ç¨‹åºå·¥ä½œæ‰€å æœ‰çš„æ—¶é—´ç‰‡å æ¯”</span><br><span class="line"></span><br><span class="line">sy å†…æ ¸å·¥ä½œèŠ±è´¹çš„CPUæ—¶é—´ç‰‡å æ¯”</span><br><span class="line">    bugï¼Œä¸­ç—…æ¯’ </span><br><span class="line">    å„ç§èµ„æºçš„è°ƒåº¦å’Œåˆ†é…</span><br><span class="line">    é«˜å¹¶å‘è¿æ¥</span><br><span class="line">    é”</span><br><span class="line"></span><br><span class="line">%CPU å¦‚æœå‡ºç°%è¿‡é«˜çš„æƒ…å†µï¼Œå±äºæ­£å¸¸ç°è±¡ã€‚å¤šæ ¸åˆ©ç”¨ç‡çš„æ€»å’Œ</span><br><span class="line"></span><br><span class="line">å†…å­˜ï¼š</span><br><span class="line">KiB Mem :  3880016 total,  3479320 free,   281328 used,   119368 buff/cache</span><br><span class="line">KiB Swap:  2097148 total,  2097148 free,        0 used.  3416472 avail Mem </span><br><span class="line"></span><br><span class="line">3416472 avail Mem //æ“ä½œç³»ç»Ÿå±‚é¢å¯ç”¨å®¹é‡</span><br><span class="line"></span><br><span class="line">swapï¼š</span><br><span class="line">Linux 6æ“ä½œç³»ç»Ÿï¼Œé»˜è®¤å›æ”¶ç­–ç•¥ï¼ˆbuffer cacheï¼‰ï¼Œä¸ç«‹å³å›æ”¶ç­–ç•¥</span><br><span class="line">å†…å­˜ä½¿ç”¨è¾¾åˆ°100%-60%æ—¶å€™ï¼Œ40% ä¼šä½¿ç”¨swap</span><br><span class="line"></span><br><span class="line">Linux 7æ“ä½œç³»ç»Ÿ</span><br><span class="line">å†…å­˜ä½¿ç”¨è¾¾åˆ°100%-30%ï¼ˆ70%ï¼‰æ—¶å€™ï¼Œæ‰ä¼šæ—¶å€™swap</span><br><span class="line"><span class="built_in">cat</span> /proc/sys/vm/swappiness </span><br><span class="line">30  </span><br><span class="line"><span class="built_in">echo</span> 0 &gt;/proc/sys/vm/swappiness    çš„å†…å®¹æ”¹æˆ0ï¼ˆä¸´æ—¶ï¼‰</span><br><span class="line">vim /etc/sysctl.conf</span><br><span class="line">æ·»åŠ :</span><br><span class="line">vm.swappiness=0 //æ­¤å‚æ•°å‘Šè¯‰ç³»ç»Ÿï¼Œåœ¨å†…å­˜ä¸å¤Ÿç”¨æ—¶ã€‚ä½¿ç”¨å†…å­˜å›æ”¶æœºåˆ¶è§£å†³ï¼Œè€Œä¸æ˜¯å€¾å‘äºä½¿ç”¨swap</span><br><span class="line">sysctl -p </span><br></pre></td></tr></table></figure>
<h3 id="2-2iostat"><a href="#2-2iostat" class="headerlink" title="2.2iostat"></a>2.2iostat</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">yum install -y sysstat</span><br><span class="line">[root@db03 ~]<span class="comment"># df -Th</span></span><br><span class="line">æ–‡ä»¶ç³»ç»Ÿ                ç±»å‹      å®¹é‡  å·²ç”¨  å¯ç”¨ å·²ç”¨% æŒ‚è½½ç‚¹</span><br><span class="line">/dev/sdb1               xfs       5.0G  166M  4.9G    4% /data</span><br><span class="line"></span><br><span class="line">[root@db03 ~]<span class="comment"># iostat -dk 1 //æ¯ç§’å®æ—¶è¯»å†™æ€§èƒ½ kbä¸ºå•ä½</span></span><br><span class="line">Device:            tps    kB_read/s    kB_wrtn/s    kB_read    kB_wrtn</span><br><span class="line">sdb               0.00         0.00         0.00          0          0</span><br><span class="line">sda               0.00         0.00         0.00          0          0</span><br><span class="line">dm-0              0.00         0.00         0.00          0          0</span><br><span class="line"></span><br><span class="line">Device:            tps    kB_read/s    kB_wrtn/s    kB_read    kB_wrtn</span><br><span class="line">sdb               0.00         0.00         0.00          0          0</span><br><span class="line">sda               0.00         0.00         0.00          0          0</span><br><span class="line">dm-0              0.00         0.00         0.00          0          0</span><br><span class="line"></span><br><span class="line">[root@db03 ~]<span class="comment"># dd if=/dev/zero of=/data/bigfile bs=1M count=2048 //æŒç»­å†™å…¥åˆ¤æ–­å½“å‰ç¡¬ç›˜ioååé‡</span></span><br><span class="line">è®°å½•äº†2048+0 çš„è¯»å…¥</span><br><span class="line">è®°å½•äº†2048+0 çš„å†™å‡º</span><br><span class="line">2147483648å­—èŠ‚(2.1 GB)å·²å¤åˆ¶ï¼Œ4.08114 ç§’ï¼Œ526 MB/ç§’</span><br></pre></td></tr></table></figure>
<h3 id="2-3ç»¼åˆåˆ¤æ–­"><a href="#2-3ç»¼åˆåˆ¤æ–­" class="headerlink" title="2.3ç»¼åˆåˆ¤æ–­"></a>2.3ç»¼åˆåˆ¤æ–­</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">ä¸€èˆ¬æƒ…å†µä¸‹ï¼ŒCPUé«˜ï¼ŒIOä¹Ÿåº”è¯¥é«˜ã€‚</span><br><span class="line">å¦‚æœï¼šCPU é«˜   ï¼ŒIO æ¯”è¾ƒä½</span><br><span class="line"><span class="built_in">wait</span> é«˜ï¼š  æœ‰å¯ä»¥èƒ½IOå‡ºé—®é¢˜äº†ï¼ˆRaidæŸå,è¿‡åº¦æ¡å¸¦åŒ–ï¼‰</span><br><span class="line">SyS  é«˜ï¼š  æœ‰å¯èƒ½æ˜¯é”çš„é—®é¢˜ï¼Œéœ€è¦è¿›ä¸€æ­¥å»æ•°æ®åº“ä¸­åˆ¤æ–­</span><br></pre></td></tr></table></figure>
<h3 id="2-4vmstat"><a href="#2-4vmstat" class="headerlink" title="2.4vmstat"></a>2.4vmstat</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">[root@db03 ~]<span class="comment"># vmstat 1 //ç»¼åˆæ¢æµ‹ï¼Œå†…å­˜ï¼Œswapï¼Œioï¼Œsystemï¼Œcpuå®æ—¶æŒ‡æ ‡</span></span><br><span class="line">procs -----------memory---------- ---swap-- -----io---- -system-- ------cpu-----</span><br><span class="line"> r  b   swpd   free   buff  cache   si   so    bi    bo   <span class="keyword">in</span>   cs us sy <span class="built_in">id</span> wa st</span><br><span class="line"> 1  0      0 1302256   5208 2284188    0    0     5    88   16   29  0  0 100  0  0</span><br><span class="line"> 0  0      0 1302208   5208 2284188    0    0     0     4   56   67  0  0 100  0  0</span><br><span class="line"> 0  0      0 1302264   5208 2284188    0    0     0     0   31   56  0  0 100  0  0</span><br><span class="line"> 0  0      0 1302264   5208 2284188    0    0     0     0   32   66  0  0 100  0  0</span><br><span class="line"> 0  0      0 1302264   5208 2284188    0    0     0     0   25   53  0  0 100  0  0</span><br></pre></td></tr></table></figure>
<h2 id="3-æ•°æ®åº“ä¼˜åŒ–å·¥å…·ä»‹ç»"><a href="#3-æ•°æ®åº“ä¼˜åŒ–å·¥å…·ä»‹ç»" class="headerlink" title="3.æ•°æ®åº“ä¼˜åŒ–å·¥å…·ä»‹ç»"></a>3.æ•°æ®åº“ä¼˜åŒ–å·¥å…·ä»‹ç»</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">    show status  </span><br><span class="line">    show variables </span><br><span class="line">    show index  </span><br><span class="line">    show processlist </span><br><span class="line">    show slave status</span><br><span class="line">    show engine innodb status </span><br><span class="line">    desc /explain </span><br><span class="line">    slowlog</span><br><span class="line">æ‰©å±•ç±»æ·±åº¦ä¼˜åŒ–:</span><br><span class="line">    ptç³»åˆ—ï¼ˆpt-query-digest pt-osc pt-index ç­‰ï¼‰</span><br><span class="line">    mysqlslap </span><br><span class="line">    sysbench </span><br><span class="line">    information_schema ï¼ˆI_Sï¼‰</span><br><span class="line">    performance_schema (P_S)</span><br><span class="line">    sys </span><br></pre></td></tr></table></figure>

<h2 id="4-ä¼˜åŒ–æ€è·¯åˆ†è§£"><a href="#4-ä¼˜åŒ–æ€è·¯åˆ†è§£" class="headerlink" title="4.ä¼˜åŒ–æ€è·¯åˆ†è§£"></a>4.ä¼˜åŒ–æ€è·¯åˆ†è§£</h2><h3 id="4-1-ç¡¬ä»¶ä¼˜åŒ–"><a href="#4-1-ç¡¬ä»¶ä¼˜åŒ–" class="headerlink" title="4.1 ç¡¬ä»¶ä¼˜åŒ–"></a>4.1 ç¡¬ä»¶ä¼˜åŒ–</h3><h4 id="4-1-1ä¸»æœº"><a href="#4-1-1ä¸»æœº" class="headerlink" title="4.1.1ä¸»æœº"></a>4.1.1ä¸»æœº</h4><ul>
<li><strong>çœŸå®çš„ç¡¬ä»¶ï¼ˆPC Serverï¼‰</strong>ï¼š<ul>
<li>DELL  Rç³»åˆ— </li>
<li>åä¸º</li>
<li>æµªæ½®</li>
<li>HP</li>
<li>è”æƒ³</li>
</ul>
</li>
<li><strong>äº‘äº§å“</strong>ï¼š<ul>
<li>ECS</li>
<li>æ•°æ®åº“RDS</li>
<li>DRDS</li>
<li>polarDB</li>
</ul>
</li>
</ul>
<p><strong>IBM å°å‹æœº</strong> P6  570  595   P7 720  750 780     P8 </p>
<ul>
<li><strong>CPUæ ¹æ®æ•°æ®åº“ç±»å‹</strong><ul>
<li>OLTP  //åœ¨çº¿äº‹åŠ¡å¤„ç†</li>
<li>OLAP  //æŸ¥è¯¢ç±»å¾ˆå¤šï¼Œä»“åº“ç±»</li>
</ul>
</li>
</ul>
<p><strong>ä¸šåŠ¡ç±»å‹ï¼š</strong><br><strong>IOå¯†é›†å‹</strong>ï¼šçº¿ä¸Šç³»ç»Ÿï¼ŒOLTPä¸»è¦æ˜¯IOå¯†é›†å‹çš„ä¸šåŠ¡ï¼Œé«˜å¹¶å‘<br><strong>CPUå¯†é›†å‹</strong>ï¼šæ•°æ®åˆ†ææ•°æ®å¤„ç†ï¼ŒOLAPï¼Œcpuå¯†é›†å‹çš„ï¼Œéœ€è¦CPUé«˜è®¡ç®—èƒ½åŠ›ï¼ˆiç³»åˆ—ï¼ŒIBM powerç³»åˆ—ï¼‰</p>
<p><strong>æ ¹æ®ä¸šåŠ¡é€‰å‹ï¼š</strong><br><strong>CPUå¯†é›†å‹</strong>ï¼š I ç³»åˆ—çš„ï¼Œä¸»é¢‘å¾ˆé«˜ï¼Œæ ¸å¿ƒå°‘<br><strong>IOå¯†é›†å‹</strong>ï¼š  Eç³»åˆ—ï¼ˆè‡³å¼ºï¼‰ï¼Œä¸»é¢‘ç›¸å¯¹ä½ï¼Œæ ¸å¿ƒæ•°é‡å¤š</p>
<h4 id="4-1-2å†…å­˜"><a href="#4-1-2å†…å­˜" class="headerlink" title="4.1.2å†…å­˜"></a>4.1.2å†…å­˜</h4><p>å»ºè®®2-3å€cpuæ ¸å¿ƒæ•°é‡ ï¼ˆECCç‰ˆï¼‰</p>
<h4 id="4-1-3ç£ç›˜é€‰æ‹©"><a href="#4-1-3ç£ç›˜é€‰æ‹©" class="headerlink" title="4.1.3ç£ç›˜é€‰æ‹©"></a>4.1.3ç£ç›˜é€‰æ‹©</h4><ul>
<li>SATA-III&lt;SAS&lt;Fc(å…‰çº¤ç›˜)&lt;SSDï¼ˆsataï¼‰&lt;pci-e ssd&lt;Flash</li>
<li>ä¸»æœº RAIDå¡çš„BBUä¸»æœºå¤‡ç”¨ç”µæ± å•å…ƒ(Battery Backup Unit)å…³é—­</li>
</ul>
<h4 id="4-1-4å­˜å‚¨"><a href="#4-1-4å­˜å‚¨" class="headerlink" title="4.1.4å­˜å‚¨"></a>4.1.4å­˜å‚¨</h4><p>æ ¹æ®å­˜å‚¨æ•°æ®ç§ç±»çš„ä¸åŒï¼Œé€‰æ‹©ä¸åŒçš„å­˜å‚¨è®¾å¤‡<br>é…ç½®åˆç†çš„RAIDçº§åˆ«(raid5ã€raid10ã€çƒ­å¤‡ç›˜)   </p>
<ul>
<li>r0 :æ¡å¸¦åŒ– ,æ€§èƒ½é«˜</li>
<li>r1 :é•œåƒï¼Œå®‰å…¨</li>
<li>r5 :æ ¡éªŒ+æ¡å¸¦åŒ–ï¼Œå®‰å…¨è¾ƒé«˜+æ€§èƒ½è¾ƒé«˜ï¼ˆè¯»ï¼‰ï¼Œå†™æ€§èƒ½è¾ƒä½ ï¼ˆé€‚åˆäºè¯»å¤šå†™å°‘ï¼‰</li>
<li>r10ï¼šå®‰å…¨+æ€§èƒ½éƒ½å¾ˆé«˜ï¼Œæœ€å°‘å››å—ç›˜ï¼Œæµªè´¹ä¸€åŠçš„ç©ºé—´ï¼ˆé«˜IOè¦æ±‚ï¼‰</li>
</ul>
<h4 id="4-1-5ç½‘ç»œ"><a href="#4-1-5ç½‘ç»œ" class="headerlink" title="4.1.5ç½‘ç»œ"></a>4.1.5ç½‘ç»œ</h4><ul>
<li>1ã€ç¡¬ä»¶ä¹°å¥½çš„ï¼ˆå•å¡å•å£ï¼‰</li>
<li>2ã€ç½‘å¡ç»‘å®šï¼ˆbondingï¼‰ï¼Œäº¤æ¢æœºå †å </li>
</ul>
<p>ä»¥ä¸Šé—®é¢˜ï¼Œæå‰è§„é¿æ‰ã€‚</p>
<h2 id="5-æ“ä½œç³»ç»Ÿä¼˜åŒ–"><a href="#5-æ“ä½œç³»ç»Ÿä¼˜åŒ–" class="headerlink" title="5.æ“ä½œç³»ç»Ÿä¼˜åŒ–"></a>5.æ“ä½œç³»ç»Ÿä¼˜åŒ–</h2><h3 id="5-1Swapè°ƒæ•´"><a href="#5-1Swapè°ƒæ•´" class="headerlink" title="5.1Swapè°ƒæ•´"></a>5.1Swapè°ƒæ•´</h3><p><code>echo 0 &gt;/proc/sys/vm/swappiness</code>çš„å†…å®¹æ”¹æˆ0ï¼ˆä¸´æ—¶ï¼‰ï¼Œ<br><code>vim /etc/sysctl.conf</code><br>ä¸Šæ·»åŠ <code>vm.swappiness=0</code>ï¼ˆæ°¸ä¹…ï¼‰<br><code>sysctl -p</code><br>è¿™ä¸ªå‚æ•°å†³å®šäº†Linuxæ˜¯å€¾å‘äºä½¿ç”¨swapï¼Œè¿˜æ˜¯å€¾å‘äºé‡Šæ”¾æ–‡ä»¶ç³»ç»Ÿcacheã€‚åœ¨å†…å­˜ç´§å¼ çš„æƒ…å†µä¸‹ï¼Œæ•°å€¼è¶Šä½è¶Šå€¾å‘äºé‡Šæ”¾æ–‡ä»¶ç³»ç»Ÿcacheã€‚<br>å½“ç„¶ï¼Œè¿™ä¸ªå‚æ•°åªèƒ½å‡å°‘ä½¿ç”¨swapçš„æ¦‚ç‡ï¼Œå¹¶ä¸èƒ½é¿å…Linuxä½¿ç”¨swapã€‚</p>
<p>ä¿®æ”¹MySQLçš„é…ç½®å‚æ•°<code>innodb_flush_methodï¼Œå¼€å¯O_DIRECT</code>æ¨¡å¼<br>è¿™ç§æƒ…å†µä¸‹ï¼ŒInnoDBçš„<code>buffer pool</code>ä¼šç›´æ¥ç»•è¿‡æ–‡ä»¶ç³»ç»Ÿcacheæ¥è®¿é—®ç£ç›˜ï¼Œä½†æ˜¯<code>redo log</code>ä¾æ—§ä¼šä½¿ç”¨æ–‡ä»¶ç³»ç»Ÿcacheã€‚å€¼å¾—æ³¨æ„çš„æ˜¯ï¼ŒRedo logæ˜¯è¦†å†™æ¨¡å¼çš„ï¼Œå³ä½¿ä½¿ç”¨äº†æ–‡ä»¶ç³»ç»Ÿçš„cacheï¼Œä¹Ÿä¸ä¼šå ç”¨å¤ªå¤š</p>
<p>IOè°ƒåº¦ç­–ç•¥<br>centos 7 é»˜è®¤æ˜¯deadline<br><code>cat   /sys/block/sda/queue/scheduler</code></p>
<p>#ä¸´æ—¶ä¿®æ”¹ä¸ºdeadline(centos6)</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">echo</span> deadline &gt;/sys/block/sda/queue/scheduler </span><br><span class="line">vi /boot/grub/grub.conf</span><br></pre></td></tr></table></figure>
<p>æ›´æ”¹åˆ°å¦‚ä¸‹å†…å®¹:<br><code>kernel /boot/vmlinuz-2.6.18-8.el5 ro root=LABEL=/ elevator=deadline rhgb quiet</code></p>
<p>IO ï¼š</p>
<ul>
<li>raid</li>
<li>no lvm<code>å®‰å…¨æ€§</code></li>
<li>ext4æˆ–xfs<code>å¹¶å‘é«˜</code></li>
<li>ssd</li>
<li>IOè°ƒåº¦ç­–ç•¥<br>æå‰è§„åˆ’å¥½ä»¥ä¸Šæ‰€æœ‰é—®é¢˜ï¼Œå‡è½»MySQLä¼˜åŒ–çš„éš¾åº¦ã€‚</li>
</ul>
<h2 id="6-åº”ç”¨ç«¯"><a href="#6-åº”ç”¨ç«¯" class="headerlink" title="6.åº”ç”¨ç«¯"></a>6.åº”ç”¨ç«¯</h2><ol>
<li>å¼€å‘è¿‡ç¨‹è§„èŒƒ,æ ‡å‡†ã€‚åšå¥½å®¡æ ¸ã€‚</li>
<li>å‡å°‘çƒ‚SQL:ä¸èµ°ç´¢å¼•,å¤æ‚é€»è¾‘,åˆ‡å‰²å¤§äº‹åŠ¡.</li>
<li>é¿å…ä¸šåŠ¡é€»è¾‘é”™è¯¯,é¿å…é”äº‰ç”¨.<br>è¿™ä¸ªé˜¶æ®µ,éœ€è¦æˆ‘ä»¬DBAæ·±å…¥ä¸šåŠ¡,æˆ–è€…è¦å’Œå¼€å‘äººå‘˜\ä¸šåŠ¡äººå‘˜é…åˆå®ç°</li>
</ol>
<h2 id="7-å‚æ•°ä¼˜åŒ–"><a href="#7-å‚æ•°ä¼˜åŒ–" class="headerlink" title="7.å‚æ•°ä¼˜åŒ–"></a>7.å‚æ•°ä¼˜åŒ–</h2><h3 id="7-1-max-connections-æœ€å¤§è¿æ¥æ•°"><a href="#7-1-max-connections-æœ€å¤§è¿æ¥æ•°" class="headerlink" title="7.1:max_connections æœ€å¤§è¿æ¥æ•°"></a>7.1:max_connections æœ€å¤§è¿æ¥æ•°</h3><p>ï¼ˆ1ï¼‰ç®€ä»‹<br>Mysqlçš„æœ€å¤§è¿æ¥æ•°ï¼Œå¦‚æœæœåŠ¡å™¨çš„å¹¶å‘è¯·æ±‚é‡æ¯”è¾ƒå¤§ï¼Œå¯ä»¥è°ƒé«˜è¿™ä¸ªå€¼ï¼Œå½“ç„¶è¿™æ˜¯è¦å»ºç«‹åœ¨æœºå™¨èƒ½å¤Ÿæ”¯æ’‘çš„æƒ…å†µä¸‹ï¼Œå› ä¸ºå¦‚æœè¿æ¥æ•°è¶Šæ¥è¶Šå¤šï¼Œmysqlä¼šä¸ºæ¯ä¸ªè¿æ¥æä¾›ç¼“å†²åŒºï¼Œå°±ä¼šå¼€é”€çš„è¶Šå¤šçš„å†…å­˜ï¼Œæ‰€ä»¥éœ€è¦é€‚å½“çš„è°ƒæ•´è¯¥å€¼ï¼Œä¸èƒ½éšä¾¿å»æé«˜è®¾å€¼ã€‚<br>ï¼ˆ2ï¼‰åˆ¤æ–­ä¾æ®</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">show variables like <span class="string">&#x27;max_connections&#x27;</span>; //æœ€å¤§è¿æ¥æ•°</span><br><span class="line">    +-----------------+-------+</span><br><span class="line">    | Variable_name   | Value |</span><br><span class="line">    +-----------------+-------+</span><br><span class="line">    | max_connections | 151   |</span><br><span class="line">    +-----------------+-------+</span><br><span class="line">show status like <span class="string">&#x27;Max_used_connections&#x27;</span>; //æœ€å¤§ä½¿ç”¨è¿‡çš„è¿æ¥æ•°</span><br><span class="line">    +----------------------+-------+</span><br><span class="line">    | Variable_name        | Value |</span><br><span class="line">    +----------------------+-------+</span><br><span class="line">    | Max_used_connections | 152   |</span><br><span class="line">    +----------------------+-------+</span><br></pre></td></tr></table></figure>
<p>ï¼ˆ3ï¼‰ä¿®æ”¹æ–¹å¼ä¸¾ä¾‹</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">vim /etc/my.cnf </span><br><span class="line">max_connections=1024</span><br></pre></td></tr></table></figure>
<p>è¡¥å……:</p>
<ul>
<li>1.å¼€å¯æ•°æ®åº“æ—¶,æˆ‘ä»¬å¯ä»¥ä¸´æ—¶è®¾ç½®ä¸€ä¸ªæ¯”è¾ƒå¤§çš„æµ‹è¯•å€¼</li>
<li>2.è§‚å¯Ÿshow status like â€˜Max_used_connectionsâ€™;å˜åŒ–</li>
<li>3.å¦‚æœmax_used_connectionsè·Ÿmax_connectionsç›¸åŒ,<br>  é‚£ä¹ˆå°±æ˜¯max_connectionsè®¾ç½®è¿‡ä½æˆ–è€…è¶…è¿‡æœåŠ¡å™¨çš„è´Ÿè½½ä¸Šé™äº†ï¼ŒCPUä½äº10%åˆ™è®¾ç½®è¿‡å¤§. </li>
</ul>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">å†æ¬¡è¿è¡Œå‹åŠ›æµ‹è¯•ï¼š</span><br><span class="line">[root@db03 ~]<span class="comment"># mysqlslap --defaults-file=/etc/my.cnf --socket /tmp/mysql.sock --concurrency=1000 --iterations=1 --create-schema=&#x27;oldboy&#x27; --query=&quot;select * from oldboy.t100w where k2=&#x27;GHvw&#x27;&quot; engine=innodb --number-of-queries=20000 -verbose</span></span><br><span class="line">    </span><br><span class="line">%Cpu0  : 99.3 us,  0.7 sy,  0.0 ni,  0.0 <span class="built_in">id</span>,  0.0 wa,  0.0 hi,  0.0 si,  0.0 st</span><br><span class="line">%Cpu1  : 99.3 us,  0.7 sy,  0.0 ni,  0.0 <span class="built_in">id</span>,  0.0 wa,  0.0 hi,  0.0 si,  0.0 st</span><br><span class="line">%Cpu2  : 99.3 us,  0.7 sy,  0.0 ni,  0.0 <span class="built_in">id</span>,  0.0 wa,  0.0 hi,  0.0 si,  0.0 st</span><br><span class="line">%Cpu3  : 99.7 us,  0.3 sy,  0.0 ni,  0.0 <span class="built_in">id</span>,  0.0 wa,  0.0 hi,  0.0 si,  0.0 st</span><br><span class="line">KiB Mem :  3880016 total,   510428 free,   743280 used,  2626308 buff/cache</span><br><span class="line">KiB Swap:  2097148 total,  2097148 free,        0 used.  2881592 avail Mem </span><br><span class="line"></span><br><span class="line">  PID USER      PR  NI    VIRT    RES    SHR S  %CPU %MEM     TIME+ COMMAND                                         </span><br><span class="line"> 6129 mysql     20   0 2898540 436412  11212 S 399.3 11.2   6:27.35 mysqld  </span><br><span class="line">//CPUå‹åŠ›è¿‡é«˜ï¼Œè¯´æ˜æœ€å¤§è¿æ¥æ•°è¿˜æ˜¯å¾—è°ƒä½ã€‚</span><br><span class="line"></span><br><span class="line">db03 [(none)]&gt;show variables like <span class="string">&#x27;max_connections&#x27;</span>;</span><br><span class="line">+-----------------+-------+</span><br><span class="line">| Variable_name   | Value |</span><br><span class="line">+-----------------+-------+</span><br><span class="line">| max_connections | 1024  |</span><br><span class="line">+-----------------+-------+</span><br><span class="line">1 row <span class="keyword">in</span> <span class="built_in">set</span> (0.00 sec)</span><br><span class="line"></span><br><span class="line">db03 [(none)]&gt;show status like <span class="string">&#x27;Max_used_connections&#x27;</span>;</span><br><span class="line">+----------------------+-------+</span><br><span class="line">| Variable_name        | Value |</span><br><span class="line">+----------------------+-------+</span><br><span class="line">| Max_used_connections | 1002  |</span><br><span class="line">+----------------------+-------+</span><br><span class="line">1 row <span class="keyword">in</span> <span class="built_in">set</span> (0.01 sec)</span><br></pre></td></tr></table></figure>

<hr>
<h3 id="7-2-back-log-é¢„å¤‡è¿æ¥æ•°"><a href="#7-2-back-log-é¢„å¤‡è¿æ¥æ•°" class="headerlink" title="7.2:back_log é¢„å¤‡è¿æ¥æ•°"></a>7.2:back_log é¢„å¤‡è¿æ¥æ•°</h3><p>ï¼ˆ1ï¼‰ç®€ä»‹<br>mysqlèƒ½æš‚å­˜çš„è¿æ¥æ•°é‡ï¼Œå½“ä¸»è¦mysqlçº¿ç¨‹åœ¨ä¸€ä¸ªå¾ˆçŸ­æ—¶é—´å†…å¾—åˆ°éå¸¸å¤šçš„è¿æ¥è¯·æ±‚æ—¶å€™å®ƒå°±ä¼šèµ·ä½œç”¨ï¼Œå¦‚æœmysqlçš„è¿æ¥æ•°æ®è¾¾åˆ°max_connectionsæ—¶å€™ï¼Œæ–°æ¥çš„è¯·æ±‚å°†ä¼šè¢«å­˜åœ¨å †æ ˆä¸­ï¼Œç­‰å¾…æŸä¸€è¿æ¥é‡Šæ”¾èµ„æºï¼Œè¯¥æ¨æ ˆçš„æ•°é‡åŠback_log,å¦‚æœç­‰å¾…è¿æ¥çš„æ•°é‡è¶…è¿‡back_logï¼Œå°†ä¸è¢«æˆäºˆè¿æ¥èµ„æºã€‚<br>back_logå€¼æŒ‡å‡ºåœ¨mysqlæš‚æ—¶åœæ­¢å›ç­”æ–°è¯·æ±‚ä¹‹å‰çš„çŸ­æ—¶é—´å†…æœ‰å¤šå°‘ä¸ªè¯·æ±‚å¯ä»¥è¢«å­˜åœ¨æ¨æ ˆä¸­ï¼Œåªæœ‰å¦‚æœæœŸæœ›åœ¨ä¸€ä¸ªçŸ­æ—¶é—´å†…æœ‰å¾ˆå¤šè¿æ¥çš„æ—¶å€™éœ€è¦å¢åŠ å®ƒ<br>ï¼ˆ2ï¼‰åˆ¤æ–­ä¾æ®<br><code>show full processlist</code><br>å‘ç°å¤§é‡çš„å¾…è¿æ¥è¿›ç¨‹æ—¶ï¼Œå°±éœ€è¦åŠ å¤§back_logæˆ–è€…åŠ å¤§<code>max_connections</code>çš„å€¼<br>ï¼ˆ3ï¼‰ä¿®æ”¹æ–¹å¼ä¸¾ä¾‹</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">vim /etc/my.cnf </span><br><span class="line">back_log=1024 //é¢å¤–çš„1024ä¸ªè¿›ç¨‹ç­‰å¾…èµ„æºé‡Šæ”¾åç«‹å³å·¥ä½œã€‚å‡å°‘æŠ¥é”™</span><br></pre></td></tr></table></figure>

<hr>
<h3 id="7-3-wait-timeoutå’Œinteractive-timeout-ä¼šè¯è¶…æ—¶"><a href="#7-3-wait-timeoutå’Œinteractive-timeout-ä¼šè¯è¶…æ—¶" class="headerlink" title="7.3:wait_timeoutå’Œinteractive_timeout  ä¼šè¯è¶…æ—¶"></a>7.3:wait_timeoutå’Œinteractive_timeout  ä¼šè¯è¶…æ—¶</h3><p>ï¼ˆ1ï¼‰ç®€ä»‹<br><code>wait_timeoutï¼š</code>æŒ‡çš„æ˜¯mysqlåœ¨å…³é—­ä¸€ä¸ªéäº¤äº’çš„è¿æ¥ä¹‹å‰æ‰€è¦ç­‰å¾…çš„ç§’æ•°<br><code>interactive_timeoutï¼š</code>æŒ‡çš„æ˜¯mysqlåœ¨å…³é—­ä¸€ä¸ªäº¤äº’çš„è¿æ¥ä¹‹å‰æ‰€éœ€è¦ç­‰å¾…çš„ç§’æ•°ï¼Œæ¯”å¦‚æˆ‘ä»¬åœ¨ç»ˆç«¯ä¸Šè¿›è¡Œmysqlç®¡ç†ï¼Œä½¿ç”¨çš„å³ä½¿äº¤äº’çš„è¿æ¥ï¼Œè¿™æ—¶å€™ï¼Œå¦‚æœæ²¡æœ‰æ“ä½œçš„æ—¶é—´è¶…è¿‡äº†interactive_timeè®¾ç½®çš„æ—¶é—´å°±ä¼šè‡ªåŠ¨çš„æ–­å¼€ï¼Œé»˜è®¤çš„æ˜¯28800ï¼Œå¯è°ƒä¼˜ä¸º7200ã€‚<br>wait_timeout:å¦‚æœè®¾ç½®å¤ªå°ï¼Œé‚£ä¹ˆè¿æ¥å…³é—­çš„å°±å¾ˆå¿«ï¼Œä»è€Œä½¿ä¸€äº›æŒä¹…çš„è¿æ¥ä¸èµ·ä½œç”¨<br>ï¼ˆ2ï¼‰è®¾ç½®å»ºè®®<br>å¦‚æœè®¾ç½®å¤ªå¤§ï¼Œå®¹æ˜“é€ æˆè¿æ¥æ‰“å¼€æ—¶é—´è¿‡é•¿ï¼Œåœ¨show processlistæ—¶å€™ï¼Œèƒ½çœ‹åˆ°å¾ˆå¤šçš„è¿æ¥ ï¼Œä¸€èˆ¬å¸Œæœ›wait_timeoutå°½å¯èƒ½ä½<br>ï¼ˆ3ï¼‰ä¿®æ”¹æ–¹å¼ä¸¾ä¾‹<br><code>wait_timeout=60</code> //ç©ºé—²60sè‡ªåŠ¨æ–­å¼€âˆš<br><code>interactive_timeout=1200</code> //1200sè‡ªåŠ¨æ–­å¼€<br>é•¿è¿æ¥çš„åº”ç”¨ï¼Œä¸ºäº†ä¸å»åå¤çš„å›æ”¶å’Œåˆ†é…èµ„æºï¼Œé™ä½é¢å¤–çš„å¼€é”€</p>
<p>æ³¨æ„ï¼šä¸€èˆ¬æˆ‘ä»¬ä¼šå°†<code>wait_timeout</code>è®¾å®šæ¯”è¾ƒå°ï¼Œ<code>interactive_timeout</code>è¦å’Œåº”ç”¨å¼€å‘äººå‘˜æ²Ÿé€šé•¿é“¾æ¥çš„åº”ç”¨æ˜¯å¦å¾ˆå¤šã€‚å¦‚æœä»–éœ€è¦é•¿é“¾æ¥ï¼Œé‚£ä¹ˆè¿™ä¸ªå€¼å¯ä»¥ä¸éœ€è¦è°ƒæ•´ã€‚<br>å¦å¤–è¿˜å¯ä»¥ä½¿ç”¨ç±»å¤–çš„å‚æ•°å¼¥è¡¥ã€‚</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">db03 [(none)]&gt;show variables like <span class="string">&#x27;%timeout%&#x27;</span></span><br><span class="line">    -&gt; ;</span><br><span class="line">+-----------------------------+----------+</span><br><span class="line">| Variable_name               | Value    |</span><br><span class="line">+-----------------------------+----------+</span><br><span class="line">| connect_timeout             | 10       |</span><br><span class="line">| delayed_insert_timeout      | 300      |</span><br><span class="line">| have_statement_timeout      | YES      |</span><br><span class="line">| innodb_flush_log_at_timeout | 1        |</span><br><span class="line">| innodb_lock_wait_timeout    | 50       |</span><br><span class="line">| innodb_rollback_on_timeout  | OFF      |</span><br><span class="line">| interactive_timeout         | 28800    | //ä¼šè¯è¶…æ—¶æ¯8å°æ—¶</span><br><span class="line">| lock_wait_timeout           | 31536000 |</span><br><span class="line">| net_read_timeout            | 30       |</span><br><span class="line">| net_write_timeout           | 60       |</span><br><span class="line">| rpl_stop_slave_timeout      | 31536000 |</span><br><span class="line">| slave_net_timeout           | 60       |</span><br><span class="line">| wait_timeout                | 28800    | //é»˜è®¤8å°æ—¶</span><br><span class="line">+-----------------------------+----------+</span><br><span class="line">13 rows <span class="keyword">in</span> <span class="built_in">set</span> (0.00 sec)</span><br></pre></td></tr></table></figure>

<hr>
<h3 id="7-4-key-buffer-size-ä¸´æ—¶è¡¨ç›¸å…³"><a href="#7-4-key-buffer-size-ä¸´æ—¶è¡¨ç›¸å…³" class="headerlink" title="7.4:key_buffer_size ä¸´æ—¶è¡¨ç›¸å…³"></a>7.4:key_buffer_size ä¸´æ—¶è¡¨ç›¸å…³</h3><p>ï¼ˆ1ï¼‰ç®€ä»‹<br>key_buffer_sizeæŒ‡å®šç´¢å¼•ç¼“å†²åŒºçš„å¤§å°ï¼Œå®ƒå†³å®šç´¢å¼•å¤„ç†çš„é€Ÿåº¦ï¼Œå°¤å…¶æ˜¯ç´¢å¼•è¯»çš„é€Ÿåº¦<br>ã€Š1ã€‹æ­¤å‚æ•°ä¸myisamè¡¨çš„ç´¢å¼•æœ‰å…³(å‡ ä¹ä¸ç”¨)<br>ã€Š2ã€‹ä¸´æ—¶è¡¨çš„åˆ›å»ºæœ‰å…³ï¼ˆå¤šè¡¨é“¾æ¥ã€å­æŸ¥è¯¢ä¸­ã€unionï¼‰<br>     åœ¨æœ‰ä»¥ä¸ŠæŸ¥è¯¢è¯­å¥å‡ºç°çš„æ—¶å€™ï¼Œéœ€è¦åˆ›å»ºä¸´æ—¶è¡¨ï¼Œç”¨å®Œä¹‹åä¼šè¢«ä¸¢å¼ƒ<br>     ä¸´æ—¶è¡¨æœ‰ä¸¤ç§åˆ›å»ºæ–¹å¼ï¼š</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">å†…å­˜ä¸­-------&gt;key_buffer_size</span><br><span class="line">ç£ç›˜ä¸Š-------&gt;ibdata1(5.6)</span><br><span class="line">              ibtmp1 (5.7ï¼‰</span><br></pre></td></tr></table></figure>
<p>ï¼ˆ2ï¼‰è®¾ç½®ä¾æ®<br>é€šè¿‡key_read_requestså’Œkey_readså¯ä»¥ç›´åˆ°key_baffer_sizeè®¾ç½®æ˜¯å¦åˆç†ã€‚</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; show variables like <span class="string">&quot;key_buffer_size%&quot;</span>;</span><br><span class="line">+-----------------+---------+</span><br><span class="line">| Variable_name   | Value   |</span><br><span class="line">+-----------------+---------+</span><br><span class="line">| key_buffer_size | 8388608 |//é»˜è®¤ä¸º8M</span><br><span class="line">+-----------------+---------+</span><br><span class="line">1 row <span class="keyword">in</span> <span class="built_in">set</span> (0.00 sec)</span><br><span class="line"></span><br><span class="line">mysql&gt; show status like <span class="string">&quot;key_read%&quot;</span>;</span><br><span class="line">+-------------------+-------+</span><br><span class="line">| Variable_name     | Value |</span><br><span class="line">+-------------------+-------+</span><br><span class="line">| Key_read_requests | 10    |</span><br><span class="line">| Key_reads         | 2     |</span><br><span class="line">+-------------------+-------+</span><br><span class="line">2 rows <span class="keyword">in</span> <span class="built_in">set</span> (0.00 sec)</span><br></pre></td></tr></table></figure>
<p>ä¸€å…±æœ‰10ä¸ªç´¢å¼•è¯»å–è¯·æ±‚ï¼Œæœ‰2ä¸ªè¯·æ±‚åœ¨å†…å­˜ä¸­æ²¡æœ‰æ‰¾åˆ°ç›´æ¥ä»ç¡¬ç›˜ä¸­è¯»å–ç´¢å¼•<br>æ§åˆ¶åœ¨ 5%ä»¥å†… ã€‚<br>æ³¨ï¼škey_buffer_sizeåªå¯¹myisamè¡¨èµ·ä½œç”¨ï¼Œå³ä½¿ä¸ä½¿ç”¨myisamè¡¨ï¼Œä½†æ˜¯å†…éƒ¨çš„ä¸´æ—¶ç£ç›˜è¡¨æ˜¯myisamè¡¨ï¼Œä¹Ÿè¦ä½¿ç”¨è¯¥å€¼ã€‚<br>å¯ä»¥ä½¿ç”¨æ£€æŸ¥çŠ¶æ€å€¼created_tmp_disk_tableså¾—çŸ¥ï¼š</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; show status like <span class="string">&quot;created_tmp%&quot;</span>;   //åˆ›å»ºä¸´æ—¶è¡¨çš„çŠ¶æ€ä¿¡æ¯</span><br><span class="line">+-------------------------+-------+</span><br><span class="line">| Variable_name           | Value |</span><br><span class="line">+-------------------------+-------+</span><br><span class="line">| Created_tmp_disk_tables | 0     | //åœ¨ç£ç›˜ä¸Šç”Ÿæˆçš„æ–‡ä»¶ä¸ªæ•°</span><br><span class="line">| Created_tmp_files       | 6     | //ä¸´æ—¶è¡¨çš„ä¸ªæ•°</span><br><span class="line">| Created_tmp_tables      | 1     | //åœ¨å†…å­˜ä¸­ç”Ÿæˆçš„ä¸ªæ•°</span><br><span class="line">+-------------------------+-------+</span><br><span class="line">3 rows <span class="keyword">in</span> <span class="built_in">set</span> (0.00 sec)</span><br><span class="line">mysql&gt; </span><br></pre></td></tr></table></figure>
<p>é€šå¸¸åœ°ï¼Œæˆ‘ä»¬ä¹ æƒ¯ä»¥<br>Created_tmp_tables/(Created_tmp_disk_tables + Created_tmp_tables)   è¶Šé«˜è¶Šå¥½<br>å†…å­˜ä¸­ç”Ÿæˆçš„/(ç£ç›˜ä¸­ç”Ÿæˆ+å†…å­˜ä¸­ç”Ÿæˆçš„)<br>Created_tmp_disk_tables/(Created_tmp_disk_tables + Created_tmp_tables) </p>
<p>æˆ–è€…å·²å„è‡ªçš„ä¸€ä¸ªæ—¶æ®µå†…çš„å·®é¢è®¡ç®—ï¼Œæ¥åˆ¤æ–­åŸºäºå†…å­˜çš„ä¸´æ—¶è¡¨åˆ©ç”¨ç‡ã€‚æ‰€ä»¥ï¼Œæˆ‘ä»¬ä¼šæ¯”è¾ƒå…³æ³¨ Created_tmp_disk_tables æ˜¯å¦è¿‡å¤šï¼Œä»è€Œè®¤å®šå½“å‰æœåŠ¡å™¨è¿è¡ŒçŠ¶å†µçš„ä¼˜åŠ£ã€‚<br>Created_tmp_disk_tables/(Created_tmp_disk_tables + Created_tmp_tables)<br>æ§åˆ¶åœ¨5%-10%ä»¥å†…</p>
<p>çœ‹ä»¥ä¸‹ä¾‹å­ï¼š<br>åœ¨è°ƒç”¨mysqldumpå¤‡ä»½æ•°æ®æ—¶ï¼Œå¤§æ¦‚æ‰§è¡Œæ­¥éª¤å¦‚ä¸‹ï¼š</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">180322 17:39:33       7 Connect     root@localhost on</span><br><span class="line">7 Query       /*!40100 SET @@SQL_MODE=<span class="string">&#x27;&#x27;</span> */</span><br><span class="line">7 Init DB     guo</span><br><span class="line">7 Query       SHOW TABLES LIKE <span class="string">&#x27;guo&#x27;</span></span><br><span class="line">7 Query       LOCK TABLES `guo` READ /*!32311 LOCAL */</span><br><span class="line">7 Query       SET OPTION SQL_QUOTE_SHOW_CREATE=1</span><br><span class="line">7 Query       show create table `guo`</span><br><span class="line">7 Query       show fields from `guo`</span><br><span class="line">7 Query       show table status like <span class="string">&#x27;guo&#x27;</span></span><br><span class="line">7 Query       SELECT /*!40001 SQL_NO_CACHE */ * FROM `guo`</span><br><span class="line">7 Query       UNLOCK TABLES</span><br><span class="line">7 Quit</span><br></pre></td></tr></table></figure>
<p>å…¶ä¸­ï¼Œæœ‰ä¸€æ­¥æ˜¯ï¼šshow fields from <code>guo</code>ã€‚ä»slow queryè®°å½•çš„æ‰§è¡Œè®¡åˆ’ä¸­ï¼Œå¯ä»¥çŸ¥é“å®ƒä¹Ÿäº§ç”Ÿäº† Tmp_table_on_diskã€‚</p>
<p>æ‰€ä»¥è¯´ï¼Œä»¥ä¸Šå…¬å¼å¹¶ä¸èƒ½çœŸæ­£åæ˜ åˆ°mysqlé‡Œä¸´æ—¶è¡¨çš„åˆ©ç”¨ç‡ï¼Œæœ‰äº›æƒ…å†µä¸‹äº§ç”Ÿçš„ Tmp_table_on_disk æˆ‘ä»¬å®Œå…¨ä¸ç”¨æ‹…å¿ƒï¼Œå› æ­¤æ²¡å¿…è¦è¿‡åˆ†å…³æ³¨ Created_tmp_disk_tablesï¼Œä½†å¦‚æœå®ƒçš„å€¼å¤§çš„ç¦»è°±çš„è¯ï¼Œé‚£å°±å¥½å¥½æŸ¥ä¸€ä¸‹ï¼Œä½ çš„æœåŠ¡å™¨åˆ°åº•éƒ½åœ¨æ‰§è¡Œä»€ä¹ˆæŸ¥è¯¢äº†ã€‚ zabbixåœ¨ç›‘æ§æ—¶ï¼Œåº”é¿å¼€å¤‡ä»½æ—¶æ®µã€‚å¦åˆ™åœ¨å¤‡ä»½æ—¶ä¸´æ—¶è¡¨åœ¨ç¡¬ç›˜ä¸­ç”Ÿæˆçš„æ¯”ä¾‹ä¼šå¤§å¤§å¢åŠ ã€‚<br>ï¼ˆ3ï¼‰é…ç½®æ–¹æ³•<br>key_buffer_size=64M</p>
<hr>
<h3 id="7-5-query-cache-size-æŸ¥è¯¢ç¼“å­˜"><a href="#7-5-query-cache-size-æŸ¥è¯¢ç¼“å­˜" class="headerlink" title="7.5:query_cache_size æŸ¥è¯¢ç¼“å­˜"></a>7.5:query_cache_size æŸ¥è¯¢ç¼“å­˜</h3><p>ï¼ˆ1ï¼‰ç®€ä»‹ï¼š<br>æŸ¥è¯¢ç¼“å­˜ç®€ç§°QCï¼Œä½¿ç”¨æŸ¥è¯¢ç¼“å†²ï¼Œmysqlå°†æŸ¥è¯¢ç»“æœå­˜æ”¾åœ¨ç¼“å†²åŒºä¸­ï¼Œä»Šåå¯¹äºåŒæ ·çš„selectè¯­å¥ï¼ˆåŒºåˆ†å¤§å°å†™ï¼‰,å°†ç›´æ¥ä»ç¼“å†²åŒºä¸­è¯»å–ç»“æœã€‚</p>
<p>SQLå±‚ï¼š<br>select * from t1 where name=:NAME;<br>select * from t1 where name=:NAME;</p>
<p>1ã€æŸ¥è¯¢å®Œç»“æœä¹‹åï¼Œä¼šå¯¹SQLè¯­å¥è¿›è¡Œhashè¿ç®—ï¼Œå¾—å‡ºhashå€¼,æˆ‘ä»¬æŠŠä»–ç§°ä¹‹ä¸ºSQL_ID<br>2ã€ä¼šå°†å­˜å‚¨å¼•æ“è¿”å›çš„ç»“æœ+SQL_IDå­˜å‚¨åˆ°ç¼“å­˜ä¸­ã€‚</p>
<p>å­˜å‚¨æ–¹å¼ï¼š<br>ä¾‹å­ï¼šselect * from t1  where id=10;      100æ¬¡</p>
<p>1ã€å°†select * from t1  where id=10; è¿›è¡Œhashè¿ç®—è®¡ç®—å‡ºä¸€ä¸²hashå€¼ï¼Œæˆ‘ä»¬æŠŠå®ƒç§°ä¹‹ä¸ºâ€œSQL_IDâ€<br>2ã€å°†å­˜å‚¨å¼•æ“è¿”å›ä¸Šæ¥çš„è¡¨çš„å†…å®¹+SQLIDå­˜å‚¨åˆ°æŸ¥è¯¢ç¼“å­˜ä¸­</p>
<p>ä½¿ç”¨æ–¹å¼ï¼š<br>1ã€ä¸€æ¡SQLæ‰§è¡Œæ—¶ï¼Œè¿›è¡Œhashè¿ç®—ï¼Œå¾—å‡ºSQLIDï¼Œå»æ‰¾query cache<br>2ã€å¦‚æœcacheä¸­æœ‰ï¼Œåˆ™ç›´æ¥è¿”å›æ•°æ®è¡Œï¼Œå¦‚æœæ²¡æœ‰ï¼Œå°±èµ°åŸæœ‰çš„SQLæ‰§è¡Œæµç¨‹</p>
<p>ä¸€ä¸ªsqlæŸ¥è¯¢å¦‚æœä»¥selectå¼€å¤´ï¼Œé‚£ä¹ˆmysqlæœåŠ¡å™¨å°†å°è¯•å¯¹å…¶ä½¿ç”¨æŸ¥è¯¢ç¼“å­˜ã€‚<br>æ³¨ï¼šä¸¤ä¸ªsqlè¯­å¥ï¼Œåªè¦æƒ³å·®å“ªæ€•æ˜¯ä¸€ä¸ªå­—ç¬¦ï¼ˆåˆ—å¦‚å¤§å°å†™ä¸ä¸€æ ·ï¼›å¤šä¸€ä¸ªç©ºæ ¼ç­‰ï¼‰,é‚£ä¹ˆè¿™ä¸¤ä¸ªsqlå°†ä½¿ç”¨ä¸åŒçš„ä¸€ä¸ªcacheã€‚</p>
<p>ï¼ˆ2ï¼‰åˆ¤æ–­ä¾æ®</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; show status like <span class="string">&quot;%Qcache%&quot;</span>;</span><br><span class="line">+-------------------------+---------+</span><br><span class="line">| Variable_name           | Value   |</span><br><span class="line">+-------------------------+---------+</span><br><span class="line">| Qcache_free_blocks      | 1       |</span><br><span class="line">| Qcache_free_memory      | 1031360 |</span><br><span class="line">| Qcache_hits             | 0       |</span><br><span class="line">| Qcache_inserts          | 0       |</span><br><span class="line">| Qcache_lowmem_prunes    | 0       |</span><br><span class="line">| Qcache_not_cached       | 2002    |</span><br><span class="line">| Qcache_queries_in_cache | 0       |</span><br><span class="line">| Qcache_total_blocks     | 1       |</span><br><span class="line">+-------------------------+---------+</span><br><span class="line">8 rows <span class="keyword">in</span> <span class="built_in">set</span> (0.00 sec)</span><br></pre></td></tr></table></figure>
<p>â€”â€”â€”â€”â€”â€”â€”çŠ¶æ€è¯´æ˜â€”â€”â€”â€”â€”â€”â€“<br><code>Qcache_free_blocksï¼š</code>ç¼“å­˜ä¸­ç›¸é‚»å†…å­˜å—çš„ä¸ªæ•°ã€‚<br>å¦‚æœè¯¥å€¼æ˜¾ç¤ºè¾ƒå¤§ï¼Œåˆ™è¯´æ˜Query Cache ä¸­çš„å†…å­˜ç¢ç‰‡è¾ƒå¤šäº†ï¼ŒFLUSH QUERY CACHEä¼šå¯¹ç¼“å­˜ä¸­çš„ç¢ç‰‡è¿›è¡Œæ•´ç†ï¼Œä»è€Œå¾—åˆ°ä¸€ä¸ªç©ºé—²å—ã€‚<br>æ³¨ï¼šå½“ä¸€ä¸ªè¡¨è¢«æ›´æ–°ä¹‹åï¼Œå’Œå®ƒç›¸å…³çš„cache<br>blockså°†è¢«freeã€‚ä½†æ˜¯è¿™ä¸ªblockä¾ç„¶å¯èƒ½å­˜åœ¨é˜Ÿåˆ—ä¸­ï¼Œé™¤éæ˜¯åœ¨é˜Ÿåˆ—çš„å°¾éƒ¨ã€‚å¯ä»¥ç”¨FLUSH QUERY CACHEè¯­å¥æ¥æ¸…ç©ºfree blocks</p>
<p><code>Qcache_free_memoryï¼š</code>Query Cache ä¸­ç›®å‰å‰©ä½™çš„å†…å­˜å¤§å°ã€‚é€šè¿‡è¿™ä¸ªå‚æ•°æˆ‘ä»¬å¯ä»¥è¾ƒä¸ºå‡†ç¡®çš„è§‚å¯Ÿå‡ºå½“å‰ç³»ç»Ÿä¸­çš„Query Cache å†…å­˜å¤§å°æ˜¯å¦è¶³å¤Ÿï¼Œæ˜¯éœ€è¦å¢åŠ è¿˜æ˜¯è¿‡å¤šäº†ã€‚</p>
<p><code>Qcache_hitsï¼š</code>è¡¨ç¤ºæœ‰å¤šå°‘æ¬¡å‘½ä¸­ç¼“å­˜ã€‚æˆ‘ä»¬ä¸»è¦å¯ä»¥é€šè¿‡è¯¥å€¼æ¥éªŒè¯æˆ‘ä»¬çš„æŸ¥è¯¢ç¼“å­˜çš„æ•ˆæœã€‚æ•°å­—è¶Šå¤§ï¼Œç¼“å­˜æ•ˆæœè¶Šç†æƒ³ã€‚</p>
<p><code>Qcache_insertsï¼š</code>è¡¨ç¤ºå¤šå°‘æ¬¡æœªå‘½ä¸­ç„¶åæ’å…¥ï¼Œæ„æ€æ˜¯æ–°æ¥çš„SQLè¯·æ±‚åœ¨ç¼“å­˜ä¸­æœªæ‰¾åˆ°ï¼Œä¸å¾—ä¸æ‰§è¡ŒæŸ¥è¯¢å¤„ç†ï¼Œæ‰§è¡ŒæŸ¥è¯¢å¤„ç†åæŠŠç»“æœinsertåˆ°æŸ¥è¯¢ç¼“å­˜ä¸­ã€‚è¿™æ ·çš„æƒ…å†µçš„æ¬¡æ•°è¶Šå¤šï¼Œè¡¨ç¤ºæŸ¥è¯¢ç¼“å­˜åº”ç”¨åˆ°çš„æ¯”è¾ƒå°‘ï¼Œæ•ˆæœä¹Ÿå°±ä¸ç†æƒ³ã€‚å½“ç„¶ç³»ç»Ÿåˆšå¯åŠ¨åï¼ŒæŸ¥è¯¢ç¼“å­˜æ˜¯ç©ºçš„ï¼Œè¿™å¾ˆæ­£å¸¸ã€‚</p>
<p><code>Qcache_lowmem_prunesï¼š</code><br>å¤šå°‘æ¡Queryå› ä¸ºå†…å­˜ä¸è¶³è€Œè¢«æ¸…é™¤å‡ºQueryCacheã€‚é€šè¿‡â€œQcache_lowmem_prunesâ€å’Œâ€œQcache_free_memoryâ€ç›¸äº’ç»“åˆï¼Œèƒ½å¤Ÿæ›´æ¸…æ¥šçš„äº†è§£åˆ°æˆ‘ä»¬ç³»ç»Ÿä¸­Query Cache çš„å†…å­˜å¤§å°æ˜¯å¦çœŸçš„è¶³å¤Ÿï¼Œæ˜¯å¦éå¸¸é¢‘ç¹çš„å‡ºç°å› ä¸ºå†…å­˜ä¸è¶³è€Œæœ‰Query è¢«æ¢å‡ºã€‚è¿™ä¸ªæ•°å­—æœ€å¥½é•¿æ—¶é—´æ¥çœ‹ï¼›å¦‚æœè¿™ä¸ªæ•°å­—åœ¨ä¸æ–­å¢é•¿ï¼Œå°±è¡¨ç¤ºå¯èƒ½ç¢ç‰‡éå¸¸ä¸¥é‡ï¼Œæˆ–è€…å†…å­˜å¾ˆå°‘ã€‚ï¼ˆä¸Šé¢çš„free_blockså’Œfree_memoryå¯ä»¥å‘Šè¯‰æ‚¨å±äºå“ªç§æƒ…å†µï¼‰</p>
<p><code>Qcache_not_cachedï¼š</code>ä¸é€‚åˆè¿›è¡Œç¼“å­˜çš„æŸ¥è¯¢çš„æ•°é‡ï¼Œé€šå¸¸æ˜¯ç”±äºè¿™äº›æŸ¥è¯¢ä¸æ˜¯ SELECT è¯­å¥æˆ–è€…ç”¨äº†now()ä¹‹ç±»çš„å‡½æ•°ã€‚</p>
<p><code>Qcache_queries_in_cacheï¼š</code>å½“å‰<code>Query Cache </code>ä¸­<code>cache</code> çš„<code>Query </code>æ•°é‡ï¼›<br>Qcache_total_blocksï¼šå½“å‰Query Cache ä¸­çš„block æ•°é‡ï¼›</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Qcache_hits / (Qcache_inserts+Qcache_not_cached+Qcache_hits) </span><br><span class="line">    90/         10000             0             90</span><br></pre></td></tr></table></figure>
<p>å¦‚æœå‡ºç°hitsæ¯”ä¾‹è¿‡ä½ï¼Œå…¶å®å°±å¯ä»¥å…³é—­æŸ¥è¯¢ç¼“å­˜äº†ã€‚ä½¿ç”¨redisä¸“é—¨ç¼“å­˜æ•°æ®åº“</p>
<p><code>Qcache_free_blocks</code>    æ¥åˆ¤æ–­ç¢ç‰‡<br><code>Qcache_free_memory</code>   +   <code>Qcache_lowmem_prunes </code> æ¥åˆ¤æ–­å†…å­˜å¤Ÿä¸å¤Ÿ<br><code>Qcache_hits</code> å¤šå°‘æ¬¡å‘½ä¸­  <code>Qcache_hits / (Qcache_inserts+Qcache_not_cached+Qcache_hits) </code> </p>
<p>ï¼ˆ3ï¼‰é…ç½®ç¤ºä¾‹</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; show variables like <span class="string">&#x27;%query_cache%&#x27;</span> ;</span><br><span class="line">+------------------------------+---------+</span><br><span class="line">| Variable_name                | Value   |</span><br><span class="line">+------------------------------+---------+</span><br><span class="line">| have_query_cache             | YES     |</span><br><span class="line">| query_cache_limit            | 1048576 |</span><br><span class="line">| query_cache_min_res_unit     | 4096    |</span><br><span class="line">| query_cache_size             | 1048576 |</span><br><span class="line">| query_cache_type             | OFF     |</span><br><span class="line">| query_cache_wlock_invalidate | OFF     |</span><br><span class="line">+------------------------------+---------+</span><br><span class="line">6 rows <span class="keyword">in</span> <span class="built_in">set</span> (0.00 sec)</span><br><span class="line"></span><br><span class="line">mysql&gt; </span><br></pre></td></tr></table></figure>
<p>â€”â€”â€”â€”â€”â€”-é…ç½®è¯´æ˜â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”-<br>ä»¥ä¸Šä¿¡æ¯å¯ä»¥çœ‹å‡º<code>query_cache_type</code>ä¸ºoffè¡¨ç¤ºä¸ç¼“å­˜ä»»ä½•æŸ¥è¯¢</p>
<p>å„å­—æ®µçš„è§£é‡Šï¼š<br><code>query_cache_limitï¼š</code>è¶…è¿‡æ­¤å¤§å°çš„æŸ¥è¯¢å°†ä¸ç¼“å­˜<br><code>query_cache_min_res_unitï¼š</code>ç¼“å­˜å—çš„æœ€å°å¤§å°ï¼Œ<code>query_cache_min_res_unit</code>çš„é…ç½®æ˜¯ä¸€æŸ„â€åŒåˆƒå‰‘â€ï¼Œé»˜è®¤æ˜¯4KBï¼Œè®¾ç½®å€¼å¤§å¯¹å¤§æ•°æ®æŸ¥è¯¢æœ‰å¥½å¤„ï¼Œä½†å¦‚æœä½ çš„æŸ¥è¯¢éƒ½æ˜¯å°æ•°æ®æŸ¥è¯¢ï¼Œå°±å®¹æ˜“é€ æˆå†…å­˜ç¢ç‰‡å’Œæµªè´¹ã€‚<br><code>query_cache_sizeï¼š</code>æŸ¥è¯¢ç¼“å­˜å¤§å° (æ³¨ï¼šQCå­˜å‚¨çš„æœ€å°å•ä½æ˜¯1024byteï¼Œæ‰€ä»¥å¦‚æœä½ è®¾å®šäº†ä¸€ä¸ªä¸æ˜¯1024çš„å€æ•°çš„å€¼ï¼Œè¿™ä¸ªå€¼ä¼šè¢«å››èˆäº”å…¥åˆ°æœ€æ¥è¿‘å½“å‰å€¼çš„ç­‰äº1024çš„å€æ•°çš„å€¼ã€‚)</p>
<p><code>query_cache_typeï¼š</code>ç¼“å­˜ç±»å‹ï¼Œå†³å®šç¼“å­˜ä»€ä¹ˆæ ·çš„æŸ¥è¯¢ï¼Œæ³¨æ„è¿™ä¸ªå€¼ä¸èƒ½éšä¾¿è®¾ç½®ï¼Œå¿…é¡»è®¾ç½®ä¸ºæ•°å­—ï¼Œå¯é€‰é¡¹ç›®ä»¥åŠè¯´æ˜å¦‚ä¸‹ï¼š<br>å¦‚æœè®¾ç½®ä¸º0ï¼Œé‚£ä¹ˆå¯ä»¥è¯´ï¼Œä½ çš„ç¼“å­˜æ ¹æœ¬å°±æ²¡æœ‰ç”¨ï¼Œç›¸å½“äºç¦ç”¨äº†ã€‚<br>å¦‚æœè®¾ç½®ä¸º1ï¼Œå°†ä¼šç¼“å­˜æ‰€æœ‰çš„ç»“æœï¼Œé™¤éä½ çš„selectè¯­å¥ä½¿ç”¨SQL_NO_CACHEç¦ç”¨äº†æŸ¥è¯¢ç¼“å­˜ã€‚<br>å¦‚æœè®¾ç½®ä¸º2ï¼Œåˆ™åªç¼“å­˜åœ¨selectè¯­å¥ä¸­é€šè¿‡SQL_CACHEæŒ‡å®šéœ€è¦ç¼“å­˜çš„æŸ¥è¯¢ã€‚</p>
<p>ä¿®æ”¹/etc/my.cnf,é…ç½®å®Œåçš„éƒ¨åˆ†æ–‡ä»¶å¦‚ä¸‹ï¼š</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">query_cache_size=128M</span><br><span class="line">query_cache_type=1</span><br><span class="line">max_connect_errors ***</span><br></pre></td></tr></table></figure>
<p><code>max_connect_errors</code>æ˜¯ä¸€ä¸ªmysqlä¸­ä¸å®‰å…¨æœ‰å…³çš„è®¡æ•°å™¨å€¼ï¼Œå®ƒè´Ÿè´£é˜»æ­¢è¿‡å¤šå°è¯•å¤±è´¥çš„å®¢æˆ·ç«¯ä»¥é˜²æ­¢æš´åŠ›ç ´è§£å¯†ç ç­‰æƒ…å†µï¼Œå½“è¶…è¿‡æŒ‡å®šæ¬¡æ•°ï¼ŒmysqlæœåŠ¡å™¨å°†ç¦æ­¢hostçš„è¿æ¥è¯·æ±‚ï¼Œç›´åˆ°mysqlæœåŠ¡å™¨é‡å¯æˆ–é€šè¿‡flush hostså‘½ä»¤æ¸…ç©ºæ­¤hostçš„ç›¸å…³ä¿¡æ¯ max_connect_errorsçš„å€¼ä¸æ€§èƒ½å¹¶æ— å¤ªå¤§å…³ç³»ã€‚<br>ä¿®æ”¹<code>/etc/my.cnf</code>æ–‡ä»¶ï¼Œåœ¨[mysqld]ä¸‹é¢æ·»åŠ å¦‚ä¸‹å†…å®¹<br><code>max_connect_errors=2000</code></p>
<hr>
<h3 id="7-6-sort-buffer-size-ä¼šè¯æ’åºç¼“å†²åŒº"><a href="#7-6-sort-buffer-size-ä¼šè¯æ’åºç¼“å†²åŒº" class="headerlink" title="7.6:sort_buffer_size ä¼šè¯æ’åºç¼“å†²åŒº"></a>7.6:sort_buffer_size ä¼šè¯æ’åºç¼“å†²åŒº</h3><p>ï¼ˆ1ï¼‰ç®€ä»‹ï¼š<br>æ¯ä¸ªéœ€è¦è¿›è¡Œæ’åºçš„çº¿ç¨‹åˆ†é…è¯¥å¤§å°çš„ä¸€ä¸ªç¼“å†²åŒºã€‚å¢åŠ è¿™å€¼åŠ é€Ÿ<br>ORDER BY<br>GROUP BY<br>distinct<br>union<br>ï¼ˆ2ï¼‰é…ç½®ä¾æ®<br>Sort_Buffer_Sizeå¹¶ä¸æ˜¯è¶Šå¤§è¶Šå¥½ï¼Œç”±äºæ˜¯connectionçº§çš„å‚æ•°ï¼Œè¿‡å¤§çš„è®¾ç½®+é«˜å¹¶å‘å¯èƒ½ä¼šè€—å°½ç³»ç»Ÿå†…å­˜èµ„æºã€‚<br>åˆ—å¦‚ï¼š500ä¸ªè¿æ¥å°†ä¼šæ¶ˆè€— 500*sort_buffer_sizeï¼ˆ2Mï¼‰=1Gå†…</p>
<p>è®¡ç®—å…¬å¼ï¼š<code>16*1024/1024/8</code></p>
<p>ï¼ˆ3ï¼‰é…ç½®æ–¹æ³•<br> ä¿®æ”¹/etc/my.cnfæ–‡ä»¶ï¼Œåœ¨[mysqld]ä¸‹é¢æ·»åŠ å¦‚ä¸‹ï¼š<br><code>sort_buffer_size=1M</code></p>
<hr>
<h3 id="7-7-max-allowed-packet-æ¥æ”¶æœ€å¤§æ•°æ®åŒ…å¤§å°"><a href="#7-7-max-allowed-packet-æ¥æ”¶æœ€å¤§æ•°æ®åŒ…å¤§å°" class="headerlink" title="7.7:max_allowed_packet æ¥æ”¶æœ€å¤§æ•°æ®åŒ…å¤§å°"></a>7.7:max_allowed_packet æ¥æ”¶æœ€å¤§æ•°æ®åŒ…å¤§å°</h3><p>ï¼ˆ1ï¼‰ç®€ä»‹ï¼š<br>mysqlæ ¹æ®é…ç½®æ–‡ä»¶ä¼šé™åˆ¶ï¼Œserveræ¥å—çš„æ•°æ®åŒ…å¤§å°ã€‚<br>ï¼ˆ2ï¼‰é…ç½®ä¾æ®ï¼š<br>æœ‰æ—¶å€™å¤§çš„æ’å…¥å’Œæ›´æ–°ä¼šå—max_allowed_packetå‚æ•°é™åˆ¶ï¼Œå¯¼è‡´å†™å…¥æˆ–è€…æ›´æ–°å¤±è´¥ï¼Œæ›´å¤§å€¼æ˜¯1GBï¼Œå¿…é¡»è®¾ç½®1024çš„å€æ•°ã€‚åœ¨mysqldumpå¤‡ä»½æ—¶ä¼šç”¨åˆ°<br>ï¼ˆ3ï¼‰é…ç½®æ–¹æ³•ï¼š<br><code>max_allowed_packet=256M</code></p>
<hr>
<h3 id="7-8-join-buffer-size-å…³è”è¡¨ç¼“å­˜å¤§å°"><a href="#7-8-join-buffer-size-å…³è”è¡¨ç¼“å­˜å¤§å°" class="headerlink" title="7.8:join_buffer_size å…³è”è¡¨ç¼“å­˜å¤§å°"></a>7.8:join_buffer_size å…³è”è¡¨ç¼“å­˜å¤§å°</h3><p>select a.name,b.name from   a  join b on a.id=b.id where xxxx</p>
<ul>
<li>æ•°æ®é‡çº§å°çš„è¡¨æ”¾åœ¨å·¦è¾¹ï¼Œé€šè¿‡<code>left join</code>å¼ºåˆ¶æŒ‡å®šé©±åŠ¨è¡¨</li>
</ul>
<p>ä½œç”¨ï¼šç”¨äºè¡¨é—´å…³è”ç¼“å­˜çš„å¤§å°ï¼Œå’Œsort_buffer_sizeä¸€æ ·ï¼Œè¯¥å‚æ•°å¯¹åº”çš„åˆ†é…å†…å­˜ä¹Ÿæ˜¯æ¯ä¸ªè¿æ¥ç‹¬äº«ï¼Œè®¡ç®—å…¬å¼ç±»ä¼¼äº7.6ã€‚<br>å°½é‡åœ¨SQLä¸æ–¹é¢è¿›è¡Œä¼˜åŒ–ï¼Œæ•ˆæœè¾ƒä¸ºæ˜æ˜¾ã€‚<br>ä¼˜åŒ–çš„æ–¹æ³•ï¼šåœ¨onæ¡ä»¶åˆ—åŠ ç´¢å¼•ï¼Œè‡³å°‘åº”å½“æ˜¯æœ‰MULç´¢å¼•</p>
<hr>
<h3 id="7-9-thread-cache-size-é¢„åˆ†é…ä¿ç•™çº¿ç¨‹"><a href="#7-9-thread-cache-size-é¢„åˆ†é…ä¿ç•™çº¿ç¨‹" class="headerlink" title="7.9:thread_cache_size é¢„åˆ†é…ä¿ç•™çº¿ç¨‹"></a>7.9:thread_cache_size é¢„åˆ†é…ä¿ç•™çº¿ç¨‹</h3><p>ï¼ˆ1ï¼‰ç®€ä»‹<br>æœåŠ¡å™¨çº¿ç¨‹ç¼“å­˜ï¼Œè¿™ä¸ªå€¼è¡¨ç¤ºå¯ä»¥é‡æ–°åˆ©ç”¨ä¿å­˜åœ¨ç¼“å­˜ä¸­çº¿ç¨‹çš„æ•°é‡,å½“æ–­å¼€è¿æ¥æ—¶,é‚£ä¹ˆå®¢æˆ·ç«¯çš„çº¿ç¨‹å°†è¢«æ”¾åˆ°ç¼“å­˜ä¸­ä»¥å“åº”ä¸‹ä¸€ä¸ªå®¢æˆ·è€Œä¸æ˜¯é”€æ¯(å‰ææ˜¯ç¼“å­˜æ•°æœªè¾¾ä¸Šé™),å¦‚æœçº¿ç¨‹é‡æ–°è¢«è¯·æ±‚ï¼Œé‚£ä¹ˆè¯·æ±‚å°†ä»ç¼“å­˜ä¸­è¯»å–,å¦‚æœç¼“å­˜ä¸­æ˜¯ç©ºçš„æˆ–è€…æ˜¯æ–°çš„è¯·æ±‚ï¼Œé‚£ä¹ˆè¿™ä¸ªçº¿ç¨‹å°†è¢«é‡æ–°åˆ›å»º,å¦‚æœæœ‰å¾ˆå¤šæ–°çš„çº¿ç¨‹ï¼Œå¢åŠ è¿™ä¸ªå€¼å¯ä»¥æ”¹å–„ç³»ç»Ÿæ€§èƒ½.<br>ï¼ˆ2ï¼‰é…ç½®ä¾æ®</p>
<ul>
<li>é€šè¿‡æ¯”è¾ƒ Connections å’Œ Threads_created çŠ¶æ€çš„å˜é‡ï¼Œå¯ä»¥çœ‹åˆ°è¿™ä¸ªå˜é‡çš„ä½œç”¨ã€‚</li>
<li>è®¾ç½®è§„åˆ™å¦‚ä¸‹ï¼š1GB å†…å­˜é…ç½®ä¸º8ï¼Œ2GBé…ç½®ä¸º16ï¼Œ3GBé…ç½®ä¸º32ï¼Œ4GBæˆ–æ›´é«˜å†…å­˜ï¼Œå¯é…ç½®æ›´å¤§ã€‚</li>
<li>æœåŠ¡å™¨å¤„ç†æ­¤å®¢æˆ·çš„çº¿ç¨‹å°†ä¼šç¼“å­˜èµ·æ¥ä»¥å“åº”ä¸‹ä¸€ä¸ªå®¢æˆ·è€Œä¸æ˜¯é”€æ¯(å‰ææ˜¯ç¼“å­˜æ•°æœªè¾¾ä¸Šé™)</li>
</ul>
<p>è¯•å›¾è¿æ¥åˆ°MySQL(ä¸ç®¡æ˜¯å¦è¿æ¥æˆåŠŸ)çš„è¿æ¥æ•°</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">db03 [(none)]&gt;show variables like <span class="string">&quot;thread_cache_size&quot;</span>;</span><br><span class="line">+-------------------+-------+</span><br><span class="line">| Variable_name     | Value |</span><br><span class="line">+-------------------+-------+</span><br><span class="line">| thread_cache_size | 18    | //å¯é‡ç”¨çº¿ç¨‹æ•°é‡</span><br><span class="line">+-------------------+-------+</span><br><span class="line">1 row <span class="keyword">in</span> <span class="built_in">set</span> (0.01 sec)</span><br><span class="line">db03 [(none)]&gt;show status like <span class="string">&#x27;threads_%&#x27;</span>;</span><br><span class="line">+-------------------+-------+</span><br><span class="line">| Variable_name     | Value |</span><br><span class="line">+-------------------+-------+</span><br><span class="line">| Threads_cached    | 17    | //ç©ºé—²çº¿ç¨‹</span><br><span class="line">| Threads_connected | 1     | //å·²å»ºç«‹è¿æ¥çš„æ•°é‡</span><br><span class="line">| Threads_created   | 1002  | //æ–°åˆ›å»ºçš„çº¿ç¨‹,æ­£å¸¸æƒ…å†µä¸‹ä¸ä¼šæŒç»­ä¸Šå‡</span><br><span class="line">| Threads_running   | 1     |</span><br><span class="line">+-------------------+-------+</span><br><span class="line">4 rows <span class="keyword">in</span> <span class="built_in">set</span> (0.00 sec)</span><br></pre></td></tr></table></figure>
<p><code>Threads_cached </code>:ä»£è¡¨å½“å‰æ­¤æ—¶æ­¤åˆ»çº¿ç¨‹ç¼“å­˜ä¸­æœ‰å¤šå°‘ç©ºé—²çº¿ç¨‹ã€‚<br><code>Threads_connected</code>:ä»£è¡¨å½“å‰å·²å»ºç«‹è¿æ¥çš„æ•°é‡ï¼Œå› ä¸ºä¸€ä¸ªè¿æ¥å°±éœ€è¦ä¸€ä¸ªçº¿ç¨‹ï¼Œæ‰€ä»¥ä¹Ÿå¯ä»¥çœ‹æˆå½“å‰è¢«ä½¿ç”¨çš„çº¿ç¨‹æ•°ã€‚<br><code>Threads_created</code>:ä»£è¡¨ä»æœ€è¿‘ä¸€æ¬¡æœåŠ¡å¯åŠ¨ï¼Œå·²åˆ›å»ºçº¿ç¨‹çš„æ•°é‡ï¼Œå¦‚æœå‘ç°Threads_createdå€¼è¿‡å¤§çš„è¯ï¼Œè¡¨æ˜MySQLæœåŠ¡å™¨ä¸€ç›´åœ¨åˆ›å»ºçº¿ç¨‹ï¼Œè¿™ä¹Ÿæ˜¯æ¯”è¾ƒè€—cpu SYSèµ„æºï¼Œå¯ä»¥é€‚å½“å¢åŠ é…ç½®æ–‡ä»¶ä¸­thread_cache_sizeå€¼ã€‚<br><code>Threads_running</code> :ä»£è¡¨å½“å‰æ¿€æ´»çš„ï¼ˆéç¡çœ çŠ¶æ€ï¼‰çº¿ç¨‹æ•°ã€‚å¹¶ä¸æ˜¯ä»£è¡¨æ­£åœ¨ä½¿ç”¨çš„çº¿ç¨‹æ•°ï¼Œæœ‰æ—¶å€™è¿æ¥å·²å»ºç«‹ï¼Œä½†æ˜¯è¿æ¥å¤„äºsleepçŠ¶æ€ã€‚<br>ï¼ˆ3ï¼‰é…ç½®æ–¹æ³•ï¼š<br><code>thread_cache_size=32</code></p>
<p>æ•´ç†ï¼š<br>Threads_created  ï¼š</p>
<ul>
<li>ä¸€èˆ¬åœ¨æ¶æ„è®¾è®¡é˜¶æ®µï¼Œä¼šè®¾ç½®ä¸€ä¸ªæµ‹è¯•å€¼ï¼Œåšå‹åŠ›æµ‹è¯•ã€‚</li>
<li>ç»“åˆzabbixç›‘æ§ï¼Œçœ‹ä¸€æ®µæ—¶é—´å†…æ­¤çŠ¶æ€çš„å˜åŒ–ã€‚</li>
<li>å¦‚æœåœ¨ä¸€æ®µæ—¶é—´å†…ï¼ŒThreads_createdè¶‹äºå¹³ç¨³ï¼Œè¯´æ˜å¯¹åº”å‚æ•°è®¾å®šæ˜¯OKã€‚</li>
<li>å¦‚æœä¸€ç›´é™¡å³­çš„å¢é•¿ï¼Œæˆ–è€…å‡ºç°å¤§é‡å³°å€¼ï¼Œé‚£ä¹ˆç»§ç»­å¢åŠ æ­¤å€¼çš„å¤§å°ï¼Œåœ¨ç³»ç»Ÿèµ„æºå¤Ÿç”¨çš„æƒ…å†µä¸‹ï¼ˆå†…å­˜ï¼‰</li>
</ul>
<hr>
<h3 id="7-10-innodb-buffer-pool-size-æ•°æ®é¡µç´¢å¼•ç¼“å†²å¤§å°"><a href="#7-10-innodb-buffer-pool-size-æ•°æ®é¡µç´¢å¼•ç¼“å†²å¤§å°" class="headerlink" title="7.10:innodb_buffer_pool_size æ•°æ®é¡µç´¢å¼•ç¼“å†²å¤§å°"></a>7.10:innodb_buffer_pool_size æ•°æ®é¡µç´¢å¼•ç¼“å†²å¤§å°</h3><p>ï¼ˆ1ï¼‰ç®€ä»‹<br>å¯¹äºInnoDBè¡¨æ¥è¯´ï¼Œ<code>innodb_buffer_pool_size</code>çš„ä½œç”¨å°±ç›¸å½“äº<code>key_buffer_size</code>å¯¹äºMyISAMè¡¨çš„ä½œç”¨ä¸€æ ·ã€‚<br>ï¼ˆ2ï¼‰é…ç½®ä¾æ®ï¼š<br>InnoDBä½¿ç”¨è¯¥å‚æ•°æŒ‡å®šå¤§å°çš„å†…å­˜æ¥ç¼“å†²æ•°æ®å’Œç´¢å¼•ã€‚<br>å¯¹äºå•ç‹¬çš„MySQLæ•°æ®åº“æœåŠ¡å™¨ï¼Œæœ€å¤§å¯ä»¥æŠŠè¯¥å€¼è®¾ç½®æˆç‰©ç†å†…å­˜çš„80%,ä¸€èˆ¬æˆ‘ä»¬å»ºè®®ä¸è¦è¶…è¿‡ç‰©ç†å†…å­˜çš„70%ã€‚<br>ï¼ˆ3ï¼‰é…ç½®æ–¹æ³•<br><code>innodb_buffer_pool_size=2048M</code></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">db03 [(none)]&gt;select @@innodb_buffer_pool_size;</span><br><span class="line">+---------------------------+</span><br><span class="line">| @@innodb_buffer_pool_size |</span><br><span class="line">+---------------------------+</span><br><span class="line">|                 134217728 |//é»˜è®¤å¤§å°/å­—èŠ‚</span><br><span class="line">+---------------------------+</span><br><span class="line">db03 [(none)]&gt;show engine innodb status\G</span><br><span class="line">----------------------</span><br><span class="line">BUFFER POOL AND MEMORY</span><br><span class="line">----------------------</span><br><span class="line">Total large memory allocated 137428992 <span class="comment"># åˆ†é…ç»™InnoDBç¼“å­˜æ± çš„å†…å­˜(å­—èŠ‚)æ¢ç®—æˆMB ä¸º128M</span></span><br><span class="line">Dictionary memory allocated 120758 <span class="comment"># åˆ†é…ç»™InnoDBæ•°æ®å­—å…¸çš„å†…å­˜(å­—èŠ‚)</span></span><br><span class="line">Buffer pool size   8191 //æœ€å¤šå¯ç¼“å­˜çš„æ•°æ®é¡µæ•°é‡ 8191x16kb=131056kb=127.984375å…†å­—èŠ‚(mb)</span><br><span class="line">Free buffers       4891 // ç¼“å­˜æ± ç©ºé—²é“¾è¡¨çš„é¡µæ•°ç›® &lt;==è§‚å¯Ÿå‰©ä½™ï¼Œå‰©ä½™10%è€ƒè™‘å¢åŠ buffer_poolå¤§å°</span><br><span class="line">Database pages     3300 // ç¼“å­˜æ± LRUé“¾è¡¨çš„é¡µæ•°ç›®</span><br><span class="line">Old database pages 1238 // ä¿®æ”¹è¿‡çš„é¡µæ•°ç›®</span><br></pre></td></tr></table></figure>

<hr>
<h3 id="7-11-innodb-flush-log-at-trx-commit-æ§åˆ¶redo-buffer-åˆ·å†™ç­–ç•¥"><a href="#7-11-innodb-flush-log-at-trx-commit-æ§åˆ¶redo-buffer-åˆ·å†™ç­–ç•¥" class="headerlink" title="7.11:innodb_flush_log_at_trx_commit æ§åˆ¶redo buffer åˆ·å†™ç­–ç•¥"></a>7.11:innodb_flush_log_at_trx_commit æ§åˆ¶redo buffer åˆ·å†™ç­–ç•¥</h3><p>ï¼ˆ1ï¼‰ç®€ä»‹<br>ä¸»è¦æ§åˆ¶äº†innodbå°†log bufferä¸­çš„æ•°æ®å†™å…¥æ—¥å¿—æ–‡ä»¶å¹¶flushç£ç›˜çš„æ—¶é—´ç‚¹ï¼Œå–å€¼åˆ†åˆ«ä¸º0ã€1ã€2ä¸‰ä¸ªã€‚<br>0ï¼Œè¡¨ç¤ºå½“äº‹åŠ¡æäº¤æ—¶ï¼Œä¸åšæ—¥å¿—å†™å…¥æ“ä½œï¼Œè€Œæ˜¯æ¯ç§’é’Ÿå°†log bufferä¸­çš„æ•°æ®å†™å…¥æ—¥å¿—æ–‡ä»¶å¹¶flushç£ç›˜ä¸€æ¬¡ï¼›<br>1ï¼Œæ¯æ¬¡äº‹åŠ¡çš„æäº¤éƒ½ä¼šå¼•èµ·redoæ—¥å¿—æ–‡ä»¶å†™å…¥ã€flushç£ç›˜çš„æ“ä½œï¼Œç¡®ä¿äº†äº‹åŠ¡çš„ACIDï¼›<br>2ï¼Œæ¯æ¬¡äº‹åŠ¡æäº¤å¼•èµ·å†™å…¥æ—¥å¿—æ–‡ä»¶çš„åŠ¨ä½œ,ä½†æ¯ç§’é’Ÿå®Œæˆä¸€æ¬¡flushç£ç›˜æ“ä½œã€‚</p>
<p>ï¼ˆ2ï¼‰é…ç½®ä¾æ®<br>å®é™…æµ‹è¯•å‘ç°ï¼Œè¯¥å€¼å¯¹æ’å…¥æ•°æ®çš„é€Ÿåº¦å½±å“éå¸¸å¤§ï¼Œè®¾ç½®ä¸º2æ—¶æ’å…¥10000æ¡è®°å½•åªéœ€è¦2ç§’ï¼Œè®¾ç½®ä¸º0æ—¶åªéœ€è¦1ç§’ï¼Œè€Œè®¾ç½®ä¸º1æ—¶åˆ™éœ€è¦229ç§’ã€‚å› æ­¤ï¼ŒMySQLæ‰‹å†Œä¹Ÿå»ºè®®å°½é‡å°†æ’å…¥æ“ä½œåˆå¹¶æˆä¸€ä¸ªäº‹åŠ¡ï¼Œè¿™æ ·å¯ä»¥å¤§å¹…æé«˜é€Ÿåº¦ã€‚<br>æ ¹æ®MySQLå®˜æ–¹æ–‡æ¡£ï¼Œåœ¨å…è®¸ä¸¢å¤±æœ€è¿‘éƒ¨åˆ†äº‹åŠ¡çš„å±é™©çš„å‰æä¸‹ï¼Œå¯ä»¥æŠŠè¯¥å€¼è®¾ä¸º0æˆ–2ã€‚</p>
<p>ï¼ˆ3ï¼‰é…ç½®æ–¹æ³•<br><code>innodb_flush_log_at_trx_commit=1</code>åŒ1æ ‡å‡†ä¸­çš„ä¸€ä¸ª1<br>å‚è§ï¼š<a href="https://cakepanit.com/forward/3053135c.html#8-0-InnoDB%E6%A0%B8%E5%BF%83%E5%8F%82%E6%95%B0">https://cakepanit.com/forward/3053135c.html#8-0-InnoDB%E6%A0%B8%E5%BF%83%E5%8F%82%E6%95%B0</a></p>
<hr>
<h3 id="7-12-innodb-thread-concurrency-å¤šæ ¸å¹¶å‘å¤„ç†æ§åˆ¶"><a href="#7-12-innodb-thread-concurrency-å¤šæ ¸å¹¶å‘å¤„ç†æ§åˆ¶" class="headerlink" title="7.12:innodb_thread_concurrency å¤šæ ¸å¹¶å‘å¤„ç†æ§åˆ¶"></a>7.12:innodb_thread_concurrency å¤šæ ¸å¹¶å‘å¤„ç†æ§åˆ¶</h3><p>ï¼ˆ1ï¼‰ç®€ä»‹<br>æ­¤å‚æ•°ç”¨æ¥è®¾ç½®innodbçº¿ç¨‹çš„å¹¶å‘æ•°é‡ï¼Œé»˜è®¤å€¼ä¸º0è¡¨ç¤ºä¸é™åˆ¶ã€‚</p>
<p>ï¼ˆ2ï¼‰é…ç½®ä¾æ®<br>åœ¨å®˜æ–¹docä¸Šï¼Œå¯¹äº<code>innodb_thread_concurrency</code>çš„ä½¿ç”¨ï¼Œä¹Ÿç»™å‡ºäº†ä¸€äº›å»ºè®®ï¼Œå¦‚ä¸‹ï¼š<br>å¦‚æœä¸€ä¸ªå·¥ä½œè´Ÿè½½ä¸­ï¼Œå¹¶å‘ç”¨æˆ·çº¿ç¨‹çš„æ•°é‡å°äº64ï¼Œå»ºè®®è®¾ç½®<code>innodb_thread_concurrency=0</code>ï¼›<br>å¦‚æœå·¥ä½œè´Ÿè½½ä¸€ç›´è¾ƒä¸ºä¸¥é‡ç”šè‡³å¶å°”è¾¾åˆ°é¡¶å³°ï¼Œå»ºè®®å…ˆè®¾ç½®<code>innodb_thread_concurrency=128</code>ï¼Œ<br>å¹¶é€šè¿‡ä¸æ–­çš„é™ä½è¿™ä¸ªå‚æ•°ï¼Œ96, 80, 64ç­‰ç­‰ï¼Œç›´åˆ°å‘ç°èƒ½å¤Ÿæä¾›æœ€ä½³æ€§èƒ½çš„çº¿ç¨‹æ•°ï¼Œ<br>ä¾‹å¦‚ï¼Œå‡è®¾ç³»ç»Ÿé€šå¸¸æœ‰40åˆ°50ä¸ªç”¨æˆ·ï¼Œä½†å®šæœŸçš„æ•°é‡å¢åŠ è‡³60ï¼Œ70ï¼Œç”šè‡³200ã€‚ä½ ä¼šå‘ç°ï¼Œ<br>æ€§èƒ½åœ¨80ä¸ªå¹¶å‘ç”¨æˆ·è®¾ç½®æ—¶è¡¨ç°ç¨³å®šï¼Œå¦‚æœé«˜äºè¿™ä¸ªæ•°ï¼Œæ€§èƒ½åè€Œä¸‹é™ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œ<br>å»ºè®®è®¾ç½®innodb_thread_concurrencyå‚æ•°ä¸º80ï¼Œä»¥é¿å…å½±å“æ€§èƒ½ã€‚<br>å¦‚æœä½ ä¸å¸Œæœ›InnoDBä½¿ç”¨çš„è™šæ‹ŸCPUæ•°é‡æ¯”ç”¨æˆ·çº¿ç¨‹ä½¿ç”¨çš„è™šæ‹ŸCPUæ›´å¤šï¼ˆæ¯”å¦‚20ä¸ªè™šæ‹ŸCPUï¼‰ï¼Œ<br>å»ºè®®é€šè¿‡è®¾ç½®innodb_thread_concurrency å‚æ•°ä¸ºè¿™ä¸ªå€¼ï¼ˆä¹Ÿå¯èƒ½æ›´ä½ï¼Œè¿™å–å†³äºæ€§èƒ½ä½“ç°ï¼‰ï¼Œ<br>å¦‚æœä½ çš„ç›®æ ‡æ˜¯å°†MySQLä¸å…¶ä»–åº”ç”¨éš”ç¦»ï¼Œä½ å¯ä»¥lè€ƒè™‘ç»‘å®šmysqldè¿›ç¨‹åˆ°ä¸“æœ‰çš„è™šæ‹ŸCPUã€‚<br>ä½†æ˜¯éœ€ è¦æ³¨æ„çš„æ˜¯ï¼Œè¿™ç§ç»‘å®šï¼Œåœ¨myslqdè¿›ç¨‹ä¸€ç›´ä¸æ˜¯å¾ˆå¿™çš„æƒ…å†µä¸‹ï¼Œå¯èƒ½ä¼šå¯¼è‡´éæœ€ä¼˜çš„ç¡¬ä»¶ä½¿ç”¨ç‡ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œ<br>ä½ å¯èƒ½ä¼šè®¾ç½®mysqldè¿›ç¨‹ç»‘å®šçš„è™šæ‹Ÿ CPUï¼Œå…è®¸å…¶ä»–åº”ç”¨ç¨‹åºä½¿ç”¨è™šæ‹ŸCPUçš„ä¸€éƒ¨åˆ†æˆ–å…¨éƒ¨ã€‚<br>åœ¨æŸäº›æƒ…å†µä¸‹ï¼Œæœ€ä½³çš„innodb_thread_concurrencyå‚æ•°è®¾ç½®å¯ä»¥æ¯”è™šæ‹ŸCPUçš„æ•°é‡å°ã€‚<br>å®šæœŸæ£€æµ‹å’Œåˆ†æç³»ç»Ÿï¼Œè´Ÿè½½é‡ã€ç”¨æˆ·æ•°æˆ–è€…å·¥ä½œç¯å¢ƒçš„æ”¹å˜å¯èƒ½éƒ½éœ€è¦å¯¹innodb_thread_concurrencyå‚æ•°çš„è®¾ç½®è¿›è¡Œè°ƒæ•´ã€‚</p>
<p>128   â€”â€“&gt; top  cpu<br>è®¾ç½®æ ‡å‡†ï¼š</p>
<ul>
<li>1ã€å½“å‰ç³»ç»Ÿcpuä½¿ç”¨æƒ…å†µï¼Œå‡ä¸å‡åŒ€<br>top</li>
<li>2ã€å½“å‰çš„è¿æ¥æ•°ï¼Œæœ‰æ²¡æœ‰è¾¾åˆ°é¡¶å³°<br><code>show statusg like &#39;threads_%&#39;;</code><br><code>show processlist;</code><br>ï¼ˆ3ï¼‰é…ç½®æ–¹æ³•ï¼š<br><code>innodb_thread_concurrency=8</code><br>æ–¹æ³•:</li>
</ul>
<ol>
<li>çœ‹top ,è§‚å¯Ÿæ¯ä¸ªcpuçš„å„è‡ªçš„è´Ÿè½½æƒ…å†µ</li>
<li>å‘ç°ä¸å¹³å‡,å…ˆè®¾ç½®å‚æ•°ä¸ºcpuä¸ªæ•°,ç„¶åä¸æ–­å¢åŠ (ä¸€å€)è¿™ä¸ªæ•°å€¼</li>
<li>ä¸€ç›´è§‚å¯ŸtopçŠ¶æ€,ç›´åˆ°è¾¾åˆ°æ¯”è¾ƒå‡åŒ€æ—¶,è¯´æ˜å·²ç»åˆ°ä½äº†</li>
</ol>
<hr>
<h3 id="7-13-innodb-log-buffer-size-redoç¼“å†²åŒºå¤§å°æ§åˆ¶"><a href="#7-13-innodb-log-buffer-size-redoç¼“å†²åŒºå¤§å°æ§åˆ¶" class="headerlink" title="7.13:innodb_log_buffer_size  redoç¼“å†²åŒºå¤§å°æ§åˆ¶"></a>7.13:innodb_log_buffer_size  redoç¼“å†²åŒºå¤§å°æ§åˆ¶</h3><p>æ­¤å‚æ•°ç¡®å®šäº›æ—¥å¿—æ–‡ä»¶æ‰€ç”¨çš„å†…å­˜å¤§å°ï¼Œä»¥Mä¸ºå•ä½ã€‚ç¼“å†²åŒºæ›´å¤§èƒ½æé«˜æ€§èƒ½ï¼Œå¯¹äºè¾ƒå¤§çš„äº‹åŠ¡ï¼Œå¯ä»¥å¢å¤§ç¼“å­˜å¤§å°ã€‚<br><code>innodb_log_buffer_size=128M</code>åˆ°256Mä¹‹é—´<br>è®¾å®šä¾æ®ï¼š<br>1ã€å¤§äº‹åŠ¡ï¼š å­˜å‚¨è¿‡ç¨‹è°ƒç”¨ CALL<br>2ã€å¤šäº‹åŠ¡</p>
<hr>
<h3 id="7-14-innodb-log-file-size-100M-redoæ—¥å¿—ä¸ªæ•°æ§åˆ¶"><a href="#7-14-innodb-log-file-size-100M-redoæ—¥å¿—ä¸ªæ•°æ§åˆ¶" class="headerlink" title="7.14:innodb_log_file_size = 100M redoæ—¥å¿—ä¸ªæ•°æ§åˆ¶"></a>7.14:innodb_log_file_size = 100M redoæ—¥å¿—ä¸ªæ•°æ§åˆ¶</h3><p>è®¾ç½® ib_logfile0  ib_logfile1<br>æ­¤å‚æ•°ç¡®å®šæ•°æ®æ—¥å¿—æ–‡ä»¶çš„å¤§å°ï¼Œä»¥Mä¸ºå•ä½ï¼Œæ›´å¤§çš„è®¾ç½®å¯ä»¥æé«˜æ€§èƒ½.<br>innodb_log_file_size = 100M<br><code>innodb_log_files_in_group = 3</code>åˆ°5ç»„<br>ä¸ºæé«˜æ€§èƒ½ï¼ŒMySQLå¯ä»¥ä»¥å¾ªç¯æ–¹å¼å°†æ—¥å¿—æ–‡ä»¶å†™åˆ°å¤šä¸ªæ–‡ä»¶ã€‚æ¨èè®¾ç½®ä¸º3</p>
<hr>
<h3 id="7-15-read-buffer-size-1M-é¡ºåºæŸ¥è¯¢ç¼“å†²åŒº"><a href="#7-15-read-buffer-size-1M-é¡ºåºæŸ¥è¯¢ç¼“å†²åŒº" class="headerlink" title="7.15:read_buffer_size = 1M é¡ºåºæŸ¥è¯¢ç¼“å†²åŒº"></a>7.15:read_buffer_size = 1M é¡ºåºæŸ¥è¯¢ç¼“å†²åŒº</h3><p>MySqlè¯»å…¥ç¼“å†²åŒºå¤§å°ï¼ˆä¼šè¯çº§åˆ«çš„å‚æ•°ï¼‰ã€‚å¯¹è¡¨è¿›è¡Œé¡ºåºæ‰«æï¼ˆå¦‚èµ°ç´¢å¼•ï¼‰çš„è¯·æ±‚å°†åˆ†é…ä¸€ä¸ªè¯»å…¥ç¼“å†²åŒºï¼ŒMySqlä¼šä¸ºå®ƒåˆ†é…ä¸€æ®µå†…å­˜ç¼“å†²åŒºã€‚å¦‚æœå¯¹è¡¨çš„é¡ºåºæ‰«æè¯·æ±‚éå¸¸é¢‘ç¹ï¼Œå¹¶ä¸”ä½ è®¤ä¸ºé¢‘ç¹æ‰«æè¿›è¡Œå¾—å¤ªæ…¢ï¼Œå¯ä»¥é€šè¿‡å¢åŠ è¯¥å˜é‡å€¼ä»¥åŠå†…å­˜ç¼“å†²åŒºå¤§å°æé«˜å…¶æ€§èƒ½ã€‚å’Œ sort_buffer_sizeä¸€æ ·ï¼Œè¯¥å‚æ•°å¯¹åº”çš„åˆ†é…å†…å­˜ä¹Ÿæ˜¯æ¯ä¸ªè¿æ¥ç‹¬äº«</p>
<hr>
<h3 id="7-16-read-rnd-buffer-size-1M-éšæœºæŸ¥è¯¢ç¼“å†²åŒº"><a href="#7-16-read-rnd-buffer-size-1M-éšæœºæŸ¥è¯¢ç¼“å†²åŒº" class="headerlink" title="7.16:read_rnd_buffer_size = 1M éšæœºæŸ¥è¯¢ç¼“å†²åŒº"></a>7.16:read_rnd_buffer_size = 1M éšæœºæŸ¥è¯¢ç¼“å†²åŒº</h3><p>MySqlçš„éšæœºè¯»ï¼ˆæŸ¥è¯¢æ“ä½œï¼‰ç¼“å†²åŒºå¤§å°ã€‚å½“æŒ‰ä»»æ„é¡ºåºè¯»å–è¡Œæ—¶ï¼ˆä¸èµ°ç´¢å¼•ï¼‰(ä¾‹å¦‚ï¼ŒæŒ‰ç…§æ’åºé¡ºåº)ï¼Œå°†åˆ†é…ä¸€ä¸ªéšæœºè¯»ç¼“å­˜åŒºã€‚è¿›è¡Œæ’åºæŸ¥è¯¢æ—¶ï¼ŒMySqlä¼šé¦–å…ˆæ‰«æä¸€éè¯¥ç¼“å†²ï¼Œä»¥é¿å…ç£ç›˜æœç´¢ï¼Œæé«˜æŸ¥è¯¢é€Ÿåº¦ï¼Œå¦‚æœéœ€è¦æ’åºå¤§é‡æ•°æ®ï¼Œå¯é€‚å½“è°ƒé«˜è¯¥å€¼ã€‚ä½†MySqlä¼šä¸ºæ¯ä¸ªå®¢æˆ·è¿æ¥å‘æ”¾è¯¥ç¼“å†²ç©ºé—´ï¼Œæ‰€ä»¥åº”å°½é‡é€‚å½“è®¾ç½®è¯¥å€¼ï¼Œä»¥é¿å…å†…å­˜å¼€é”€è¿‡å¤§ã€‚<br>æ³¨ï¼šé¡ºåºè¯»æ˜¯æŒ‡æ ¹æ®ç´¢å¼•çš„å¶èŠ‚ç‚¹æ•°æ®å°±èƒ½é¡ºåºåœ°è¯»å–æ‰€éœ€è¦çš„è¡Œæ•°æ®ã€‚éšæœºè¯»æ˜¯æŒ‡ä¸€èˆ¬éœ€è¦æ ¹æ®è¾…åŠ©ç´¢å¼•å¶èŠ‚ç‚¹ä¸­çš„ä¸»é”®å¯»æ‰¾å®é™…è¡Œæ•°æ®ï¼Œè€Œè¾…åŠ©ç´¢å¼•å’Œä¸»é”®æ‰€åœ¨çš„æ•°æ®æ®µä¸åŒï¼Œå› æ­¤è®¿é—®æ–¹å¼æ˜¯éšæœºçš„ã€‚</p>
<hr>
<h3 id="7-17-bulk-insert-buffer-size-8M-æ’å…¥ç¼“å†²åŒºå¤§å°"><a href="#7-17-bulk-insert-buffer-size-8M-æ’å…¥ç¼“å†²åŒºå¤§å°" class="headerlink" title="7.17:bulk_insert_buffer_size = 8M æ’å…¥ç¼“å†²åŒºå¤§å°"></a>7.17:bulk_insert_buffer_size = 8M æ’å…¥ç¼“å†²åŒºå¤§å°</h3><p>æ‰¹é‡æ’å…¥æ•°æ®ç¼“å­˜å¤§å°ï¼Œå¯ä»¥æœ‰æ•ˆæé«˜æ’å…¥æ•ˆç‡ï¼Œé»˜è®¤ä¸º8M</p>
<ul>
<li>tokuDB    percona</li>
<li>myrocks   </li>
<li>RocksDB</li>
<li>TiDB</li>
<li>MongoDB</li>
</ul>
<hr>
<h3 id="7-18-binary-log-binlogç›¸å…³å‚æ•°"><a href="#7-18-binary-log-binlogç›¸å…³å‚æ•°" class="headerlink" title="7.18:binary log binlogç›¸å…³å‚æ•°"></a>7.18:binary log binlogç›¸å…³å‚æ•°</h3><p><code>log-bin=/data/mysql-bin</code><br><code>binlog_cache_size = 2M</code> //ä¸ºæ¯ä¸ªsession åˆ†é…çš„å†…å­˜ï¼Œåœ¨äº‹åŠ¡è¿‡ç¨‹ä¸­ç”¨æ¥å­˜å‚¨äºŒè¿›åˆ¶æ—¥å¿—çš„ç¼“å­˜, æé«˜è®°å½•bin-logçš„æ•ˆç‡ã€‚æ²¡æœ‰ä»€ä¹ˆå¤§äº‹åŠ¡ï¼Œdmlä¹Ÿä¸æ˜¯å¾ˆé¢‘ç¹çš„æƒ…å†µä¸‹å¯ä»¥è®¾ç½®å°ä¸€ç‚¹ï¼Œå¦‚æœäº‹åŠ¡å¤§è€Œä¸”å¤šï¼Œdmlæ“ä½œä¹Ÿé¢‘ç¹ï¼Œåˆ™å¯ä»¥é€‚å½“çš„è°ƒå¤§ä¸€ç‚¹ã€‚å‰è€…å»ºè®®æ˜¯â€“1Mï¼Œåè€…å»ºè®®æ˜¯ï¼šå³ 2â€“4M<br><code>max_binlog_cache_size = 8M</code> //è¡¨ç¤ºçš„æ˜¯binlog èƒ½å¤Ÿä½¿ç”¨çš„æœ€å¤§cache å†…å­˜å¤§å°<br><code>max_binlog_size= 512M </code><br>//æŒ‡å®šbinlogæ—¥å¿—æ–‡ä»¶çš„å¤§å°ï¼Œå¦‚æœå½“å‰çš„æ—¥å¿—å¤§å°è¾¾åˆ°max_binlog_sizeï¼Œè¿˜ä¼šè‡ªåŠ¨åˆ›å»ºæ–°çš„äºŒè¿›åˆ¶æ—¥å¿—ã€‚ä½ ä¸èƒ½å°†è¯¥å˜é‡è®¾ç½®ä¸ºå¤§äº1GBæˆ–å°äº4096å­—èŠ‚ã€‚é»˜è®¤å€¼æ˜¯1GBã€‚åœ¨å¯¼å…¥å¤§å®¹é‡çš„sqlæ–‡ä»¶æ—¶ï¼Œå»ºè®®å…³é—­sql_log_binï¼Œå¦åˆ™ç¡¬ç›˜æ‰›ä¸ä½ï¼Œè€Œä¸”å»ºè®®å®šæœŸåšåˆ é™¤ã€‚</p>
<p><code>expire_logs_days = 7</code> //å®šä¹‰äº†mysqlæ¸…é™¤è¿‡æœŸæ—¥å¿—çš„æ—¶é—´ã€‚<br>äºŒè¿›åˆ¶æ—¥å¿—è‡ªåŠ¨åˆ é™¤çš„å¤©æ•°ã€‚é»˜è®¤å€¼ä¸º0,è¡¨ç¤ºâ€œæ²¡æœ‰è‡ªåŠ¨åˆ é™¤â€ã€‚</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">log-bin=/data/mysql-bin</span><br><span class="line">binlog_format=row </span><br><span class="line">sync_binlog=1</span><br></pre></td></tr></table></figure>
<p>åŒ1æ ‡å‡†(åŸºäºå®‰å…¨çš„æ§åˆ¶)ï¼š</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">sync_binlog=1   ä»€ä¹ˆæ—¶å€™åˆ·æ–°binlogåˆ°ç£ç›˜ï¼Œæ¯æ¬¡äº‹åŠ¡commit</span><br><span class="line">innodb_flush_log_at_trx_commit=1</span><br><span class="line"><span class="built_in">set</span> sql_log_bin=0;</span><br><span class="line">show status like <span class="string">&#x27;com_%&#x27;</span>;</span><br></pre></td></tr></table></figure>

<hr>
<h3 id="7-19-å®‰å…¨å‚æ•°"><a href="#7-19-å®‰å…¨å‚æ•°" class="headerlink" title="7.19:å®‰å…¨å‚æ•°"></a>7.19:å®‰å…¨å‚æ•°</h3><p><code>Innodb_flush_method=(O_DIRECT, fsync) </code><br>1ã€fsyncï¼š<br>ï¼ˆ1ï¼‰åœ¨æ•°æ®é¡µéœ€è¦æŒä¹…åŒ–æ—¶ï¼Œé¦–å…ˆå°†æ•°æ®å†™å…¥OS bufferä¸­ï¼Œç„¶åç”±oså†³å®šä»€ä¹ˆæ—¶å€™å†™å…¥ç£ç›˜<br>ï¼ˆ2ï¼‰åœ¨redo buffueréœ€è¦æŒä¹…åŒ–æ—¶ï¼Œé¦–å…ˆå°†æ•°æ®å†™å…¥OS bufferä¸­ï¼Œç„¶åç”±oså†³å®šä»€ä¹ˆæ—¶å€™å†™å…¥ç£ç›˜<br>ä½†ï¼Œå¦‚æœ<code>innodb_flush_log_at_trx_commit=1</code>çš„è¯ï¼Œæ—¥å¿—è¿˜æ˜¯ç›´æ¥æ¯æ¬¡commitç›´æ¥å†™å…¥ç£ç›˜<br>2ã€ Innodb_flush_method=O_DIRECT<br>ï¼ˆ1ï¼‰åœ¨æ•°æ®é¡µéœ€è¦æŒä¹…åŒ–æ—¶ï¼Œç›´æ¥å†™å…¥ç£ç›˜<br>ï¼ˆ2ï¼‰åœ¨redo buffueréœ€è¦æŒä¹…åŒ–æ—¶ï¼Œé¦–å…ˆå°†æ•°æ®å†™å…¥OS bufferä¸­ï¼Œç„¶åç”±oså†³å®šä»€ä¹ˆæ—¶å€™å†™å…¥ç£ç›˜<br>ä½†ï¼Œå¦‚æœ<code>innodb_flush_log_at_trx_commit=1</code>çš„è¯ï¼Œæ—¥å¿—è¿˜æ˜¯ç›´æ¥æ¯æ¬¡commitç›´æ¥å†™å…¥ç£ç›˜</p>
<p>æœ€å®‰å…¨æ¨¡å¼ï¼š</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">innodb_flush_log_at_trx_commit=1</span><br><span class="line">innodb_flush_method=O_DIRECT</span><br></pre></td></tr></table></figure>
<p>æœ€é«˜æ€§èƒ½æ¨¡å¼ï¼š</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">innodb_flush_log_at_trx_commit=0</span><br><span class="line">innodb_flush_method=fsync</span><br></pre></td></tr></table></figure>
<p>ä¸€èˆ¬æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬æ›´åå‘äºå®‰å…¨ã€‚<br>â€œåŒä¸€æ ‡å‡†â€</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">innodb_flush_log_at_trx_commit=1        ***************</span><br><span class="line">sync_binlog=1                           ***************</span><br><span class="line">innodb_flush_method=O_DIRECT</span><br></pre></td></tr></table></figure>

<hr>
<h2 id="8-å‚æ•°ä¼˜åŒ–ç»“æœ"><a href="#8-å‚æ•°ä¼˜åŒ–ç»“æœ" class="headerlink" title="8. å‚æ•°ä¼˜åŒ–ç»“æœ"></a>8. å‚æ•°ä¼˜åŒ–ç»“æœ</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line">[mysqld]</span><br><span class="line">basedir=/data/mysql</span><br><span class="line">datadir=/data/mysql/data</span><br><span class="line">socket=/tmp/mysql.sock</span><br><span class="line">log-error=/var/log/mysql.log</span><br><span class="line">log_bin=/data/binlog/mysql-bin</span><br><span class="line">binlog_format=row</span><br><span class="line">skip-name-resolve</span><br><span class="line">server-id=52</span><br><span class="line">gtid-mode=on</span><br><span class="line">enforce-gtid-consistency=<span class="literal">true</span></span><br><span class="line">log-slave-updates=1</span><br><span class="line">relay_log_purge=0</span><br><span class="line"></span><br><span class="line">max_connections=1024</span><br><span class="line">back_log=128</span><br><span class="line">wait_timeout=60</span><br><span class="line">interactive_timeout=7200</span><br><span class="line">key_buffer_size=16M</span><br><span class="line">query_cache_size=64M</span><br><span class="line">query_cache_type=1</span><br><span class="line">query_cache_limit=50M</span><br><span class="line">max_connect_errors=20</span><br><span class="line">sort_buffer_size=2M</span><br><span class="line">max_allowed_packet=32M</span><br><span class="line">join_buffer_size=2M</span><br><span class="line">thread_cache_size=200</span><br><span class="line">innodb_buffer_pool_size=1024M</span><br><span class="line">innodb_flush_log_at_trx_commit=1</span><br><span class="line">innodb_log_buffer_size=32M</span><br><span class="line">innodb_log_file_size=128M</span><br><span class="line">innodb_log_files_in_group=3</span><br><span class="line">binlog_cache_size=2M</span><br><span class="line">max_binlog_cache_size=8M</span><br><span class="line">max_binlog_size=512M</span><br><span class="line">expire_logs_days=7</span><br><span class="line">read_buffer_size=2M</span><br><span class="line">read_rnd_buffer_size=2M</span><br><span class="line">bulk_insert_buffer_size=8M</span><br><span class="line">[client]</span><br><span class="line">socket=/tmp/mysql.sock</span><br></pre></td></tr></table></figure>

<h3 id="8-1æµ‹è¯•ï¼š"><a href="#8-1æµ‹è¯•ï¼š" class="headerlink" title="8.1æµ‹è¯•ï¼š"></a>8.1æµ‹è¯•ï¼š</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line">ä¼˜åŒ–å‰ï¼š</span><br><span class="line">[root@db03 ~]<span class="comment"># mysqlslap --defaults-file=/etc/my.cnf --socket /tmp/mysql.sock --concurrency=100 --iterations=1 --create-schema=&#x27;oldboy&#x27; --query=&quot;select * from oldboy.t100w where k2=&#x27;GHvw&#x27;&quot; engine=innodb --number-of-queries=2000 -verbose</span></span><br><span class="line">Benchmark</span><br><span class="line">        Running <span class="keyword">for</span> engine rbose</span><br><span class="line">        Average number of seconds to run all queries: 184.616 seconds</span><br><span class="line">        Minimum number of seconds to run all queries: 184.616 seconds</span><br><span class="line">        Maximum number of seconds to run all queries: 184.616 seconds</span><br><span class="line">        Number of clients running queries: 100</span><br><span class="line">        Average number of queries per client: 20</span><br><span class="line">//184ç§’</span><br><span class="line"></span><br><span class="line">ä¼˜åŒ–åï¼š</span><br><span class="line">[root@db03 ~]<span class="comment"># mysqlslap --defaults-file=/etc/my.cnf --socket /tmp/mysql.sock --concurrency=100 --iterations=1 --create-schema=&#x27;oldboy&#x27; --query=&quot;select * from oldboy.t100w where k2=&#x27;GHvw&#x27;&quot; engine=innodb --number-of-queries=2000 -verbose</span></span><br><span class="line">Benchmark</span><br><span class="line">        Running <span class="keyword">for</span> engine rbose</span><br><span class="line">        Average number of seconds to run all queries: 9.411 seconds</span><br><span class="line">        Minimum number of seconds to run all queries: 9.411 seconds</span><br><span class="line">        Maximum number of seconds to run all queries: 9.411 seconds</span><br><span class="line">        Number of clients running queries: 100</span><br><span class="line">        Average number of queries per client: 20</span><br><span class="line">//9ç§’</span><br><span class="line"></span><br><span class="line">å»ºç«‹ç´¢å¼•åï¼š</span><br><span class="line">db03 [(none)]&gt;alter table oldboy.t100w add index idx_k2(k2);</span><br><span class="line">Query OK, 0 rows affected (1.66 sec)</span><br><span class="line"></span><br><span class="line">å†æ¬¡æµ‹è¯•ï¼š</span><br><span class="line">[root@db03 ~]<span class="comment"># mysqlslap --defaults-file=/etc/my.cnf --socket /tmp/mysql.sock --concurrency=100 --iterations=1 --create-schema=&#x27;oldboy&#x27; --query=&quot;select * from oldboy.t100w where k2=&#x27;GHvw&#x27;&quot; engine=innodb --number-of-queries=2000 -verbose</span></span><br><span class="line">Benchmark</span><br><span class="line">        Running <span class="keyword">for</span> engine rbose</span><br><span class="line">        Average number of seconds to run all queries: 0.083 seconds</span><br><span class="line">        Minimum number of seconds to run all queries: 0.083 seconds</span><br><span class="line">        Maximum number of seconds to run all queries: 0.083 seconds</span><br><span class="line">        Number of clients running queries: 100</span><br><span class="line">        Average number of queries per client: 20</span><br><span class="line">//0.083ç§’</span><br></pre></td></tr></table></figure>

<h2 id="9-é”çš„ç›‘æ§åŠå¤„ç†"><a href="#9-é”çš„ç›‘æ§åŠå¤„ç†" class="headerlink" title="9.é”çš„ç›‘æ§åŠå¤„ç†"></a>9.é”çš„ç›‘æ§åŠå¤„ç†</h2><h3 id="9-1-é”ç­‰å¾…æ¨¡æ‹Ÿ"><a href="#9-1-é”ç­‰å¾…æ¨¡æ‹Ÿ" class="headerlink" title="9.1 é”ç­‰å¾…æ¨¡æ‹Ÿ"></a>9.1 é”ç­‰å¾…æ¨¡æ‹Ÿ</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">vim /etc/my.cnf</span><br><span class="line">innodb_lock_wait_timeout=28800</span><br><span class="line"></span><br><span class="line">tx1:</span><br><span class="line">USE oldboy</span><br><span class="line">UPDATE t_100w SET k1=<span class="string">&#x27;av&#x27;</span> WHERE <span class="built_in">id</span>=10;</span><br><span class="line"><span class="comment">## tx2:</span></span><br><span class="line">USE oldboy </span><br><span class="line">UPDATE  t_100w SET k1=<span class="string">&#x27;az&#x27;</span> WHERE <span class="built_in">id</span>=10;</span><br></pre></td></tr></table></figure>

<p><img src="/images/img-99.png" alt="é”ç­‰å¾…"></p>
<h3 id="1-çœ‹æœ‰æ²¡æœ‰é”ç­‰å¾…"><a href="#1-çœ‹æœ‰æ²¡æœ‰é”ç­‰å¾…" class="headerlink" title="1. çœ‹æœ‰æ²¡æœ‰é”ç­‰å¾…"></a>1. çœ‹æœ‰æ²¡æœ‰é”ç­‰å¾…</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">SHOW  STATUS LIKE <span class="string">&#x27;innodb_row_lock%&#x27;</span>;</span><br><span class="line">+-------------------------------+-------+</span><br><span class="line">| Variable_name                 | Value |</span><br><span class="line">+-------------------------------+-------+</span><br><span class="line">| Innodb_row_lock_current_waits | 1     | //å½“å‰å¤šå°‘ä¸ªé”ç­‰å¾…</span><br><span class="line">| Innodb_row_lock_time          | 0     |</span><br><span class="line">| Innodb_row_lock_time_avg      | 0     |</span><br><span class="line">| Innodb_row_lock_time_max      | 0     |</span><br><span class="line">| Innodb_row_lock_waits         | 1     | //å†å²</span><br><span class="line">+-------------------------------+-------+</span><br><span class="line">5 rows <span class="keyword">in</span> <span class="built_in">set</span> (0.00 sec)</span><br></pre></td></tr></table></figure>
<h3 id="2-æŸ¥çœ‹å“ªä¸ªäº‹åŠ¡åœ¨ç­‰å¾…-è¢«é˜»å¡äº†"><a href="#2-æŸ¥çœ‹å“ªä¸ªäº‹åŠ¡åœ¨ç­‰å¾…-è¢«é˜»å¡äº†" class="headerlink" title="2. æŸ¥çœ‹å“ªä¸ªäº‹åŠ¡åœ¨ç­‰å¾…(è¢«é˜»å¡äº†)"></a>2. æŸ¥çœ‹å“ªä¸ªäº‹åŠ¡åœ¨ç­‰å¾…(è¢«é˜»å¡äº†)</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">USE information_schema</span><br><span class="line">SELECT * FROM information_schema.INNODB_TRX WHERE trx_state=<span class="string">&#x27;LOCK WAIT&#x27;</span>;</span><br><span class="line">trx_query: update  t100w <span class="built_in">set</span> k1=<span class="string">&#x27;az&#x27;</span> WHERE <span class="built_in">id</span>=10: è¢«é˜»å¡çš„è¯­å¥æ˜¯è° </span><br><span class="line">                          trx_mysql_thread_id: 5: è¢«é˜»å¡çš„ä¼šè¯ID</span><br></pre></td></tr></table></figure>
<h3 id="3-æŸ¥çœ‹é”æº-è°é”çš„æˆ‘"><a href="#3-æŸ¥çœ‹é”æº-è°é”çš„æˆ‘" class="headerlink" title="3.æŸ¥çœ‹é”æº,è°é”çš„æˆ‘!"></a>3.æŸ¥çœ‹é”æº,è°é”çš„æˆ‘!</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">SELECT * FROM sys.innodb_lock_waits;     <span class="comment">## ====&gt;è¢«é”çš„å’Œé”å®šå®ƒçš„ä¹‹é—´å…³ç³»</span></span><br><span class="line"><span class="comment">##                 waiting_pid: 5 ç­‰å¾…çš„ä¼šè¯çº¿ç¨‹å·</span></span><br><span class="line"><span class="comment">##               waiting_query: update  t100w set k1=&#x27;az&#x27; WHERE id=10 ç­‰å¾…çš„è¯­å¥ </span></span><br><span class="line"><span class="comment">##                blocking_pid: 4 é”æºçš„çº¿ç¨‹å·</span></span><br><span class="line"><span class="comment">##     sql_kill_blocking_query: KILL QUERY 4 å¤„ç†å»ºè®®</span></span><br><span class="line"><span class="comment">##sql_kill_blocking_connection: KILL 4å¤„ç†å»ºè®®</span></span><br></pre></td></tr></table></figure>
<h3 id="4-æ‰¾åˆ°é”æºçš„thread-id"><a href="#4-æ‰¾åˆ°é”æºçš„thread-id" class="headerlink" title="4. æ‰¾åˆ°é”æºçš„thread_id"></a>4. æ‰¾åˆ°é”æºçš„thread_id</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">SELECT * FROM performance_schema.threads WHERE processlist_id=4\G;</span><br><span class="line"><span class="comment">## THREAD_ID: 29</span></span><br></pre></td></tr></table></figure>
<h3 id="5-æ‰¾åˆ°é”æºçš„SQLè¯­å¥"><a href="#5-æ‰¾åˆ°é”æºçš„SQLè¯­å¥" class="headerlink" title="5. æ‰¾åˆ°é”æºçš„SQLè¯­å¥"></a>5. æ‰¾åˆ°é”æºçš„SQLè¯­å¥</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">-- å½“å‰åœ¨æ‰§è¡Œçš„è¯­å¥</span><br><span class="line">SELECT * FROM performance_schema.`events_statements_current` WHERE thread_id=29;</span><br><span class="line">SQL_TEXT: UPDATE t100w SET k1=<span class="string">&#x27;av&#x27;</span> WHERE <span class="built_in">id</span>=10</span><br><span class="line">-- æ‰§è¡Œè¯­å¥çš„å†å²</span><br><span class="line">SELECT * FROM performance_schema.`events_statements_history` WHERE thread_id=29;</span><br></pre></td></tr></table></figure>

<h2 id="10-ä¸»ä»ä¼˜åŒ–ï¼š"><a href="#10-ä¸»ä»ä¼˜åŒ–ï¼š" class="headerlink" title="10.ä¸»ä»ä¼˜åŒ–ï¼š"></a>10.ä¸»ä»ä¼˜åŒ–ï¼š</h2><h3 id="10-1-5-7-ä»åº“å¤šçº¿ç¨‹MTS"><a href="#10-1-5-7-ä»åº“å¤šçº¿ç¨‹MTS" class="headerlink" title="10.1 5.7 ä»åº“å¤šçº¿ç¨‹MTS"></a>10.1 5.7 ä»åº“å¤šçº¿ç¨‹MTS</h3><p>é—®é¢˜ï¼š<a href="https://cakepanit.com/forward/2c1ca365.html#6-%E4%B8%BB%E4%BB%8E%E5%BB%B6%E6%97%B6-%E5%8E%9F%E5%9B%A0%E5%88%86%E6%9E%90">ä¸»ä»å»¶æ—¶</a><br>åŸºæœ¬è¦æ±‚:</p>
<ul>
<li>5.7ä»¥ä¸Šçš„ç‰ˆæœ¬(å¿˜è®°å°ç‰ˆæœ¬)ï¼Œå¿…é¡»å¼€å¯GTID </li>
<li>binlogå¿…é¡»æ˜¯rowæ¨¡å¼  <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">gtid_mode=ON</span><br><span class="line">enforce_gtid_consistency=ON</span><br><span class="line">log_slave_updates=ON</span><br><span class="line">slave-parallel-type=LOGICAL_CLOCK</span><br><span class="line">slave-parallel-workers=16 //å¹¶å‘sqlçº¿ç¨‹æ•°é‡</span><br><span class="line">master_info_repository=TABLE //master_info å·²è¡¨çš„å½¢å¼å­˜æ”¾</span><br><span class="line">relay_log_info_repository=TABLE /relay_info å·²è¡¨çš„å½¢å¼å­˜æ”¾</span><br><span class="line">relay_log_recovery=ON</span><br></pre></td></tr></table></figure>
<h3 id="5-7"><a href="#5-7" class="headerlink" title="5.7:"></a>5.7:</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">slave-parallel-type=LOGICAL_CLOCK</span><br><span class="line">slave-parallel-workers=8</span><br><span class="line">cpuæ ¸å¿ƒæ•°ä½œä¸ºæ ‡å‡†</span><br></pre></td></tr></table></figure>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">CHANGE MASTER TO</span><br><span class="line">  MASTER_HOST=<span class="string">&#x27;10.0.0.128&#x27;</span>,</span><br><span class="line">  MASTER_USER=<span class="string">&#x27;repl&#x27;</span>,</span><br><span class="line">  MASTER_PASSWORD=<span class="string">&#x27;123&#x27;</span>,</span><br><span class="line">  MASTER_PORT=3307,</span><br><span class="line">  MASTER_AUTO_POSITION=1;</span><br><span class="line">start slave;</span><br></pre></td></tr></table></figure></li>
</ul>
</article><div class="post-copyright"><div class="post-copyright__title"><span class="post-copyright-info">MySQLç»ˆç« -ç³»åˆ—ä¼˜åŒ–</span></div><div class="post-copyright__url"><span class="post-copyright-info"><a id="post-url" href="https://cakepanit.com/forward/14a32ee2.html">https://cakepanit.com/forward/14a32ee2.html</a><a id="post-url-copy" title="å¤åˆ¶æ–‡ç« é“¾æ¥" onclick="btf.copyFn(&quot;https://cakepanit.com/forward/14a32ee2.html&quot;)"><i class="fas fa-paste copy-button"></i></a></span></div><div class="post-copyright__cc"><span class="post-copyright-info">è½¬è½½å‰è¯·é˜…è¯»æœ¬ç«™ <a href="/protocol/copyright/" title="æœ¬ç«™æ‰€æœ‰åŸåˆ›æ–‡ç« é‡‡ç”¨çŸ¥è¯†å…±äº«(Creative Commons)ç½²åâ€”éå•†ä¸šæ€§ä½¿ç”¨â€”ç›¸åŒæ–¹å¼å…±äº«4.0å›½é™…å…¬å…±è®¸å¯åè®®">ç‰ˆæƒåè®®</a>ï¼Œæ–‡ç« è‘—ä½œæƒå½’ <a href="https://cakepanit.com">é¥¼é“›</a> æ‰€æœ‰ï¼Œè½¬è½½è¯·æ³¨æ˜å‡ºå¤„ã€‚</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/MySQL/">ğŸŒ²MySQL</a><a class="post-meta__tags" href="/tags/%E6%95%B0%E6%8D%AE%E5%BA%93%E4%BC%98%E5%8C%96/">æ•°æ®åº“ä¼˜åŒ–</a></div><div class="post_share"><div class="social-share" data-image="/images/img-71.png" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/js/social-share.min.js" defer></script></div></div><div class="post-reward"><div class="reward-button"><i class="fas fa-qrcode"></i> æ‰“èµ</div><div class="reward-main"><ul class="reward-all"><li class="reward-item"><a href="/img/DC9cYFtFic5G6JZgktjajza5fVfRJLaXLS.png" target="_blank"><img class="post-qr-code-img" src="/img/DC9cYFtFic5G6JZgktjajza5fVfRJLaXLS.png" alt="ç‹—ç‹—å¸(DogeCoin)"/></a><div class="post-qr-code-desc">ç‹—ç‹—å¸(DogeCoin)</div></li><li class="reward-item"><a href="/img/bc1q63xj5a3xgfulv8guate5qxmh6qh8ws7c3casqm.png" target="_blank"><img class="post-qr-code-img" src="/img/bc1q63xj5a3xgfulv8guate5qxmh6qh8ws7c3casqm.png" alt="æ¯”ç‰¹å¸(BitCoin)"/></a><div class="post-qr-code-desc">æ¯”ç‰¹å¸(BitCoin)</div></li></ul></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/forward/fb94f251.html" title="Redis-5.0.5ä»‹ç»ä¸C7ä¸‹çš„ç¼–è¯‘å®‰è£…"><img class="cover" src="/images/img-100.png" onerror="onerror=null;src='/img/404.jpg'" alt="cover of previous post"><div class="pagination-info"><div class="label">ä¸Šä¸€ç¯‡</div><div class="prev_info">Redis-5.0.5ä»‹ç»ä¸C7ä¸‹çš„ç¼–è¯‘å®‰è£…</div><div class="content">0 Redis æ˜¯ä»€ä¹ˆ
Redis æ˜¯ä¸€ç§åŸºäºé”®å€¼å¯¹çš„ NoSQL æ•°æ®åº“,ä¸å¾ˆå¤šé”®å€¼å¯¹æ•°æ®åº“ä¸åŒ,redis ä¸­çš„å€¼å¯ä»¥æœ‰string,hash,list,set,zset,geo ç­‰å¤šç§æ•°æ®ç»“æ„å’Œç®—æ³•ç»„æˆ.

Redis ä¼šå°†æ‰€æœ‰çš„æ•°æ®éƒ½æ”¾åœ¨å†…å­˜ä¸­,æ‰€ä»¥ä»–çš„è¯»å†™æ€§èƒ½éå¸¸æƒŠäºº.Redis è¿˜å¯ä»¥å°†å†…å­˜ä¸­çš„æ•°æ®åˆ©ç”¨å¿«ç…§å’Œæ—¥å¿—çš„å½¢å¼ä¿å­˜åˆ°ç¡¬ç›˜ä¸Š

Redis æä¾›äº†é”®è¿‡æœŸ,å‘å¸ƒè®¢é˜…,äº‹åŠ¡,æµæ°´çº¿ç­‰é™„åŠ åŠŸèƒ½.


0.2 Redis é‡è¦ç‰¹æ€§
1.é€Ÿåº¦å¿«
Redis æ‰€æœ‰çš„æ•°æ®éƒ½å­˜æ”¾åœ¨å†…å­˜ä¸­
Redis ä½¿ç”¨ C è¯­è¨€å®ç°
Redis ä½¿ç”¨å•çº¿ç¨‹æ¶æ„


2.åŸºäºé”®å€¼å¯¹çš„æ•°æ®ç»“æ„æœåŠ¡å™¨
5 ä¸­æ•°æ®ç»“æ„:å­—ç¬¦ä¸²,å“ˆå¸Œ,åˆ—è¡¨,é›†åˆ,æœ‰åºé›†åˆ


3.ä¸°å¯Œçš„åŠŸèƒ½
æä¾›äº†é”®è¿‡æœŸåŠŸèƒ½,å¯ä»¥å®ç°ç¼“å­˜
æä¾›äº†å‘å¸ƒè®¢é˜…åŠŸèƒ½,å¯ä»¥å®ç°æ¶ˆæ¯ç³»ç»Ÿ
æä¾›äº† pipeline åŠŸèƒ½,å®¢æˆ·ç«¯å¯ä»¥å°†ä¸€æ‰¹å‘½ä»¤ä¸€æ¬¡æ€§ä¼ åˆ° Redis,å‡å°‘äº†ç½‘ç»œå¼€é”€


4.ç®€å•ç¨³å®š
æºç å¾ˆå°‘,3.0 ç‰ˆæœ¬ä»¥å 5 ä¸‡è¡Œå·¦å³.
ä½¿ç”¨å•çº¿ç¨‹æ¨¡å‹æ³•,æ˜¯çš„ Redis æœåŠ¡ç«¯å¤„ç†æ¨¡å‹å˜å¾—ç®€å•.
ä¸ä¾èµ–æ“ä½œç³»ç»Ÿçš„ä¸­çš„ç±»åº“


5.å®¢æˆ·ç«¯è¯­è¨€å¤š
ja ...</div></div></a></div><div class="next-post pull-right"><a href="/forward/c3e55136.html" title="MySQL-MyCATå¤šä¸»å¤šä»ç¯å¢ƒä¸‹å®ç°è¡¨çš„æ°´å¹³æ‹†åˆ†"><img class="cover" src="/images/img-71.png" onerror="onerror=null;src='/img/404.jpg'" alt="cover of next post"><div class="pagination-info"><div class="label">ä¸‹ä¸€ç¯‡</div><div class="next_info">MySQL-MyCATå¤šä¸»å¤šä»ç¯å¢ƒä¸‹å®ç°è¡¨çš„æ°´å¹³æ‹†åˆ†</div><div class="content">0.æ°´å¹³æ‹†åˆ†ç®—æ³•èŒƒå›´åˆ†ç‰‡ï¼šæ•°æ®è¿›è¡ŒèŒƒå›´åˆ†å‰²ï¼Œåˆ†å¸ƒåˆ°ä¸åŒçš„èŠ‚ç‚¹ä¸Šå–æ¨¡åˆ†ç‰‡ï¼šé€šè¿‡å°†æ•°æ®è¡Œçš„idå€¼å’ŒèŠ‚ç‚¹æ•°é‡è¿›è¡Œå–æ¨¡å¾—åˆ°çš„ä½™æ•°=èŠ‚ç‚¹ç¼–å·ï¼ˆä»0å¼€å§‹ï¼‰ï¼Œä»è€Œå®ç°å°†æ•°æ®è¡Œå¹³å‡åˆ†å¸ƒåˆ°å„ä¸ªèŠ‚ç‚¹æšä¸¾åˆ†ç‰‡ï¼šæ•°æ®é€šè¿‡çœå¸‚ç­‰ç­‰èŒƒå›´è¿›è¡Œæšä¸¾åˆ†ç‰‡ã€‚ä¸åŒåœ°åŒºæˆ–è€…ä¸åŒæ¡ä»¶çš„æ•°æ®å½’ç±»åˆ°ä¸€ä¸ªèŠ‚ç‚¹æ—¶é—´åˆ†ç‰‡ï¼šå¯¹æ•°æ®æŒ‰ç…§æ—¶é—´è¿›è¡Œå½’çº³ï¼Œåˆ†å¸ƒåˆ°ä¸åŒçš„èŠ‚ç‚¹ä¸Š
1.èŒƒå›´åˆ†ç‰‡ï¼š1.1é€‚ç”¨æƒ…å†µ
(1)è¡Œæ•°éå¸¸å¤šï¼Œ2000wï¼ˆ1-1000w:sh1   1000w01-2000w:sh2ï¼‰
(2)è®¿é—®éå¸¸é¢‘ç¹ï¼Œç”¨æˆ·è®¿é—®è¾ƒç¦»æ•£

123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566//å®šä¹‰å“ªå¼ è¡¨è¦è¢«åˆ†ç‰‡[root@db02 /application/mycat/conf]# cat &gt;schema.xml &lt;&lt;&#x27;EOF&#x27;&lt;?xml version=&quot;1.0&quot;?&gt;&lt;!DOCTY ...</div></div></a></div></nav><div class="relatedPosts"><div class="headline"><i class="fas fa-thumbs-up fa-fw"></i><span>ç›¸å…³æ¨è</span></div><div class="relatedPosts-list"><div><a href="/forward/3053135c.html" title="MySQL-InnoDBå­˜å‚¨å¼•æ“&amp;ä¼˜åŒ–"><img class="cover" src="/images/img-71.png" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2020-04-11</div><div class="title">MySQL-InnoDBå­˜å‚¨å¼•æ“&amp;ä¼˜åŒ–</div><div class="info">å­˜å‚¨å¼•æ“ç›®æ ‡ï¼šç†Ÿæ‚‰InnoDBæ ¸å¿ƒåŸç†ï¼šACID MVCC,äº‹åŠ¡,é”ç­‰

1. ä»‹ç»ç±»ä¼¼äºLinuxç³»ç»Ÿä¸­æ–‡ä»¶ç³»ç»Ÿ

2. åŠŸèƒ½
æ•°æ®è¯»å†™
æ•°æ®å®‰å…¨å’Œä¸€è‡´æ€§
æé«˜æ€§èƒ½
çƒ­å¤‡ä»½
è‡ªåŠ¨æ•…éšœæ¢å¤
é«˜å¯ç”¨æ–¹é¢æ”¯æŒ ç­‰.


3. ç§ç±»3.1 Oracleçš„MySQLçš„å¼•æ“
InnoDB
MyISAM
CSV
MEMORY
ARCHIVE

1234mysql&gt; show engines;   //æŸ¥çœ‹æ”¯æŒçš„å­˜å‚¨å¼•æ“ mysql&gt; select table_schema,table_name ,engine   //æŸ¥çœ‹æ‰€æœ‰InnoDBçš„è¡¨from information_schema.tables where engine=&#x27;innodb&#x27;;

è¯´æ˜ï¼šå­˜å‚¨å¼•æ“æ˜¯ä½œç”¨åœ¨è¡¨ä¸Šçš„ï¼Œä¹Ÿå°±æ„å‘³ç€ï¼Œä¸åŒçš„è¡¨å¯ä»¥æœ‰ä¸åŒçš„å­˜å‚¨å¼•æ“ç±»å‹ã€‚

3.2 å…¶ä»–MySQLçš„å¼•æ“
PerconaDB:é»˜è®¤æ˜¯XtraDB
MariaDB:é»˜è®¤æ˜¯InnoDB

å…¶ä»–çš„å­˜å‚¨å¼•æ“æ”¯æŒ:
TokuDB    
RocksDB
MyRocks

ä»¥ä¸Šä¸‰ç§å­˜å‚¨å¼•æ“çš„å…±åŒç‚¹:å‹ç¼©æ¯”è¾ƒé«˜,æ•°æ®æ’å…¥æ€§èƒ½æé«˜ç° ...</div></div></a></div><div><a href="/forward/74c8159a.html" title="MySQL-MHA+Atlas+VIP+Binlog serverå®ç°MySQLçš„é«˜å¯ç”¨å’Œè¯»å†™åˆ†ç¦»"><img class="cover" src="/images/img-71.png" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2020-04-30</div><div class="title">MySQL-MHA+Atlas+VIP+Binlog serverå®ç°MySQLçš„é«˜å¯ç”¨å’Œè¯»å†™åˆ†ç¦»</div><div class="info">0.è¯´æ˜MHA&amp;VIP&amp;é‚®ä»¶å‘Šè­¦æ„å»ºå‚è§ï¼šhttps://cakepanit.com/forward/c919a25c.htmlbinlogserverï¼šå®æ—¶æŠ“å–ä¸»åº“çš„binlogæ—¥å¿—ï¼Œé˜²æ­¢æé™æƒ…å†µä¸‹çš„ä¸»åº“å®•æœºï¼Œè€Œä»åº“æ¥ç®¡æ—¶å‡ºç°æ•°æ®ä¸å…¨çš„æƒ…å†µAtlasï¼šé…åˆMHAçš„vipé«˜å¯ç”¨ï¼Œå®ç°ä¸»ä»å¤åˆ¶çš„è¯»å†™åˆ†ç¦»ç›¸å…³æ“ä½œ
1.binlogserveré…ç½®ï¼š1.2ä¿®æ”¹é…ç½®æ–‡ä»¶æ‰¾ä¸€å°é¢å¤–çš„æœºå™¨ï¼Œå¿…é¡»è¦æœ‰5.6ä»¥ä¸Šçš„ç‰ˆæœ¬ï¼Œæ”¯æŒgtidå¹¶å¼€å¯ï¼Œæˆ‘ä»¬ç›´æ¥ç”¨çš„ç¬¬äºŒä¸ªslaveï¼ˆdb03ï¼‰
12345vim /etc/mha/app1.cnf [binlog1]no_master=1 //è¡¨ç¤ºæ­¤èŠ‚ç‚¹ä¸å‚ä¸ä¸»ä»é€‰ä¸¾hostname=192.168.56.4master_binlog_dir=/data/mysql/binlog //ç”¨äºä¿å­˜ä¸»åº“Pullè¿‡æ¥çš„äºŒè¿›åˆ¶çš„æœ¬åœ°è·¯å¾„
1.3åˆ›å»ºå¿…è¦ç›®å½•12mkdir -p /data/mysql/binlogchown -R mysql.mysql /data/*
ä¿®æ”¹å®Œæˆåï¼Œå°†ä¸»åº“binlogæ‹‰è¿‡æ¥ï¼ˆä»000001å¼€å§‹æ‹‰ï¼Œä¹‹åçš„binlogä¼šè‡ªåŠ¨æŒ‰é¡ºåºè¿‡ ...</div></div></a></div><div><a href="/forward/557ea64b.html" title="MySQL-MyCATå¤šä¸»å¤šä»ç¯å¢ƒä¸‹å®ç°è¡¨çš„å‚ç›´æ‹†åˆ†"><img class="cover" src="/images/img-71.png" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2020-05-05</div><div class="title">MySQL-MyCATå¤šä¸»å¤šä»ç¯å¢ƒä¸‹å®ç°è¡¨çš„å‚ç›´æ‹†åˆ†</div><div class="info">0.åŒä¸»ç¯å¢ƒæ­å»ºå‚è§ï¼šhttps://cakepanit.com/forward/d3c702fe.html
1.å‚ç›´æ‹†åˆ†ï¼š
2.mycatå‚ç›´åˆ†è¡¨2.1é…ç½®æ–‡ä»¶1234567891011121314151617181920212223242526272829303132[root@db02 ~]# cd /application/mycat/conf/[root@db02 /application/mycat/conf]# mv schema.xml schema.xml.ha[root@db02 /application/mycat/conf]# cat &gt;schema.xml &lt;&lt;&#x27;EOF&#x27;&lt;?xml version=&quot;1.0&quot;?&gt;&lt;!DOCTYPE mycat:schema SYSTEM &quot;schema.dtd&quot;&gt;&lt;mycat:schema xmlns:mycat=&quot;http://io.mycat/&quot;&gt;&lt;schema name=&quot; ...</div></div></a></div><div><a href="/forward/bbb9c58b.html" title="MySQL-MHAç¯å¢ƒå‡†å¤‡_æ­å»º_æ•…éšœæ¢å¤"><img class="cover" src="/images/img-71.png" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2020-04-28</div><div class="title">MySQL-MHAç¯å¢ƒå‡†å¤‡_æ­å»º_æ•…éšœæ¢å¤</div><div class="info">0.éœ€è¦ç”¨åˆ°çš„è½¯ä»¶åŒ…ï¼›
Atlas-2.2.1.el6.x86_64.rpm
mha4mysql-manager-0.56-0.el6.noarch.rpm
mha4mysql-node-0.56-0.el6.noarch.rpm

1.åˆ†åˆ«ä¸Šä¼ åˆ°ä¸‰ä¸ªä¸»ä»èŠ‚ç‚¹ä¸ŠåŸºäºGTIDçš„1ä¸»2ä»æ„å»ºè¿‡ç¨‹å‚è§ï¼šhttps://cakepanit.com/forward/c3e1b71a.html
1.1 é…ç½®å…³é”®ç¨‹åºè½¯è¿æ¥123ln -s /application/mysql/bin/mysqlbinlog    /usr/bin/mysqlbinlogln -s /application/mysql/bin/mysql          /usr/bin/mysql#MHA æ— æ³•è°ƒç”¨ç¯å¢ƒå˜é‡

1.2 å„ä¸ªèŠ‚ç‚¹é…ç½®äº’ä¿¡12345678#db01rm -rf /root/.ssh ssh-keygen  //ç”Ÿæˆå¯†é’¥å¯¹cd /root/.ssh/mv id_rsa.pub authorized_keysscp  -r  /root/.ssh  192.168.56.3:/rootscp  -r  / ...</div></div></a></div><div><a href="/forward/c919a25c.html" title="MySQL-MHAçš„VIPé«˜å¯ç”¨_é‚®ä»¶å‘Šè­¦"><img class="cover" src="/images/img-71.png" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2020-04-29</div><div class="title">MySQL-MHAçš„VIPé«˜å¯ç”¨_é‚®ä»¶å‘Šè­¦</div><div class="info">1.MHA çš„vipåŠŸèƒ½1.1MHAå¼€å¯vipçš„ä½œç”¨
ç”¨äºæ”¯æŒåº”ç”¨é€æ˜ï¼Œæ˜¯æ„å»ºä¸»ä»é«˜å¯ç”¨å¿…é¡»å¼€å¯çš„åŠŸèƒ½
æ„å»ºä¸»ä»é«˜å¯ç”¨å‚è§ï¼šhttps://cakepanit.com/forward/c70898d5.html

1.2MHAçš„vipåŠŸèƒ½1.2.1å‚æ•°:master_ip_failover_script=/usr/local/bin/master_ip_failoveræ³¨æ„ï¼š/usr/local/bin/master_ip_failoverï¼Œå¿…é¡»äº‹å…ˆå‡†å¤‡å¥½
1.2.2ç¼–å†™perlè„šæœ¬12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364656667686970717273747576777879808182838485vim /usr/local/bin/master_ip_failover#!/usr/bin/env perluse strict;use warnings FATAL =&gt; &#x ...</div></div></a></div><div><a href="/forward/49de8711.html" title="MySQL-é”"><img class="cover" src="/images/img-71.png" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2020-04-11</div><div class="title">MySQL-é”</div><div class="info">1.é”1.1ä»€ä¹ˆæ˜¯â€œé”â€ï¼Ÿ
â€œé”â€é¡¾åæ€ä¹‰å°±æ˜¯é”å®šçš„æ„æ€ã€‚
â€œé”â€çš„ä½œç”¨æ˜¯ä»€ä¹ˆï¼Ÿ
åœ¨äº‹åŠ¡ACIDè¿‡ç¨‹ä¸­ï¼Œâ€œé”â€å’Œâ€œéš”ç¦»çº§åˆ«â€ä¸€èµ·æ¥å®ç°â€œIâ€éš”ç¦»æ€§çš„ä½œç”¨ã€‚
é¿å…äº‰æŠ¢èµ„æº

é”çš„ç²’åº¦ï¼š

1ã€MyIasmï¼šä½å¹¶å‘é”â€”â€”è¡¨çº§é”
2ã€Innodbï¼šé«˜å¹¶å‘é”â€”â€”è¡Œçº§é”

1.2InnoDBé”çº§åˆ«
è¡Œçº§é”
Next lockä¸‹é”®é”
GAP lock é—´éš™é”
æ‚²è§‚é”:æ’ä»–æ€§ï¼Œä¸èƒ½ä¸èƒ½åŒæ—¶ä¿®æ”¹åŒä¸€è¡Œæ•°æ®
ä¹è§‚é”
è¡Œçº§é”ï¼Œè°å…ˆæ“ä½œæŸä¸ªæ•°æ®è¡Œï¼Œå°±ä¼šæŒæœ‰&lt;è¿™è¡Œ&gt;çš„é”

1.3æ‰©å±•å†…å®¹
Next lockä¸‹é”®é”
GAP Locké—´éš™é”

1.4ä¸ºä½•å‡ºç°é”ç­‰å¾…/æ­»é”ç­‰æƒ…å†µï¼šäº¤å‰çš„äº‹åŠ¡å‡ºç°ï¼Œå¯¼è‡´çš„1.é”ç­‰å¾…äº‹åŠ¡1ï¼šçŠ¶æ€æœªæäº¤äº‹åŠ¡2ï¼šä¸€åŒæ›´æ–°åŒä¸€è¡Œæ•°æ®ï¼Œä¼šå‡ºç°é”ç­‰å¾…
æ­»é”ï¼šäº‹åŠ¡äº¤å‰ï¼Œäº’ç›¸ä¾èµ–é€ æˆæ­»é”
1.5å››ç§éš”ç¦»çº§åˆ«12345678910111213141516READ UNCOMMITTED        ã€€ã€€å…è®¸äº‹åŠ¡æŸ¥çœ‹å…¶ä»–äº‹åŠ¡æ‰€è¿›è¡Œçš„æœªæäº¤æ›´æ”¹READ COMMITTED   å…è®¸äº‹åŠ¡æŸ¥çœ‹å…¶ä»–äº‹åŠ¡æ‰€è¿›è¡Œçš„å·²æäº¤æ›´æ”¹//å±è”½è„è¯»ï¼Œä¼šå‡ºç°ä¸å¯é‡å¤è¯»ã€‚å’Œå¹»è¯»ç°è±¡REPEATABLE READ**** ...</div></div></a></div></div></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="is-center"><div class="avatar-img"><img src="/img/avatar.jpg" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info__name">é¥¼é“›</div><div class="author-info__description">å¯»æ‰¾å±äºè‡ªå·±çš„å½©è™¹æµ·</div></div><div class="card-info-data site-data is-center"><a href="/archives/"><div class="headline">æ–‡ç« </div><div class="length-num">93</div></a><a href="/tags/"><div class="headline">æ ‡ç­¾</div><div class="length-num">72</div></a><a href="/categories/"><div class="headline">åˆ†ç±»</div><div class="length-num">3</div></a></div><div class="card-info-social-icons is-center"><a class="social-icon" href="https://t.me/joinchat/c_ParmoHMmU5MDM9" target="_blank" title="Telegram"><i class="fab fa-telegram-plane"></i></a><a class="social-icon" href="https://qm.qq.com/cgi-bin/qm/qr?k=Q1N9l3isk8O_i5awFwO-blAoPH7PUeb4&amp;noverify=0" target="_blank" title="QQ"><i class="fab fa-qq"></i></a><a class="social-icon" href="mailto:admin@cakepanit.com" target="_blank" title="Email"><i class="fas fa-envelope"></i></a><a class="social-icon" href="https://music.163.com/#/user/home?id=313775282" target="_blank" title="Netease"><i class="fas fa-record-vinyl"></i></a></div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>æ–‡ç« ç›®å½•</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#0-%E7%8E%AF%E5%A2%83%E5%87%86%E5%A4%87%EF%BC%9A"><span class="toc-number">1.</span> <span class="toc-text">0.ç¯å¢ƒå‡†å¤‡ï¼š</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#1-%E4%BC%98%E5%8C%96%E8%8C%83%E5%9B%B4%EF%BC%9A"><span class="toc-number">2.</span> <span class="toc-text">1.ä¼˜åŒ–èŒƒå›´ï¼š</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E5%B1%82%E9%9D%A2%E4%BC%98%E5%8C%96%E5%B7%A5%E5%85%B7%E4%BB%8B%E7%BB%8D"><span class="toc-number">3.</span> <span class="toc-text">2.æ“ä½œç³»ç»Ÿå±‚é¢ä¼˜åŒ–å·¥å…·ä»‹ç»</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#2-1top"><span class="toc-number">3.1.</span> <span class="toc-text">2.1top</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-2iostat"><span class="toc-number">3.2.</span> <span class="toc-text">2.2iostat</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-3%E7%BB%BC%E5%90%88%E5%88%A4%E6%96%AD"><span class="toc-number">3.3.</span> <span class="toc-text">2.3ç»¼åˆåˆ¤æ–­</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-4vmstat"><span class="toc-number">3.4.</span> <span class="toc-text">2.4vmstat</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#3-%E6%95%B0%E6%8D%AE%E5%BA%93%E4%BC%98%E5%8C%96%E5%B7%A5%E5%85%B7%E4%BB%8B%E7%BB%8D"><span class="toc-number">4.</span> <span class="toc-text">3.æ•°æ®åº“ä¼˜åŒ–å·¥å…·ä»‹ç»</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#4-%E4%BC%98%E5%8C%96%E6%80%9D%E8%B7%AF%E5%88%86%E8%A7%A3"><span class="toc-number">5.</span> <span class="toc-text">4.ä¼˜åŒ–æ€è·¯åˆ†è§£</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#4-1-%E7%A1%AC%E4%BB%B6%E4%BC%98%E5%8C%96"><span class="toc-number">5.1.</span> <span class="toc-text">4.1 ç¡¬ä»¶ä¼˜åŒ–</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#4-1-1%E4%B8%BB%E6%9C%BA"><span class="toc-number">5.1.1.</span> <span class="toc-text">4.1.1ä¸»æœº</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#4-1-2%E5%86%85%E5%AD%98"><span class="toc-number">5.1.2.</span> <span class="toc-text">4.1.2å†…å­˜</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#4-1-3%E7%A3%81%E7%9B%98%E9%80%89%E6%8B%A9"><span class="toc-number">5.1.3.</span> <span class="toc-text">4.1.3ç£ç›˜é€‰æ‹©</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#4-1-4%E5%AD%98%E5%82%A8"><span class="toc-number">5.1.4.</span> <span class="toc-text">4.1.4å­˜å‚¨</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#4-1-5%E7%BD%91%E7%BB%9C"><span class="toc-number">5.1.5.</span> <span class="toc-text">4.1.5ç½‘ç»œ</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#5-%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E4%BC%98%E5%8C%96"><span class="toc-number">6.</span> <span class="toc-text">5.æ“ä½œç³»ç»Ÿä¼˜åŒ–</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#5-1Swap%E8%B0%83%E6%95%B4"><span class="toc-number">6.1.</span> <span class="toc-text">5.1Swapè°ƒæ•´</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#6-%E5%BA%94%E7%94%A8%E7%AB%AF"><span class="toc-number">7.</span> <span class="toc-text">6.åº”ç”¨ç«¯</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#7-%E5%8F%82%E6%95%B0%E4%BC%98%E5%8C%96"><span class="toc-number">8.</span> <span class="toc-text">7.å‚æ•°ä¼˜åŒ–</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#7-1-max-connections-%E6%9C%80%E5%A4%A7%E8%BF%9E%E6%8E%A5%E6%95%B0"><span class="toc-number">8.1.</span> <span class="toc-text">7.1:max_connections æœ€å¤§è¿æ¥æ•°</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#7-2-back-log-%E9%A2%84%E5%A4%87%E8%BF%9E%E6%8E%A5%E6%95%B0"><span class="toc-number">8.2.</span> <span class="toc-text">7.2:back_log é¢„å¤‡è¿æ¥æ•°</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#7-3-wait-timeout%E5%92%8Cinteractive-timeout-%E4%BC%9A%E8%AF%9D%E8%B6%85%E6%97%B6"><span class="toc-number">8.3.</span> <span class="toc-text">7.3:wait_timeoutå’Œinteractive_timeout  ä¼šè¯è¶…æ—¶</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#7-4-key-buffer-size-%E4%B8%B4%E6%97%B6%E8%A1%A8%E7%9B%B8%E5%85%B3"><span class="toc-number">8.4.</span> <span class="toc-text">7.4:key_buffer_size ä¸´æ—¶è¡¨ç›¸å…³</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#7-5-query-cache-size-%E6%9F%A5%E8%AF%A2%E7%BC%93%E5%AD%98"><span class="toc-number">8.5.</span> <span class="toc-text">7.5:query_cache_size æŸ¥è¯¢ç¼“å­˜</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#7-6-sort-buffer-size-%E4%BC%9A%E8%AF%9D%E6%8E%92%E5%BA%8F%E7%BC%93%E5%86%B2%E5%8C%BA"><span class="toc-number">8.6.</span> <span class="toc-text">7.6:sort_buffer_size ä¼šè¯æ’åºç¼“å†²åŒº</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#7-7-max-allowed-packet-%E6%8E%A5%E6%94%B6%E6%9C%80%E5%A4%A7%E6%95%B0%E6%8D%AE%E5%8C%85%E5%A4%A7%E5%B0%8F"><span class="toc-number">8.7.</span> <span class="toc-text">7.7:max_allowed_packet æ¥æ”¶æœ€å¤§æ•°æ®åŒ…å¤§å°</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#7-8-join-buffer-size-%E5%85%B3%E8%81%94%E8%A1%A8%E7%BC%93%E5%AD%98%E5%A4%A7%E5%B0%8F"><span class="toc-number">8.8.</span> <span class="toc-text">7.8:join_buffer_size å…³è”è¡¨ç¼“å­˜å¤§å°</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#7-9-thread-cache-size-%E9%A2%84%E5%88%86%E9%85%8D%E4%BF%9D%E7%95%99%E7%BA%BF%E7%A8%8B"><span class="toc-number">8.9.</span> <span class="toc-text">7.9:thread_cache_size é¢„åˆ†é…ä¿ç•™çº¿ç¨‹</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#7-10-innodb-buffer-pool-size-%E6%95%B0%E6%8D%AE%E9%A1%B5%E7%B4%A2%E5%BC%95%E7%BC%93%E5%86%B2%E5%A4%A7%E5%B0%8F"><span class="toc-number">8.10.</span> <span class="toc-text">7.10:innodb_buffer_pool_size æ•°æ®é¡µç´¢å¼•ç¼“å†²å¤§å°</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#7-11-innodb-flush-log-at-trx-commit-%E6%8E%A7%E5%88%B6redo-buffer-%E5%88%B7%E5%86%99%E7%AD%96%E7%95%A5"><span class="toc-number">8.11.</span> <span class="toc-text">7.11:innodb_flush_log_at_trx_commit æ§åˆ¶redo buffer åˆ·å†™ç­–ç•¥</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#7-12-innodb-thread-concurrency-%E5%A4%9A%E6%A0%B8%E5%B9%B6%E5%8F%91%E5%A4%84%E7%90%86%E6%8E%A7%E5%88%B6"><span class="toc-number">8.12.</span> <span class="toc-text">7.12:innodb_thread_concurrency å¤šæ ¸å¹¶å‘å¤„ç†æ§åˆ¶</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#7-13-innodb-log-buffer-size-redo%E7%BC%93%E5%86%B2%E5%8C%BA%E5%A4%A7%E5%B0%8F%E6%8E%A7%E5%88%B6"><span class="toc-number">8.13.</span> <span class="toc-text">7.13:innodb_log_buffer_size  redoç¼“å†²åŒºå¤§å°æ§åˆ¶</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#7-14-innodb-log-file-size-100M-redo%E6%97%A5%E5%BF%97%E4%B8%AA%E6%95%B0%E6%8E%A7%E5%88%B6"><span class="toc-number">8.14.</span> <span class="toc-text">7.14:innodb_log_file_size &#x3D; 100M redoæ—¥å¿—ä¸ªæ•°æ§åˆ¶</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#7-15-read-buffer-size-1M-%E9%A1%BA%E5%BA%8F%E6%9F%A5%E8%AF%A2%E7%BC%93%E5%86%B2%E5%8C%BA"><span class="toc-number">8.15.</span> <span class="toc-text">7.15:read_buffer_size &#x3D; 1M é¡ºåºæŸ¥è¯¢ç¼“å†²åŒº</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#7-16-read-rnd-buffer-size-1M-%E9%9A%8F%E6%9C%BA%E6%9F%A5%E8%AF%A2%E7%BC%93%E5%86%B2%E5%8C%BA"><span class="toc-number">8.16.</span> <span class="toc-text">7.16:read_rnd_buffer_size &#x3D; 1M éšæœºæŸ¥è¯¢ç¼“å†²åŒº</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#7-17-bulk-insert-buffer-size-8M-%E6%8F%92%E5%85%A5%E7%BC%93%E5%86%B2%E5%8C%BA%E5%A4%A7%E5%B0%8F"><span class="toc-number">8.17.</span> <span class="toc-text">7.17:bulk_insert_buffer_size &#x3D; 8M æ’å…¥ç¼“å†²åŒºå¤§å°</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#7-18-binary-log-binlog%E7%9B%B8%E5%85%B3%E5%8F%82%E6%95%B0"><span class="toc-number">8.18.</span> <span class="toc-text">7.18:binary log binlogç›¸å…³å‚æ•°</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#7-19-%E5%AE%89%E5%85%A8%E5%8F%82%E6%95%B0"><span class="toc-number">8.19.</span> <span class="toc-text">7.19:å®‰å…¨å‚æ•°</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#8-%E5%8F%82%E6%95%B0%E4%BC%98%E5%8C%96%E7%BB%93%E6%9E%9C"><span class="toc-number">9.</span> <span class="toc-text">8. å‚æ•°ä¼˜åŒ–ç»“æœ</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#8-1%E6%B5%8B%E8%AF%95%EF%BC%9A"><span class="toc-number">9.1.</span> <span class="toc-text">8.1æµ‹è¯•ï¼š</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#9-%E9%94%81%E7%9A%84%E7%9B%91%E6%8E%A7%E5%8F%8A%E5%A4%84%E7%90%86"><span class="toc-number">10.</span> <span class="toc-text">9.é”çš„ç›‘æ§åŠå¤„ç†</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#9-1-%E9%94%81%E7%AD%89%E5%BE%85%E6%A8%A1%E6%8B%9F"><span class="toc-number">10.1.</span> <span class="toc-text">9.1 é”ç­‰å¾…æ¨¡æ‹Ÿ</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1-%E7%9C%8B%E6%9C%89%E6%B2%A1%E6%9C%89%E9%94%81%E7%AD%89%E5%BE%85"><span class="toc-number">10.2.</span> <span class="toc-text">1. çœ‹æœ‰æ²¡æœ‰é”ç­‰å¾…</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-%E6%9F%A5%E7%9C%8B%E5%93%AA%E4%B8%AA%E4%BA%8B%E5%8A%A1%E5%9C%A8%E7%AD%89%E5%BE%85-%E8%A2%AB%E9%98%BB%E5%A1%9E%E4%BA%86"><span class="toc-number">10.3.</span> <span class="toc-text">2. æŸ¥çœ‹å“ªä¸ªäº‹åŠ¡åœ¨ç­‰å¾…(è¢«é˜»å¡äº†)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-%E6%9F%A5%E7%9C%8B%E9%94%81%E6%BA%90-%E8%B0%81%E9%94%81%E7%9A%84%E6%88%91"><span class="toc-number">10.4.</span> <span class="toc-text">3.æŸ¥çœ‹é”æº,è°é”çš„æˆ‘!</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-%E6%89%BE%E5%88%B0%E9%94%81%E6%BA%90%E7%9A%84thread-id"><span class="toc-number">10.5.</span> <span class="toc-text">4. æ‰¾åˆ°é”æºçš„thread_id</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5-%E6%89%BE%E5%88%B0%E9%94%81%E6%BA%90%E7%9A%84SQL%E8%AF%AD%E5%8F%A5"><span class="toc-number">10.6.</span> <span class="toc-text">5. æ‰¾åˆ°é”æºçš„SQLè¯­å¥</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#10-%E4%B8%BB%E4%BB%8E%E4%BC%98%E5%8C%96%EF%BC%9A"><span class="toc-number">11.</span> <span class="toc-text">10.ä¸»ä»ä¼˜åŒ–ï¼š</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#10-1-5-7-%E4%BB%8E%E5%BA%93%E5%A4%9A%E7%BA%BF%E7%A8%8BMTS"><span class="toc-number">11.1.</span> <span class="toc-text">10.1 5.7 ä»åº“å¤šçº¿ç¨‹MTS</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5-7"><span class="toc-number">11.2.</span> <span class="toc-text">5.7:</span></a></li></ol></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>æœ€æ–°æ–‡ç« </span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/forward/d4ac701.html" title="å„å…¬ç‰ˆç³»ç»Ÿä¿®æ”¹é”å®šDNS"><img src="/images/pasted-288.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="å„å…¬ç‰ˆç³»ç»Ÿä¿®æ”¹é”å®šDNS"/></a><div class="content"><a class="title" href="/forward/d4ac701.html" title="å„å…¬ç‰ˆç³»ç»Ÿä¿®æ”¹é”å®šDNS">å„å…¬ç‰ˆç³»ç»Ÿä¿®æ”¹é”å®šDNS</a><time datetime="2022-11-12T03:06:00.000Z" title="å‘è¡¨äº 2022-11-12 11:06:00">2022-11-12</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/forward/1e56645c.html" title="Kongä½¿ç”¨OAuth2.0 Plugin"><img src="/images/pasted-280.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Kongä½¿ç”¨OAuth2.0 Plugin"/></a><div class="content"><a class="title" href="/forward/1e56645c.html" title="Kongä½¿ç”¨OAuth2.0 Plugin">Kongä½¿ç”¨OAuth2.0 Plugin</a><time datetime="2022-09-03T10:10:00.000Z" title="å‘è¡¨äº 2022-09-03 18:10:00">2022-09-03</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/forward/3df8560c.html" title="Terraform-åŸºç¡€è®¾æ–½å³ä»£ç "><img src="/images/pasted-185.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Terraform-åŸºç¡€è®¾æ–½å³ä»£ç "/></a><div class="content"><a class="title" href="/forward/3df8560c.html" title="Terraform-åŸºç¡€è®¾æ–½å³ä»£ç ">Terraform-åŸºç¡€è®¾æ–½å³ä»£ç </a><time datetime="2022-07-12T14:29:00.000Z" title="å‘è¡¨äº 2022-07-12 22:29:00">2022-07-12</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/forward/91db5a91.html" title="Apollo In Kubernetesï¼ˆå¤šæ•°æ®ä¸­å¿ƒï¼‰"><img src="/images/pasted-173.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Apollo In Kubernetesï¼ˆå¤šæ•°æ®ä¸­å¿ƒï¼‰"/></a><div class="content"><a class="title" href="/forward/91db5a91.html" title="Apollo In Kubernetesï¼ˆå¤šæ•°æ®ä¸­å¿ƒï¼‰">Apollo In Kubernetesï¼ˆå¤šæ•°æ®ä¸­å¿ƒï¼‰</a><time datetime="2022-04-04T00:00:00.000Z" title="å‘è¡¨äº 2022-04-04 08:00:00">2022-04-04</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/forward/48a90e5c.html" title="gRPCç¨‹åºå¥åº·æ£€æŸ¥&amp;Kuberneteséƒ¨ç½²&amp;è´Ÿè½½å‡è¡¡"><img src="/images/pasted-167.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="gRPCç¨‹åºå¥åº·æ£€æŸ¥&amp;Kuberneteséƒ¨ç½²&amp;è´Ÿè½½å‡è¡¡"/></a><div class="content"><a class="title" href="/forward/48a90e5c.html" title="gRPCç¨‹åºå¥åº·æ£€æŸ¥&amp;Kuberneteséƒ¨ç½²&amp;è´Ÿè½½å‡è¡¡">gRPCç¨‹åºå¥åº·æ£€æŸ¥&amp;Kuberneteséƒ¨ç½²&amp;è´Ÿè½½å‡è¡¡</a><time datetime="2022-01-11T05:59:00.000Z" title="å‘è¡¨äº 2022-01-11 13:59:00">2022-01-11</time></div></div></div></div></div></div></main><footer id="footer"><div id="footer-wrap"><div id="footer-group-container"><div class="footer-group"><span class="footer-group-title">å¤–é“¾</span><a class="footer-group-item" target="_blank" rel="noopener" href="https://www.bilibili.com/">bilibili å¼¹å¹•ç½‘</a><a class="footer-group-item" target="_blank" rel="noopener" href="https://www.tiobe.com/tiobe-index/">ç¼–ç¨‹è¯­è¨€æ’å</a><a class="footer-group-item" target="_blank" rel="noopener" href="https://www.submarinecablemap.com/">æµ·åº•å…‰ç¼†åˆ†å¸ƒ</a><a class="footer-group-item" target="_blank" rel="noopener" href="https://cybermap.kaspersky.com/cn">ç½‘ç»œå¨èƒåœ°å›¾</a></div><div class="footer-group"><span class="footer-group-title">å¯¼èˆª</span><a class="footer-group-item" href="/link/">å‹æƒ…é“¾æ¥</a><a class="footer-group-item" href="/tags/">å…¨éƒ¨æ ‡ç­¾</a><a class="footer-group-item" href="/charts/">æ–‡ç« ç»Ÿè®¡</a><a class="footer-group-item" href="/bookshelf/">æ”¶è—ä¹¦å•</a></div><div class="footer-group"><span class="footer-group-title">åˆ†ç±»</span><a class="footer-group-item" href="/categories/OPS/">è¿ç»´æ•™ç¨‹</a><a class="footer-group-item" href="/categories/DBA/">DBAæ•™ç¨‹</a><a class="footer-group-item" href="/categories/Golang/">ç¼–ç æ•™ç¨‹</a><a class="footer-group-item" href="/gallery/">æ”¶è—å›¾åº“</a></div><div class="footer-group"><span class="footer-group-title">å…³äº</span><a class="footer-group-item" href="/notice/">ç½‘ç«™å…¬å‘Š</a><a class="footer-group-item" href="/about/">å…³äºæœ¬ç«™</a><a class="footer-group-item" href="/status">ç«™ç‚¹ç›‘æ§</a><a class="footer-group-item" href="mailto:admin@cakepanit.com">è”ç³»åšä¸»</a></div><div class="footer-group" id="footer-group-flink"><span class="footer-group-title">å‹é“¾<i class="fas fa-arrow-rotate-right" title="éšæœºå‹é“¾" onclick="eurkon.footerRandomFlink(flinks, 3);"></i></span><a class="footer-group-item" href="" target="_blank" rel="noopener external nofollow noreferrer">åŠ è½½ä¸­...</a><a class="footer-group-item" href="" target="_blank" rel="noopener external nofollow noreferrer">åŠ è½½ä¸­...</a><a class="footer-group-item" href="" target="_blank" rel="noopener external nofollow noreferrer">åŠ è½½ä¸­...</a><a class="footer-group-item" href="/link/">æ›´å¤šå‹é“¾</a></div><div class="footer-group"><span class="footer-group-title">åè®®</span><a class="footer-group-item" href="/protocol/comment/" title="ç”¨æˆ·å‘è¨€å‰ï¼Œè¯·è®¤çœŸé˜…è¯»æœ¬æ¡ä¾‹ã€‚ä¸€ç»å‘è¨€ï¼Œå³è§†ä¸ºåŒæ„æ¥å—æœ¬æ¡ä¾‹ï¼›å¦‚ä¸åŒæ„ï¼Œè¯·å‹¿å‘è¨€ã€‚">è¯„è®ºåè®®</a><a class="footer-group-item" href="/protocol/copyright/" title="æœ¬ç«™æ‰€æœ‰åŸåˆ›æ–‡ç« é‡‡ç”¨çŸ¥è¯†å…±äº«(Creative Commons)ç½²åâ€”éå•†ä¸šæ€§ä½¿ç”¨â€”ç›¸åŒæ–¹å¼å…±äº«4.0å›½é™…å…¬å…±è®¸å¯åè®®">ç‰ˆæƒåè®®</a></div></div><div id="footer-banner"><div id="footer-banner-container"><div class="footer-banner"><div class="copyright">Copyright &copy; 2019 - 2023  Maxbit  All Rights Reserved.</div></div><div class="footer-banner"><a target="_blank" rel="noopener" href="https://beian.miit.gov.cn">çš–ICPå¤‡2021005605å·-1</a><a target="_blank" rel="noopener" href="https://www.upyun.com/">UPYUN</a></div></div></div></div></footer></div><div class="hidden" id="rightside-mask" onclick="eurkon.switchRightSide();"></div><div class="hidden" id="rightside"><div id="rightside-header"><div id="rightside-back"><i class="fas fa-chevron-left" onclick="eurkon.backRightSide();"></i></div><div id="rightside-title">è®¾ç½®</div><div id="rightside-close" onclick="eurkon.switchRightSide();"><i class="fas fa-xmark"></i></div></div><div id="rightside-content"><div id="card-post-content"><div class="card-widget card-categories"><div class="item-headline">
            <i class="fas fa-folder-open"></i>
            <span>åˆ†ç±»</span>
            
            </div>
            <ul class="card-category-list" id="aside-cat-list">
            <li class="card-category-list-item "><a class="card-category-list-link" href="/categories/DBA/"><span class="card-category-list-name">DBA</span><span class="card-category-list-count">34</span></a></li><li class="card-category-list-item "><a class="card-category-list-link" href="/categories/Golang/"><span class="card-category-list-name">Golang</span><span class="card-category-list-count">8</span></a></li><li class="card-category-list-item "><a class="card-category-list-link" href="/categories/OPS/"><span class="card-category-list-name">OPS</span><span class="card-category-list-count">49</span></a></li>
            </ul></div><div class="card-widget card-tags"><div class="item-headline"><i class="fas fa-tags"></i><span>æ ‡ç­¾</span></div><div class="card-tag-cloud"><a id="tags/Docker/" href="/tags/Docker/" style="font-size: 1.29em; color: rgb(26, 166, 59)">Docker<sup>6</sup></a><a id="tags/OPS/" href="/tags/OPS/" style="font-size: 1.45em; color: rgb(160, 148, 168)">ğŸŒOPS<sup>49</sup></a><a id="tags/Git/" href="/tags/Git/" style="font-size: 1.23em; color: rgb(168, 104, 139)">Git<sup>4</sup></a><a id="tags/GitLab/" href="/tags/GitLab/" style="font-size: 1.23em; color: rgb(69, 154, 167)">GitLab<sup>4</sup></a><a id="tags/Skywalking/" href="/tags/Skywalking/" style="font-size: 1.15em; color: rgb(194, 5, 189)">Skywalking<sup>1</sup></a><a id="tags/é“¾è·¯è¿½è¸ª/" href="/tags/%E9%93%BE%E8%B7%AF%E8%BF%BD%E8%B8%AA/" style="font-size: 1.15em; color: rgb(110, 25, 69)">é“¾è·¯è¿½è¸ª<sup>1</sup></a><a id="tags/Download/" href="/tags/Download/" style="font-size: 1.15em; color: rgb(1, 78, 107)">â¬Download<sup>1</sup></a><a id="tags/ELK/" href="/tags/ELK/" style="font-size: 1.26em; color: rgb(174, 89, 11)">ELK<sup>5</sup></a><a id="tags/Logstash/" href="/tags/Logstash/" style="font-size: 1.18em; color: rgb(110, 1, 3)">Logstash<sup>2</sup></a><a id="tags/Nginx/" href="/tags/Nginx/" style="font-size: 1.18em; color: rgb(40, 104, 136)">Nginx<sup>2</sup></a><a id="tags/Golang/" href="/tags/Golang/" style="font-size: 1.34em; color: rgb(143, 147, 110)">ğŸ“Golang<sup>8</sup></a><a id="tags/JumpServer/" href="/tags/JumpServer/" style="font-size: 1.15em; color: rgb(176, 41, 55)">JumpServer<sup>1</sup></a><a id="tags/å ¡å’æœº/" href="/tags/%E5%A0%A1%E5%9E%92%E6%9C%BA/" style="font-size: 1.15em; color: rgb(14, 95, 98)">å ¡å’æœº<sup>1</sup></a><a id="tags/iptables/" href="/tags/iptables/" style="font-size: 1.15em; color: rgb(109, 101, 111)">iptables<sup>1</sup></a><a id="tags/Kong/" href="/tags/Kong/" style="font-size: 1.2em; color: rgb(87, 196, 117)">Kong<sup>3</sup></a><a id="tags/OAuth2-0/" href="/tags/OAuth2-0/" style="font-size: 1.15em; color: rgb(76, 109, 38)">OAuth2.0<sup>1</sup></a><a id="tags/MongoDB/" href="/tags/MongoDB/" style="font-size: 1.2em; color: rgb(118, 78, 39)">MongoDB<sup>3</sup></a><a id="tags/NoSQL/" href="/tags/NoSQL/" style="font-size: 1.31em; color: rgb(17, 50, 13)">NoSQL<sup>7</sup></a><a id="tags/MySQL/" href="/tags/MySQL/" style="font-size: 1.42em; color: rgb(104, 32, 63)">ğŸŒ²MySQL<sup>26</sup></a><a id="tags/ä¸»ä»å¤åˆ¶/" href="/tags/%E4%B8%BB%E4%BB%8E%E5%A4%8D%E5%88%B6/" style="font-size: 1.37em; color: rgb(52, 111, 26)">ä¸»ä»å¤åˆ¶<sup>12</sup></a><a id="tags/è¯»å†™åˆ†ç¦»/" href="/tags/%E8%AF%BB%E5%86%99%E5%88%86%E7%A6%BB/" style="font-size: 1.23em; color: rgb(151, 6, 129)">è¯»å†™åˆ†ç¦»<sup>4</sup></a><a id="tags/é«˜å¯ç”¨/" href="/tags/%E9%AB%98%E5%8F%AF%E7%94%A8/" style="font-size: 1.34em; color: rgb(179, 133, 151)">é«˜å¯ç”¨<sup>8</sup></a><a id="tags/åˆ†å¸ƒå¼/" href="/tags/%E5%88%86%E5%B8%83%E5%BC%8F/" style="font-size: 1.26em; color: rgb(174, 179, 182)">åˆ†å¸ƒå¼<sup>5</sup></a><a id="tags/MyCAT/" href="/tags/MyCAT/" style="font-size: 1.2em; color: rgb(97, 52, 73)">MyCAT<sup>3</sup></a><a id="tags/å‚ç›´æ‹†åˆ†/" href="/tags/%E5%9E%82%E7%9B%B4%E6%8B%86%E5%88%86/" style="font-size: 1.15em; color: rgb(192, 98, 101)">å‚ç›´æ‹†åˆ†<sup>1</sup></a><a id="tags/MHA/" href="/tags/MHA/" style="font-size: 1.18em; color: rgb(82, 167, 31)">MHA<sup>2</sup></a><a id="tags/é”/" href="/tags/%E9%94%81/" style="font-size: 1.15em; color: rgb(87, 50, 193)">é”<sup>1</sup></a><a id="tags/æ—¥å¿—ç®¡ç†/" href="/tags/%E6%97%A5%E5%BF%97%E7%AE%A1%E7%90%86/" style="font-size: 1.23em; color: rgb(154, 51, 66)">æ—¥å¿—ç®¡ç†<sup>4</sup></a><a id="tags/ACID/" href="/tags/ACID/" style="font-size: 1.15em; color: rgb(91, 147, 98)">ACID<sup>1</sup></a><a id="tags/äº‹åŠ¡/" href="/tags/%E4%BA%8B%E5%8A%A1/" style="font-size: 1.15em; color: rgb(83, 179, 150)">äº‹åŠ¡<sup>1</sup></a><a id="tags/SQL/" href="/tags/SQL/" style="font-size: 1.2em; color: rgb(169, 119, 37)">SQL<sup>3</sup></a><a id="tags/ä¸€è‡´æ€§hashç®—æ³•/" href="/tags/%E4%B8%80%E8%87%B4%E6%80%A7hash%E7%AE%97%E6%B3%95/" style="font-size: 1.15em; color: rgb(155, 54, 5)">ä¸€è‡´æ€§hashç®—æ³•<sup>1</sup></a><a id="tags/PAM/" href="/tags/PAM/" style="font-size: 1.15em; color: rgb(111, 53, 23)">PAM<sup>1</sup></a><a id="tags/Ansible/" href="/tags/Ansible/" style="font-size: 1.15em; color: rgb(5, 184, 158)">Ansible<sup>1</sup></a><a id="tags/Playbook/" href="/tags/Playbook/" style="font-size: 1.15em; color: rgb(36, 9, 18)">Playbook<sup>1</sup></a><a id="tags/Redis/" href="/tags/Redis/" style="font-size: 1.26em; color: rgb(35, 77, 24)">Redis<sup>5</sup></a><a id="tags/tools/" href="/tags/tools/" style="font-size: 1.15em; color: rgb(94, 25, 137)">tools<sup>1</sup></a><a id="tags/Zabbix/" href="/tags/Zabbix/" style="font-size: 1.23em; color: rgb(101, 152, 5)">Zabbix<sup>4</sup></a><a id="tags/Zookeeper/" href="/tags/Zookeeper/" style="font-size: 1.2em; color: rgb(149, 171, 166)">Zookeeper<sup>3</sup></a><a id="tags/SVN/" href="/tags/SVN/" style="font-size: 1.15em; color: rgb(42, 20, 23)">SVN<sup>1</sup></a><a id="tags/gRPC/" href="/tags/gRPC/" style="font-size: 1.15em; color: rgb(14, 108, 20)">gRPC<sup>1</sup></a><a id="tags/Kubernetes/" href="/tags/Kubernetes/" style="font-size: 1.4em; color: rgb(120, 48, 83)">â›µKubernetes<sup>20</sup></a><a id="tags/place/" href="/tags/place/" style="font-size: 1.15em; color: rgb(64, 112, 179)">place<sup>1</sup></a><a id="tags/å¼¹æ€§ä¼¸ç¼©/" href="/tags/%E5%BC%B9%E6%80%A7%E4%BC%B8%E7%BC%A9/" style="font-size: 1.15em; color: rgb(11, 155, 27)">å¼¹æ€§ä¼¸ç¼©<sup>1</sup></a><a id="tags/mysqlå¤‡ä»½/" href="/tags/mysql%E5%A4%87%E4%BB%BD/" style="font-size: 1.15em; color: rgb(4, 200, 57)">mysqlå¤‡ä»½<sup>1</sup></a><a id="tags/æ•°æ®å¤‡ä»½/" href="/tags/%E6%95%B0%E6%8D%AE%E5%A4%87%E4%BB%BD/" style="font-size: 1.18em; color: rgb(126, 191, 114)">æ•°æ®å¤‡ä»½<sup>2</sup></a><a id="tags/è°ƒåº¦ç­–ç•¥/" href="/tags/%E8%B0%83%E5%BA%A6%E7%AD%96%E7%95%A5/" style="font-size: 1.15em; color: rgb(41, 188, 129)">è°ƒåº¦ç­–ç•¥<sup>1</sup></a><a id="tags/æ ‘è“æ´¾/" href="/tags/%E6%A0%91%E8%8E%93%E6%B4%BE/" style="font-size: 1.15em; color: rgb(187, 91, 25)">æ ‘è“æ´¾<sup>1</sup></a><a id="tags/Minecraft/" href="/tags/Minecraft/" style="font-size: 1.15em; color: rgb(137, 59, 121)">Minecraft<sup>1</sup></a><a id="tags/OPENVPN/" href="/tags/OPENVPN/" style="font-size: 1.15em; color: rgb(187, 141, 194)">OPENVPN<sup>1</sup></a><a id="tags/ä¼˜åŒ–/" href="/tags/%E4%BC%98%E5%8C%96/" style="font-size: 1.15em; color: rgb(102, 6, 90)">ä¼˜åŒ–<sup>1</sup></a><a id="tags/DNS/" href="/tags/DNS/" style="font-size: 1.15em; color: rgb(76, 195, 181)">DNS<sup>1</sup></a><a id="tags/å¤šè¡¨è”æŸ¥/" href="/tags/%E5%A4%9A%E8%A1%A8%E8%81%94%E6%9F%A5/" style="font-size: 1.15em; color: rgb(111, 164, 199)">å¤šè¡¨è”æŸ¥<sup>1</sup></a><a id="tags/Canal/" href="/tags/Canal/" style="font-size: 1.15em; color: rgb(13, 82, 127)">Canal<sup>1</sup></a><a id="tags/CI-CD/" href="/tags/CI-CD/" style="font-size: 1.18em; color: rgb(31, 132, 162)">CI/CD<sup>2</sup></a><a id="tags/æ°´å¹³æ‹†åˆ†/" href="/tags/%E6%B0%B4%E5%B9%B3%E6%8B%86%E5%88%86/" style="font-size: 1.15em; color: rgb(83, 118, 82)">æ°´å¹³æ‹†åˆ†<sup>1</sup></a><a id="tags/ç´¢å¼•/" href="/tags/%E7%B4%A2%E5%BC%95/" style="font-size: 1.15em; color: rgb(83, 185, 68)">ç´¢å¼•<sup>1</sup></a><a id="tags/Rediså“¨å…µ/" href="/tags/Redis%E5%93%A8%E5%85%B5/" style="font-size: 1.15em; color: rgb(178, 30, 29)">Rediså“¨å…µ<sup>1</sup></a><a id="tags/Terraform/" href="/tags/Terraform/" style="font-size: 1.15em; color: rgb(82, 140, 5)">Terraform<sup>1</sup></a><a id="tags/åŸºç¡€è®¾æ–½å³ä»£ç /" href="/tags/%E5%9F%BA%E7%A1%80%E8%AE%BE%E6%96%BD%E5%8D%B3%E4%BB%A3%E7%A0%81/" style="font-size: 1.15em; color: rgb(110, 16, 137)">åŸºç¡€è®¾æ–½å³ä»£ç <sup>1</sup></a><a id="tags/å…¬æœ‰äº‘ç¼–æ’/" href="/tags/%E5%85%AC%E6%9C%89%E4%BA%91%E7%BC%96%E6%8E%92/" style="font-size: 1.15em; color: rgb(193, 79, 47)">å…¬æœ‰äº‘ç¼–æ’<sup>1</sup></a><a id="tags/æ•°æ®æŒä¹…åŒ–/" href="/tags/%E6%95%B0%E6%8D%AE%E6%8C%81%E4%B9%85%E5%8C%96/" style="font-size: 1.15em; color: rgb(159, 47, 96)">æ•°æ®æŒä¹…åŒ–<sup>1</sup></a><a id="tags/Workload/" href="/tags/Workload/" style="font-size: 1.15em; color: rgb(174, 133, 55)">Workload<sup>1</sup></a><a id="tags/æœåŠ¡å‘ç°/" href="/tags/%E6%9C%8D%E5%8A%A1%E5%8F%91%E7%8E%B0/" style="font-size: 1.15em; color: rgb(111, 11, 54)">æœåŠ¡å‘ç°<sup>1</sup></a><a id="tags/æ•°æ®åº“ä¼˜åŒ–/" href="/tags/%E6%95%B0%E6%8D%AE%E5%BA%93%E4%BC%98%E5%8C%96/" style="font-size: 1.15em; color: rgb(10, 144, 105)">æ•°æ®åº“ä¼˜åŒ–<sup>1</sup></a><a id="tags/StatefuSet/" href="/tags/StatefuSet/" style="font-size: 1.15em; color: rgb(12, 80, 84)">StatefuSet<sup>1</sup></a><a id="tags/Helm-v3/" href="/tags/Helm-v3/" style="font-size: 1.15em; color: rgb(74, 172, 82)">Helm v3<sup>1</sup></a><a id="tags/å®¹å™¨ç¼–æ’/" href="/tags/%E5%AE%B9%E5%99%A8%E7%BC%96%E6%8E%92/" style="font-size: 1.15em; color: rgb(106, 136, 63)">å®¹å™¨ç¼–æ’<sup>1</sup></a><a id="tags/Prometheus/" href="/tags/Prometheus/" style="font-size: 1.15em; color: rgb(99, 83, 27)">Prometheus<sup>1</sup></a><a id="tags/Apollo/" href="/tags/Apollo/" style="font-size: 1.15em; color: rgb(118, 89, 6)">Apollo<sup>1</sup></a><a id="tags/SHELL/" href="/tags/SHELL/" style="font-size: 1.15em; color: rgb(45, 106, 137)">SHELL<sup>1</sup></a><a id="tags/RAID/" href="/tags/RAID/" style="font-size: 1.15em; color: rgb(5, 92, 4)">RAID<sup>1</sup></a></div></div></div></div><div id="rightside-config-hide"><button id="readmode" type="button" title="é˜…è¯»æ¨¡å¼"><i class="fas fa-book-open"></i></button><button id="translateLink" type="button" title="ç®€ç¹è½¬æ¢">ç¹</button><button id="darkmode" type="button" title="æµ…è‰²å’Œæ·±è‰²æ¨¡å¼è½¬æ¢"><i class="fas fa-sun"></i><i class="fas fa-moon"></i></button><button id="hide-aside-btn" type="button" title="å•æ å’ŒåŒæ åˆ‡æ¢"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside_config" type="button" title="è®¾ç½®"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="ç›®å½•"><i class="fas fa-list-ul"></i></button><button id="go-up" type="button" title="å›åˆ°é¡¶éƒ¨"><span class="scroll-percent"></span><i class="fas fa-arrow-up"></i></button></div></div><div id="rightmenu"><div class="rightmenu-group rightmenu-small"><div class="rightmenu-item" id="menu-backward" onclick="window.history.back()"><i class="fas fa-arrow-left"></i></div><div class="rightmenu-item" id="menu-forward" onclick="window.history.forward()"><i class="fas fa-arrow-right"></i></div><div class="rightmenu-item" id="menu-refresh" onclick="window.history.reload()"><i class="fas fa-arrow-rotate-right"></i></div><div class="rightmenu-item" id="menu-top" onclick="btf.scrollToDest(0, 500)"><i class="fas fa-arrow-up"></i></div></div><div class="rightmenu-group rightmenu-line" id="rightmenu-text"><div class="rightmenu-item" id="menu-copy"><i class="fas fa-copy"></i><span>å¤åˆ¶å†…å®¹</span></div><div class="rightmenu-item" id="menu-comment"><i class="fas fa-comment"></i><span>å¼•ç”¨è¯„è®º</span></div><div class="rightmenu-item" id="menu-paste"><i class="fas fa-paste"></i><span>ç²˜è´´æ–‡æœ¬</span></div><div class="rightmenu-item" id="menu-search"><i class="fas fa-search"></i><span>åœ¨æœ¬ç«™æœç´¢</span></div><div class="rightmenu-item" id="menu-baidu"><i class="fas fa-search-plus"></i><span>å»ç™¾åº¦æœç´¢</span></div></div><div class="rightmenu-group rightmenu-line" id="rightmenu-href"><div class="rightmenu-item" id="menu-copy-image"><i class="fas fa-copy"></i><span>å¤åˆ¶å›¾ç‰‡</span></div><div class="rightmenu-item" id="menu-download-image"><i class="fas fa-download"></i><span>ä¸‹è½½å›¾ç‰‡</span></div><div class="rightmenu-item" id="menu-link"><i class="fas fa-link"></i><span>åˆ†äº«é“¾æ¥</span></div><div class="rightmenu-item" id="menu-window"><i class="fas fa-window-restore"></i><span>æ–°çª—å£æ‰“å¼€</span></div></div><div class="rightmenu-group rightmenu-line" id="rightmenu-post"><a class="rightmenu-item" id="menu-random" href="/random/"><i class="fas fa-random"></i><span>éšæœºæ–‡ç« </span></a><a class="rightmenu-item" id="menu-categories" href="/categories/"><i class="fas fa-shapes"></i><span>å…¨éƒ¨åˆ†ç±»</span></a><a class="rightmenu-item" id="menu-tags" href="/tags/"><i class="fas fa-tags"></i><span>æ‰€æœ‰æ ‡ç­¾</span></a><div class="rightmenu-item" id="menu-share"><i class="fas fa-share-square"></i><span>åˆ†äº«æœ¬é¡µ</span></div></div><div class="rightmenu-group rightmenu-line" id="rightmenu-site"><a class="rightmenu-item" id="menu-message" href="/message/"><i class="fas fa-envelope"></i><span>ç•™è¨€ä¿¡ç®±</span></a><a class="rightmenu-item" id="menu-about" href="/about/"><i class="fas fa-address-card"></i><span>å…³äºæœ¬ç«™</span></a></div></div><div id="rightmenu-mask"></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="/js/eurkon/color-thief.min.js"></script><script defer src="/js/eurkon/eurkon.js"></script><script defer data-pjax src="/js/eurkon/refresh.js"></script><script src="/js/tw_cn.js"></script><script src="/css/fei/fancybox.umd.min.js"></script><div class="js-pjax"></div><script defer data-pjax async src="//at.alicdn.com/t/font_2358265_expoyqe85d4.js"></script><script src="/css/fei/pjax.min.js"></script><script>let pjaxSelectors = ["head > title","#config-diff","#body-wrap","#rightside-config-hide","#rightside-config-show",".js-pjax"]

var pjax = new Pjax({
  elements: 'a:not([target="_blank"])',
  selectors: pjaxSelectors,
  cacheBust: false,
  analytics: false,
  scrollRestoration: false
})

document.addEventListener('pjax:send', function () {

  // removeEventListener scroll 
  window.tocScrollFn && window.removeEventListener('scroll', window.tocScrollFn)
  window.scrollCollect && window.removeEventListener('scroll', scrollCollect)

  document.getElementById('rightside').style.cssText = "opacity: ''; transform: ''"
  
  if (window.aplayers) {
    for (let i = 0; i < window.aplayers.length; i++) {
      if (!window.aplayers[i].options.fixed) {
        window.aplayers[i].destroy()
      }
    }
  }

  typeof typed === 'object' && typed.destroy()

  //reset readmode
  const $bodyClassList = document.body.classList
  $bodyClassList.contains('read-mode') && $bodyClassList.remove('read-mode')

  typeof disqusjs === 'object' && disqusjs.destroy()
})

document.addEventListener('pjax:complete', function () {
  window.refreshFn()

  document.querySelectorAll('script[data-pjax]').forEach(item => {
    const newScript = document.createElement('script')
    const content = item.text || item.textContent || item.innerHTML || ""
    Array.from(item.attributes).forEach(attr => newScript.setAttribute(attr.name, attr.value))
    newScript.appendChild(document.createTextNode(content))
    item.parentNode.replaceChild(newScript, item)
  })

  GLOBAL_CONFIG.islazyload && window.lazyLoadInstance.update()

  typeof chatBtnFn === 'function' && chatBtnFn()
  typeof panguInit === 'function' && panguInit()

  // google analytics
  typeof gtag === 'function' && gtag('config', '', {'page_path': window.location.pathname});

  // baidu analytics
  typeof _hmt === 'object' && _hmt.push(['_trackPageview',window.location.pathname]);

  typeof loadMeting === 'function' && document.getElementsByClassName('aplayer').length && loadMeting()

  // prismjs
  typeof Prism === 'object' && Prism.highlightAll()
})

document.addEventListener('pjax:error', (e) => {
  if (e.request.status === 404) {
    pjax.loadUrl('/404.html')
  }
})</script><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div><script src="/live2dw/lib/L2Dwidget.min.js?094cbace49a39548bed64abff5988b05"></script><script>L2Dwidget.init({"pluginModelPath":"assets/","model":{"jsonPath":"/live2dw/assets/haru01.model.json"},"bottom":-40,"display":{"position":"right","width":190,"height":380,"hOffset":5},"mobile":{"show":false},"log":false,"pluginJsPath":"lib/","pluginRootPath":"live2dw/","tagMode":false});</script></body></html><script>var posts=["forward/408a4bb8.html","forward/60c1bc2d.html","forward/882d9505.html","forward/d063782.html","forward/download.html","forward/47eea66c.html","forward/131c756.html","forward/17b35260.html","forward/eb065b59.html","forward/873540ab.html","forward/8f91bfec.html","forward/d5b63f7f.html","forward/d12df344.html","forward/f9d199b7.html","forward/420acb0d.html","forward/bac240f7.html","forward/d7240237.html","forward/1e56645c.html","forward/c4bb5371.html","forward/3053135c.html","forward/6c0d75ae.html","forward/74c8159a.html","forward/557ea64b.html","forward/bbb9c58b.html","forward/c919a25c.html","forward/49de8711.html","forward/f34e607d.html","forward/c3e1b71a.html","forward/93ea067.html","forward/bc8a646.html","forward/cb26d424.html","forward/62bf20bb.html","forward/ddc093b3.html","forward/3c4a0863.html","forward/a7fae6f0.html","forward/4f3d60c1.html","forward/ae362167.html","forward/36cbf320.html","forward/67af6371.html","forward/212d60e3.html","forward/fb94f251.html","forward/b571ca78.html","forward/f353577b.html","forward/ae26d423.html","forward/7be7c575.html","forward/fabc6ce1.html","forward/48a90e5c.html","forward/3837938a.html","forward/4a17b156.html","forward/2f09977b.html","forward/2aa52898.html","forward/55d102bd.html","forward/3ea5fff1.html","forward/5234d9e2.html","forward/ad8d3f77.html","forward/8cd3cd17.html","forward/8e9bbd7d.html","forward/6cfd7a23.html","forward/1758bdeb.html","forward/8bd2a16a.html","forward/2cfbf2d2.html","forward/d6f16b84.html","forward/d4ac701.html","forward/d36764c1.html","forward/29b0e6a9.html","forward/13c392b.html","forward/852a3e1.html","forward/40c70ce.html","forward/c3e55136.html","forward/69e1266e.html","forward/84c0fcc7.html","forward/663d93c2.html","forward/68023dec.html","forward/da64184b.html","forward/ae6c7518.html","forward/3df8560c.html","forward/1051b489.html","forward/b36ee5af.html","forward/dc57d8c4.html","forward/61316209.html","forward/503970b4.html","forward/b17eefd4.html","forward/ff7280bd.html","forward/5c41384a.html","forward/14a32ee2.html","forward/58eea07e.html","forward/7139bb18.html","forward/6b4e4d76.html","forward/dc57d8c5.html","forward/91db5a91.html","forward/649a95fd.html","forward/57e2aa11.html","forward/312ec9e0.html"];function toRandomPost(){ window.pjax ? pjax.loadUrl('/'+posts[Math.floor(Math.random()*posts.length)]) : window.open('/'+posts[Math.floor(Math.random()*posts.length)], "_self"); };</script><script>var flinks=[{"name":"Eurkon","link":"https://blog.eurkon.com","avatar":"https://blog.eurkon.com/images/user/avatar.jpg","descr":"ä¸åªæ˜¯ä»£ç çš„æ¬è¿å·¥"},{"name":"ä¸€æœµå¤§å‘²èŠ±","link":"https://www.iiemo.com/","avatar":"https://www.iiemo.com/logo.png","descr":"èµ„æ·±NBå‰ç«¯å¤§ä½¬"},{"name":"è±Œè±†å¤šå¤š","link":"https://wandouduoduo.github.io/","avatar":"/img/link/index.png","descr":"èµ„æ·±æ²ªæ¼‚è¿ç»´å·¥ç¨‹å¸ˆ"},{"name":"å‘¨å°é›¨","link":"https://zxyy.me/","avatar":"https://q2.qlogo.cn/headimg_dl?dst_uin=1016673080&spec=100","descr":"PHPç¨‹åºçŒ¿"},{"name":"ACGé£Ÿå ‚","link":"https://canteen.globalacca.top/","avatar":"https://q2.qlogo.cn/headimg_dl?dst_uin=1478030465&spec=100","descr":"æ±‡é›†ACGã€åŠ¨æ¼«å’Œgalgameä¸ºä¸€ä½“çš„ç»¼åˆå°ç«™"},{"name":"ç¼ºç¼º","link":"https://www.quewaner.com/","avatar":"https://q2.qlogo.cn/headimg_dl?dst_uin=3393597524&spec=100","descr":"èµ„æ·±å‰ç«¯å·¥ç¨‹å¸ˆ"},{"name":"yiyun","link":"https://moeci.com/","avatar":"https://q2.qlogo.cn/headimg_dl?dst_uin=2284407619&spec=100","descr":"å…¨æ ˆå¼€å‘"},{"name":"äºŒå“ˆå°çª","link":"https://www.moeeh.cn/","avatar":"https://www.moeeh.cn/eh/eh.png","descr":"è‹¦é…’æŠ˜æŸ³ä»Šç›¸ç¦» æ— é£æ— æœˆä¹Ÿæ— ä½ "},{"name":"Akilarã®ç³–æœå±‹","link":"https://akilar.top/","avatar":"https://unpkg.zhimg.com/akilar-candyassets/image/siteicon/favicon.png","descr":"æœŸå¾…æ‚¨çš„å…‰ä¸´ï¼"},{"name":"å°é«˜å¯¼èˆª","link":"https://www.dhw22.com/","avatar":"https://www.dhw22.com/wp-content/uploads/2022/01/Favicon.png","descr":"èµ„æºç±»æŠ€æœ¯æ•™ç¨‹æ´»åŠ¨å¯¼èˆªåˆ†ç±»å¹³å°"},{"name":"åä¸ºå¼€æºé•œåƒç«™","link":"https://mirrors.huaweicloud.com/","avatar":"/img/link/huawei.png","descr":"æ„å»ºä¸‡ç‰©äº’è”çš„æ™ºèƒ½ä¸–ç•Œ"},{"name":"é˜¿é‡Œå¼€æºé•œåƒç«™","link":"https://mirrors.aliyun.com/","avatar":"/img/link/aliyun.png","descr":"ä¸ºäº†æ— æ³•è®¡ç®—çš„ä»·å€¼"},{"name":"ç½‘æ˜“å¼€æºé•œåƒç«™","link":"https://mirrors.163.com/","avatar":"/img/link/netease.png","descr":"ç½‘èšäººçš„åŠ›é‡"},{"name":"æœç‹å¼€æºé•œåƒç«™","link":"https://mirrors.sohu.com/","avatar":"/img/link/souhu.png","descr":"ä¸Šæœç‹ çŸ¥å¤©ä¸‹"},{"name":"æ¸…åå¼€æºé•œåƒç«™","link":"https://mirrors.tuna.tsinghua.edu.cn/","avatar":"/img/link/qh.png","descr":"è‡ªå¼ºä¸æ¯,åšå¾·è½½ç‰©"},{"name":"æµ™å¤§å¼€æºé•œåƒç«™","link":"https://mirrors.zju.edu.cn/","avatar":"/img/link/zd.png","descr":"å…¼æ€»æ¡è´¯,çŸ¥è‡³çŸ¥ç»ˆ"},{"name":"ä¸­ç§‘å¤§å¼€æºé•œåƒç«™","link":"https://mirrors.ustc.edu.cn/","avatar":"/img/link/zkd.png","descr":"çº¢ä¸“å¹¶è¿›,ç†å®äº¤è"},{"name":"å…°å¤§å¼€æºé•œåƒç«™","link":"https://mirror.lzu.edu.cn/","avatar":"/img/link/ld.png","descr":"ç‹¬æ ‘ä¸€å¸œ,è‡ªå¼ºä¸æ¯"}];function toRandomFlink(){window.open(flinks[Math.floor(Math.random()*flinks.length)].link);};</script>